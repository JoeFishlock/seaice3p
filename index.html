
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="Changelog/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.5">
    
    
      
        <title>seaice3p</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="seaice3p" class="md-header__button md-logo" aria-label="seaice3p" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            seaice3p
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API Reference
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="seaice3p" class="md-nav__button md-logo" aria-label="seaice3p" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    seaice3p
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#seaice3p" class="md-nav__link">
    <span class="md-ellipsis">
      seaice3p
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.BRW09Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09Forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BRW09Forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.BRW09Forcing.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.BRW09InitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09InitialConditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.BRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09OceanForcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BRW09OceanForcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.BRW09OceanForcing.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.Config" class="md-nav__link">
    <span class="md-ellipsis">
      Config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.ConstantForcing" class="md-nav__link">
    <span class="md-ellipsis">
      ConstantForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.CubicLiquidus" class="md-nav__link">
    <span class="md-ellipsis">
      CubicLiquidus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DISEQPhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQPhysicalParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalBRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalBRW09OceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalConstantTurbulentFlux" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalConstantTurbulentFlux
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalERA5Forcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalFixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalFixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedTempOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalMonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonoBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalMonoBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalMonoBubbleParams.bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalMonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.B" class="md-nav__link">
    <span class="md-ellipsis">
      B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.Rayleigh_salt" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.damkohler_number" class="md-nav__link">
    <span class="md-ellipsis">
      damkohler_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.expansion_coefficient" class="md-nav__link">
    <span class="md-ellipsis">
      expansion_coefficient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.frame_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      frame_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.lewis_gas" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.savefreq" class="md-nav__link">
    <span class="md-ellipsis">
      savefreq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.scales" class="md-nav__link">
    <span class="md-ellipsis">
      scales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.total_time" class="md-nav__link">
    <span class="md-ellipsis">
      total_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalPowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalPowerLawBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalPowerLawBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      maximum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      minimum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalRobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalRobinForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalWaterParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalWaterParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.concentration_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      concentration_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.eddy_diffusivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      eddy_diffusivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.lewis_salt" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.ocean_freezing_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_freezing_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.salinity_difference" class="md-nav__link">
    <span class="md-ellipsis">
      salinity_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.snow_conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      snow_conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.specific_heat_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      specific_heat_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.stefan_number" class="md-nav__link">
    <span class="md-ellipsis">
      stefan_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.temperature_difference" class="md-nav__link">
    <span class="md-ellipsis">
      temperature_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.thermal_diffusivity" class="md-nav__link">
    <span class="md-ellipsis">
      thermal_diffusivity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.EQMPhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      EQMPhysicalParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.ERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      ERA5Forcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.FixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      FixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.FixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      FixedTempOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.MonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      MonoBubbleParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.MonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      MonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.NoBrineConvection" class="md-nav__link">
    <span class="md-ellipsis">
      NoBrineConvection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.NumericalParams" class="md-nav__link">
    <span class="md-ellipsis">
      NumericalParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.OilInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      OilInitialConditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.PowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      PowerLawBubbleParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.RJW14Params" class="md-nav__link">
    <span class="md-ellipsis">
      RJW14Params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.RadForcing" class="md-nav__link">
    <span class="md-ellipsis">
      RadForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.RobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      RobinForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.Scales" class="md-nav__link">
    <span class="md-ellipsis">
      Scales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.time_scale" class="md-nav__link">
    <span class="md-ellipsis">
      time_scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.velocity_scale" class="md-nav__link">
    <span class="md-ellipsis">
      velocity_scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_dimensional_bulk_air_to_argon_content" class="md-nav__link">
    <span class="md-ellipsis">
      convert_dimensional_bulk_air_to_argon_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_bulk_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_bulk_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_bulk_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_dissolved_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_dissolved_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_grid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_heating" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_heating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_time" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_bulk_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_bulk_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_bulk_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_dissolved_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_dissolved_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_grid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_time" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_time
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.UniformInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      UniformInitialConditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.YearlyForcing" class="md-nav__link">
    <span class="md-ellipsis">
      YearlyForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.get_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.enthalpy_method" class="md-nav__link">
    <span class="md-ellipsis">
      enthalpy_method
    </span>
  </a>
  
    <nav class="md-nav" aria-label="enthalpy_method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.enthalpy_method.enthalpy_method" class="md-nav__link">
    <span class="md-ellipsis">
      enthalpy_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.enthalpy_method.phase_boundaries" class="md-nav__link">
    <span class="md-ellipsis">
      phase_boundaries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.equations" class="md-nav__link">
    <span class="md-ellipsis">
      equations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14" class="md-nav__link">
    <span class="md-ellipsis">
      RJW14
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RJW14">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms" class="md-nav__link">
    <span class="md-ellipsis">
      brine_channel_sink_terms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="brine_channel_sink_terms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms._DISEQ_brine_convection_sink" class="md-nav__link">
    <span class="md-ellipsis">
      _DISEQ_brine_convection_sink
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms._EQM_brine_convection_sink" class="md-nav__link">
    <span class="md-ellipsis">
      _EQM_brine_convection_sink
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms._calculate_bulk_dissolved_gas_sink" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_bulk_dissolved_gas_sink
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms._calculate_gas_sink" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_gas_sink
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage" class="md-nav__link">
    <span class="md-ellipsis">
      brine_drainage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="brine_drainage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_Rayleigh" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_Rayleigh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_brine_channel_sink" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_brine_channel_sink
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_brine_channel_strength" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_brine_channel_strength
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_brine_convection_liquid_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_brine_convection_liquid_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_integrated_mean_permeability" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_integrated_mean_permeability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_permeability" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_permeability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.get_convecting_region_height" class="md-nav__link">
    <span class="md-ellipsis">
      get_convecting_region_height
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.get_effective_Rayleigh_number" class="md-nav__link">
    <span class="md-ellipsis">
      get_effective_Rayleigh_number
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.equations" class="md-nav__link">
    <span class="md-ellipsis">
      equations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.equations._prevent_gas_rise_into_saturated_cell" class="md-nav__link">
    <span class="md-ellipsis">
      _prevent_gas_rise_into_saturated_cell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux" class="md-nav__link">
    <span class="md-ellipsis">
      flux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.bulk_dissolved_gas_flux" class="md-nav__link">
    <span class="md-ellipsis">
      bulk_dissolved_gas_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.gas_fraction_flux" class="md-nav__link">
    <span class="md-ellipsis">
      gas_fraction_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      heat_flux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="heat_flux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.heat_flux.calculate_conductive_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_conductive_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.heat_flux.pure_liquid_switch" class="md-nav__link">
    <span class="md-ellipsis">
      pure_liquid_switch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.salt_flux" class="md-nav__link">
    <span class="md-ellipsis">
      salt_flux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="salt_flux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.salt_flux.calculate_diffusive_salt_flux" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_diffusive_salt_flux
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.nucleation" class="md-nav__link">
    <span class="md-ellipsis">
      nucleation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nucleation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.nucleation._DISEQ_nucleation" class="md-nav__link">
    <span class="md-ellipsis">
      _DISEQ_nucleation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.nucleation._EQM_nucleation" class="md-nav__link">
    <span class="md-ellipsis">
      _EQM_nucleation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.radiative_heating" class="md-nav__link">
    <span class="md-ellipsis">
      radiative_heating
    </span>
  </a>
  
    <nav class="md-nav" aria-label="radiative_heating">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.radiative_heating._calculate_non_dimensional_shortwave_heating" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_non_dimensional_shortwave_heating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.radiative_heating.get_radiative_heating" class="md-nav__link">
    <span class="md-ellipsis">
      get_radiative_heating
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities" class="md-nav__link">
    <span class="md-ellipsis">
      velocities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="velocities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.bubble_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bubble_parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.bubble_parameters.calculate_bubble_size_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_bubble_size_fraction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      mono_distribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mono_distribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution.calculate_lag_function" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_lag_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution.calculate_mono_lag_factor" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_mono_lag_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution.calculate_mono_wall_drag_factor" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_mono_wall_drag_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution.calculate_wall_drag_function" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_wall_drag_function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      power_law_distribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="power_law_distribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_lag_integrand" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_lag_integrand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_power_law_lag_factor" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_power_law_lag_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_power_law_wall_drag_factor" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_power_law_wall_drag_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_volume_integrand" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_volume_integrand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_wall_drag_integrand" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_wall_drag_integrand
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.velocities" class="md-nav__link">
    <span class="md-ellipsis">
      velocities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="velocities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.velocities.calculate_gas_interstitial_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_gas_interstitial_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.velocities.calculate_liquid_darcy_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_liquid_darcy_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.velocities.calculate_velocities" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_velocities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.example" class="md-nav__link">
    <span class="md-ellipsis">
      example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.example.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.forcing" class="md-nav__link">
    <span class="md-ellipsis">
      forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      boundary_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="boundary_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._dissolved_gas_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _dissolved_gas_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._enthalpy_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _enthalpy_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._gas_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _gas_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._gas_fraction_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _gas_fraction_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._liquid_fraction_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _liquid_fraction_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._liquid_salinity_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _liquid_salinity_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._salt_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _salt_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._temperature_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _temperature_BCs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.radiative_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      radiative_forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="radiative_forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.radiative_forcing._constant_LW_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _constant_LW_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.radiative_forcing._constant_SW_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _constant_SW_forcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance" class="md-nav__link">
    <span class="md-ellipsis">
      surface_energy_balance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="surface_energy_balance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.surface_energy_balance" class="md-nav__link">
    <span class="md-ellipsis">
      surface_energy_balance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="surface_energy_balance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.surface_energy_balance._calculate_total_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_total_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.surface_energy_balance.find_ghost_cell_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      find_ghost_cell_temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      turbulent_heat_flux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="turbulent_heat_flux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_bulk_transfer_coefficient" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_bulk_transfer_coefficient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_air_temp" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_ref_air_temp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_atmospheric_pressure" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_ref_atmospheric_pressure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_specific_humidity" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_ref_specific_humidity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_windspeed" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_ref_windspeed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_surface_specific_humidity" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_surface_specific_humidity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux.calculate_latent_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_latent_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux.calculate_sensible_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_sensible_heat_flux
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      temperature_forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="temperature_forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._Robin_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _Robin_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._barrow_ocean_temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _barrow_ocean_temperature_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._barrow_temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _barrow_temperature_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._dimensional_barrow_ocean_temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _dimensional_barrow_ocean_temperature_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._dimensional_barrow_temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _dimensional_barrow_temperature_forcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.grids" class="md-nav__link">
    <span class="md-ellipsis">
      grids
    </span>
  </a>
  
    <nav class="md-nav" aria-label="grids">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids" class="md-nav__link">
    <span class="md-ellipsis">
      Grids
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grids">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.D_e" class="md-nav__link">
    <span class="md-ellipsis">
      D_e
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.D_g" class="md-nav__link">
    <span class="md-ellipsis">
      D_g
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.centers" class="md-nav__link">
    <span class="md-ellipsis">
      centers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.ghosts" class="md-nav__link">
    <span class="md-ellipsis">
      ghosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.step" class="md-nav__link">
    <span class="md-ellipsis">
      step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.add_ghost_cells" class="md-nav__link">
    <span class="md-ellipsis">
      add_ghost_cells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.average" class="md-nav__link">
    <span class="md-ellipsis">
      average
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.calculate_ice_ocean_boundary_depth" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_ice_ocean_boundary_depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.geometric" class="md-nav__link">
    <span class="md-ellipsis">
      geometric
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      initial_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initial_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._apply_value_in_ice_layer" class="md-nav__link">
    <span class="md-ellipsis">
      _apply_value_in_ice_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._get_barrow_initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      _get_barrow_initial_conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._get_oil_initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      _get_oil_initial_conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._get_previous_simulation_final_state" class="md-nav__link">
    <span class="md-ellipsis">
      _get_previous_simulation_final_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._get_uniform_initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      _get_uniform_initial_conditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.load.DISEQResults" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQResults
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DISEQResults">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.load.DISEQResults.bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      bulk_gas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults" class="md-nav__link">
    <span class="md-ellipsis">
      _BaseResults
    </span>
  </a>
  
    <nav class="md-nav" aria-label="_BaseResults">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.bulk_argon" class="md-nav__link">
    <span class="md-ellipsis">
      bulk_argon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.corrected_liquid_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      corrected_liquid_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.corrected_solid_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      corrected_solid_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.dimensional_meltpond_onset_time" class="md-nav__link">
    <span class="md-ellipsis">
      dimensional_meltpond_onset_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.oil_mass_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      oil_mass_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults._is_ice" class="md-nav__link">
    <span class="md-ellipsis">
      _is_ice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults._top_cell_is_ice" class="md-nav__link">
    <span class="md-ellipsis">
      _top_cell_is_ice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.emitted_LW" class="md-nav__link">
    <span class="md-ellipsis">
      emitted_LW
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.ice_bulk_gas_content" class="md-nav__link">
    <span class="md-ellipsis">
      ice_bulk_gas_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.latent_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      latent_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.net_LW" class="md-nav__link">
    <span class="md-ellipsis">
      net_LW
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.sensible_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      sensible_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.surface_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      surface_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.surface_temp_K" class="md-nav__link">
    <span class="md-ellipsis">
      surface_temp_K
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.total_albedo" class="md-nav__link">
    <span class="md-ellipsis">
      total_albedo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.total_bulk_gas_content" class="md-nav__link">
    <span class="md-ellipsis">
      total_bulk_gas_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.total_transmittance" class="md-nav__link">
    <span class="md-ellipsis">
      total_transmittance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.oil_mass" class="md-nav__link">
    <span class="md-ellipsis">
      oil_mass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="oil_mass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.oil_mass.convert_gas_fraction_to_oil_mass_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      convert_gas_fraction_to_oil_mass_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.oil_mass.convert_oil_mass_ratio_to_gas_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      convert_oil_mass_ratio_to_gas_fraction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
    <nav class="md-nav" aria-label="params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.BRW09InitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09InitialConditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.CubicLiquidus" class="md-nav__link">
    <span class="md-ellipsis">
      CubicLiquidus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalBRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalBRW09OceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalConstantTurbulentFlux" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalConstantTurbulentFlux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalERA5Forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalFixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalFixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedTempOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalMonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonoBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalMonoBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalMonoBubbleParams.bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalMonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.B" class="md-nav__link">
    <span class="md-ellipsis">
      B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.Rayleigh_salt" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.damkohler_number" class="md-nav__link">
    <span class="md-ellipsis">
      damkohler_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.expansion_coefficient" class="md-nav__link">
    <span class="md-ellipsis">
      expansion_coefficient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.frame_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      frame_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.lewis_gas" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.savefreq" class="md-nav__link">
    <span class="md-ellipsis">
      savefreq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.scales" class="md-nav__link">
    <span class="md-ellipsis">
      scales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.total_time" class="md-nav__link">
    <span class="md-ellipsis">
      total_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalPowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalPowerLawBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalPowerLawBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      maximum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      minimum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalRobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalRobinForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalWaterParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalWaterParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.concentration_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      concentration_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.eddy_diffusivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      eddy_diffusivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.lewis_salt" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.ocean_freezing_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_freezing_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.salinity_difference" class="md-nav__link">
    <span class="md-ellipsis">
      salinity_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.snow_conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      snow_conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.specific_heat_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      specific_heat_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.stefan_number" class="md-nav__link">
    <span class="md-ellipsis">
      stefan_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.temperature_difference" class="md-nav__link">
    <span class="md-ellipsis">
      temperature_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.thermal_diffusivity" class="md-nav__link">
    <span class="md-ellipsis">
      thermal_diffusivity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.NoBrineConvection" class="md-nav__link">
    <span class="md-ellipsis">
      NoBrineConvection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.NumericalParams" class="md-nav__link">
    <span class="md-ellipsis">
      NumericalParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.UniformInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      UniformInitialConditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.bubble" class="md-nav__link">
    <span class="md-ellipsis">
      bubble
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bubble">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.bubble.BaseBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      BaseBubbleParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.bubble.MonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      MonoBubbleParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.bubble.PowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      PowerLawBubbleParams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convection" class="md-nav__link">
    <span class="md-ellipsis">
      convection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convection.RJW14Params" class="md-nav__link">
    <span class="md-ellipsis">
      RJW14Params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert" class="md-nav__link">
    <span class="md-ellipsis">
      convert
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales" class="md-nav__link">
    <span class="md-ellipsis">
      Scales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.time_scale" class="md-nav__link">
    <span class="md-ellipsis">
      time_scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.velocity_scale" class="md-nav__link">
    <span class="md-ellipsis">
      velocity_scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_dimensional_bulk_air_to_argon_content" class="md-nav__link">
    <span class="md-ellipsis">
      convert_dimensional_bulk_air_to_argon_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_bulk_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_bulk_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_bulk_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_dissolved_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_dissolved_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_grid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_heating" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_heating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_time" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_bulk_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_bulk_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_bulk_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_dissolved_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_dissolved_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_grid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_time" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_time
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional" class="md-nav__link">
    <span class="md-ellipsis">
      dimensional
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dimensional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble" class="md-nav__link">
    <span class="md-ellipsis">
      bubble
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bubble">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalMonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonoBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalMonoBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalMonoBubbleParams.bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalPowerLawBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalPowerLawBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      maximum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      minimum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.convection" class="md-nav__link">
    <span class="md-ellipsis">
      convection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.convection.NoBrineConvection" class="md-nav__link">
    <span class="md-ellipsis">
      NoBrineConvection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional" class="md-nav__link">
    <span class="md-ellipsis">
      dimensional
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dimensional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.B" class="md-nav__link">
    <span class="md-ellipsis">
      B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.Rayleigh_salt" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.damkohler_number" class="md-nav__link">
    <span class="md-ellipsis">
      damkohler_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.expansion_coefficient" class="md-nav__link">
    <span class="md-ellipsis">
      expansion_coefficient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.frame_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      frame_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.lewis_gas" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.savefreq" class="md-nav__link">
    <span class="md-ellipsis">
      savefreq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.scales" class="md-nav__link">
    <span class="md-ellipsis">
      scales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.total_time" class="md-nav__link">
    <span class="md-ellipsis">
      total_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.forcing" class="md-nav__link">
    <span class="md-ellipsis">
      forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.forcing.DimensionalConstantTurbulentFlux" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalConstantTurbulentFlux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.forcing.DimensionalERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalERA5Forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.forcing.DimensionalRobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalRobinForcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      initial_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initial_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.initial_conditions.BRW09InitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09InitialConditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.initial_conditions.UniformInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      UniformInitialConditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.numerical" class="md-nav__link">
    <span class="md-ellipsis">
      numerical
    </span>
  </a>
  
    <nav class="md-nav" aria-label="numerical">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.numerical.NumericalParams" class="md-nav__link">
    <span class="md-ellipsis">
      NumericalParams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ocean_forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing.DimensionalBRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalBRW09OceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing.DimensionalFixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing.DimensionalFixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedTempOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing.DimensionalMonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water" class="md-nav__link">
    <span class="md-ellipsis">
      water
    </span>
  </a>
  
    <nav class="md-nav" aria-label="water">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.CubicLiquidus" class="md-nav__link">
    <span class="md-ellipsis">
      CubicLiquidus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalWaterParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalWaterParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.concentration_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      concentration_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.eddy_diffusivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      eddy_diffusivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.lewis_salt" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.ocean_freezing_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_freezing_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.salinity_difference" class="md-nav__link">
    <span class="md-ellipsis">
      salinity_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.snow_conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      snow_conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.specific_heat_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      specific_heat_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.stefan_number" class="md-nav__link">
    <span class="md-ellipsis">
      stefan_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.temperature_difference" class="md-nav__link">
    <span class="md-ellipsis">
      temperature_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.thermal_diffusivity" class="md-nav__link">
    <span class="md-ellipsis">
      thermal_diffusivity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing" class="md-nav__link">
    <span class="md-ellipsis">
      forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.BRW09Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09Forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BRW09Forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.BRW09Forcing.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.ConstantForcing" class="md-nav__link">
    <span class="md-ellipsis">
      ConstantForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.ERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      ERA5Forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.RadForcing" class="md-nav__link">
    <span class="md-ellipsis">
      RadForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.RobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      RobinForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.YearlyForcing" class="md-nav__link">
    <span class="md-ellipsis">
      YearlyForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing._calculate_specific_humidity" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_specific_humidity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing._filter_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      _filter_missing_values
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      initial_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initial_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.initial_conditions.OilInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      OilInitialConditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ocean_forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.BRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09OceanForcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BRW09OceanForcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.BRW09OceanForcing.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.FixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      FixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.FixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      FixedTempOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.MonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      MonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
    <nav class="md-nav" aria-label="params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.params.Config" class="md-nav__link">
    <span class="md-ellipsis">
      Config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.params.get_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.physical" class="md-nav__link">
    <span class="md-ellipsis">
      physical
    </span>
  </a>
  
    <nav class="md-nav" aria-label="physical">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.physical.BasePhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      BasePhysicalParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.physical.DISEQPhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQPhysicalParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.physical.EQMPhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      EQMPhysicalParams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.run_simulation" class="md-nav__link">
    <span class="md-ellipsis">
      run_simulation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="run_simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.run_simulation.run_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_batch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.state" class="md-nav__link">
    <span class="md-ellipsis">
      state
    </span>
  </a>
  
    <nav class="md-nav" aria-label="state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state" class="md-nav__link">
    <span class="md-ellipsis">
      disequilibrium_state
    </span>
  </a>
  
    <nav class="md-nav" aria-label="disequilibrium_state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQState" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DISEQState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQState.gas" class="md-nav__link">
    <span class="md-ellipsis">
      gas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQStateBCs" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQStateBCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQStateFull" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQStateFull
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DISEQStateFull">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQStateFull.gas" class="md-nav__link">
    <span class="md-ellipsis">
      gas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.equilibrium_state" class="md-nav__link">
    <span class="md-ellipsis">
      equilibrium_state
    </span>
  </a>
  
    <nav class="md-nav" aria-label="equilibrium_state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.equilibrium_state.EQMState" class="md-nav__link">
    <span class="md-ellipsis">
      EQMState
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.equilibrium_state.EQMStateBCs" class="md-nav__link">
    <span class="md-ellipsis">
      EQMStateBCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.equilibrium_state.EQMStateFull" class="md-nav__link">
    <span class="md-ellipsis">
      EQMStateFull
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="Changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#seaice3p" class="md-nav__link">
    <span class="md-ellipsis">
      seaice3p
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.BRW09Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09Forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BRW09Forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.BRW09Forcing.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.BRW09InitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09InitialConditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.BRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09OceanForcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BRW09OceanForcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.BRW09OceanForcing.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.Config" class="md-nav__link">
    <span class="md-ellipsis">
      Config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.ConstantForcing" class="md-nav__link">
    <span class="md-ellipsis">
      ConstantForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.CubicLiquidus" class="md-nav__link">
    <span class="md-ellipsis">
      CubicLiquidus
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DISEQPhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQPhysicalParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalBRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalBRW09OceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalConstantTurbulentFlux" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalConstantTurbulentFlux
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalERA5Forcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalFixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalFixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedTempOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalMonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonoBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalMonoBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalMonoBubbleParams.bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalMonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.B" class="md-nav__link">
    <span class="md-ellipsis">
      B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.Rayleigh_salt" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.damkohler_number" class="md-nav__link">
    <span class="md-ellipsis">
      damkohler_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.expansion_coefficient" class="md-nav__link">
    <span class="md-ellipsis">
      expansion_coefficient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.frame_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      frame_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.lewis_gas" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.savefreq" class="md-nav__link">
    <span class="md-ellipsis">
      savefreq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.scales" class="md-nav__link">
    <span class="md-ellipsis">
      scales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.total_time" class="md-nav__link">
    <span class="md-ellipsis">
      total_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalParams.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalPowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalPowerLawBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalPowerLawBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      maximum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      minimum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalRobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalRobinForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalWaterParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalWaterParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.concentration_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      concentration_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.eddy_diffusivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      eddy_diffusivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.lewis_salt" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.ocean_freezing_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_freezing_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.salinity_difference" class="md-nav__link">
    <span class="md-ellipsis">
      salinity_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.snow_conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      snow_conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.specific_heat_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      specific_heat_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.stefan_number" class="md-nav__link">
    <span class="md-ellipsis">
      stefan_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.temperature_difference" class="md-nav__link">
    <span class="md-ellipsis">
      temperature_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.DimensionalWaterParams.thermal_diffusivity" class="md-nav__link">
    <span class="md-ellipsis">
      thermal_diffusivity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.EQMPhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      EQMPhysicalParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.ERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      ERA5Forcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.FixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      FixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.FixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      FixedTempOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.MonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      MonoBubbleParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.MonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      MonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.NoBrineConvection" class="md-nav__link">
    <span class="md-ellipsis">
      NoBrineConvection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.NumericalParams" class="md-nav__link">
    <span class="md-ellipsis">
      NumericalParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.OilInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      OilInitialConditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.PowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      PowerLawBubbleParams
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.RJW14Params" class="md-nav__link">
    <span class="md-ellipsis">
      RJW14Params
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.RadForcing" class="md-nav__link">
    <span class="md-ellipsis">
      RadForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.RobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      RobinForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.Scales" class="md-nav__link">
    <span class="md-ellipsis">
      Scales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.time_scale" class="md-nav__link">
    <span class="md-ellipsis">
      time_scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.velocity_scale" class="md-nav__link">
    <span class="md-ellipsis">
      velocity_scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_dimensional_bulk_air_to_argon_content" class="md-nav__link">
    <span class="md-ellipsis">
      convert_dimensional_bulk_air_to_argon_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_bulk_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_bulk_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_bulk_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_dissolved_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_dissolved_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_grid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_heating" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_heating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_from_dimensional_time" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_bulk_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_bulk_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_bulk_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_dissolved_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_dissolved_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_grid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.Scales.convert_to_dimensional_time" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_time
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.UniformInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      UniformInitialConditions
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.YearlyForcing" class="md-nav__link">
    <span class="md-ellipsis">
      YearlyForcing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.get_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_config
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.enthalpy_method" class="md-nav__link">
    <span class="md-ellipsis">
      enthalpy_method
    </span>
  </a>
  
    <nav class="md-nav" aria-label="enthalpy_method">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.enthalpy_method.enthalpy_method" class="md-nav__link">
    <span class="md-ellipsis">
      enthalpy_method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.enthalpy_method.phase_boundaries" class="md-nav__link">
    <span class="md-ellipsis">
      phase_boundaries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.equations" class="md-nav__link">
    <span class="md-ellipsis">
      equations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14" class="md-nav__link">
    <span class="md-ellipsis">
      RJW14
    </span>
  </a>
  
    <nav class="md-nav" aria-label="RJW14">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms" class="md-nav__link">
    <span class="md-ellipsis">
      brine_channel_sink_terms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="brine_channel_sink_terms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms._DISEQ_brine_convection_sink" class="md-nav__link">
    <span class="md-ellipsis">
      _DISEQ_brine_convection_sink
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms._EQM_brine_convection_sink" class="md-nav__link">
    <span class="md-ellipsis">
      _EQM_brine_convection_sink
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms._calculate_bulk_dissolved_gas_sink" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_bulk_dissolved_gas_sink
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_channel_sink_terms._calculate_gas_sink" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_gas_sink
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage" class="md-nav__link">
    <span class="md-ellipsis">
      brine_drainage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="brine_drainage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_Rayleigh" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_Rayleigh
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_brine_channel_sink" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_brine_channel_sink
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_brine_channel_strength" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_brine_channel_strength
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_brine_convection_liquid_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_brine_convection_liquid_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_integrated_mean_permeability" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_integrated_mean_permeability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.calculate_permeability" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_permeability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.get_convecting_region_height" class="md-nav__link">
    <span class="md-ellipsis">
      get_convecting_region_height
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.RJW14.brine_drainage.get_effective_Rayleigh_number" class="md-nav__link">
    <span class="md-ellipsis">
      get_effective_Rayleigh_number
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.equations" class="md-nav__link">
    <span class="md-ellipsis">
      equations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.equations._prevent_gas_rise_into_saturated_cell" class="md-nav__link">
    <span class="md-ellipsis">
      _prevent_gas_rise_into_saturated_cell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux" class="md-nav__link">
    <span class="md-ellipsis">
      flux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.bulk_dissolved_gas_flux" class="md-nav__link">
    <span class="md-ellipsis">
      bulk_dissolved_gas_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.gas_fraction_flux" class="md-nav__link">
    <span class="md-ellipsis">
      gas_fraction_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      heat_flux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="heat_flux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.heat_flux.calculate_conductive_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_conductive_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.heat_flux.pure_liquid_switch" class="md-nav__link">
    <span class="md-ellipsis">
      pure_liquid_switch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.salt_flux" class="md-nav__link">
    <span class="md-ellipsis">
      salt_flux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="salt_flux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.flux.salt_flux.calculate_diffusive_salt_flux" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_diffusive_salt_flux
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.nucleation" class="md-nav__link">
    <span class="md-ellipsis">
      nucleation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nucleation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.nucleation._DISEQ_nucleation" class="md-nav__link">
    <span class="md-ellipsis">
      _DISEQ_nucleation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.nucleation._EQM_nucleation" class="md-nav__link">
    <span class="md-ellipsis">
      _EQM_nucleation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.radiative_heating" class="md-nav__link">
    <span class="md-ellipsis">
      radiative_heating
    </span>
  </a>
  
    <nav class="md-nav" aria-label="radiative_heating">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.radiative_heating._calculate_non_dimensional_shortwave_heating" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_non_dimensional_shortwave_heating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.radiative_heating.get_radiative_heating" class="md-nav__link">
    <span class="md-ellipsis">
      get_radiative_heating
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities" class="md-nav__link">
    <span class="md-ellipsis">
      velocities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="velocities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.bubble_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_parameters
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bubble_parameters">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.bubble_parameters.calculate_bubble_size_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_bubble_size_fraction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      mono_distribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="mono_distribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution.calculate_lag_function" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_lag_function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution.calculate_mono_lag_factor" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_mono_lag_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution.calculate_mono_wall_drag_factor" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_mono_wall_drag_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.mono_distribution.calculate_wall_drag_function" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_wall_drag_function
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      power_law_distribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="power_law_distribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_lag_integrand" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_lag_integrand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_power_law_lag_factor" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_power_law_lag_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_power_law_wall_drag_factor" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_power_law_wall_drag_factor
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_volume_integrand" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_volume_integrand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.power_law_distribution.calculate_wall_drag_integrand" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_wall_drag_integrand
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.velocities" class="md-nav__link">
    <span class="md-ellipsis">
      velocities
    </span>
  </a>
  
    <nav class="md-nav" aria-label="velocities">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.velocities.calculate_gas_interstitial_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_gas_interstitial_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.velocities.calculate_liquid_darcy_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_liquid_darcy_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.equations.velocities.velocities.calculate_velocities" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_velocities
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.example" class="md-nav__link">
    <span class="md-ellipsis">
      example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.example.main" class="md-nav__link">
    <span class="md-ellipsis">
      main
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.forcing" class="md-nav__link">
    <span class="md-ellipsis">
      forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      boundary_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="boundary_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._dissolved_gas_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _dissolved_gas_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._enthalpy_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _enthalpy_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._gas_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _gas_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._gas_fraction_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _gas_fraction_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._liquid_fraction_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _liquid_fraction_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._liquid_salinity_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _liquid_salinity_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._salt_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _salt_BCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.boundary_conditions._temperature_BCs" class="md-nav__link">
    <span class="md-ellipsis">
      _temperature_BCs
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.radiative_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      radiative_forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="radiative_forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.radiative_forcing._constant_LW_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _constant_LW_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.radiative_forcing._constant_SW_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _constant_SW_forcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance" class="md-nav__link">
    <span class="md-ellipsis">
      surface_energy_balance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="surface_energy_balance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.surface_energy_balance" class="md-nav__link">
    <span class="md-ellipsis">
      surface_energy_balance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="surface_energy_balance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.surface_energy_balance._calculate_total_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_total_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.surface_energy_balance.find_ghost_cell_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      find_ghost_cell_temperature
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      turbulent_heat_flux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="turbulent_heat_flux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_bulk_transfer_coefficient" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_bulk_transfer_coefficient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_air_temp" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_ref_air_temp
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_atmospheric_pressure" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_ref_atmospheric_pressure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_specific_humidity" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_ref_specific_humidity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_windspeed" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_ref_windspeed
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_surface_specific_humidity" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_surface_specific_humidity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux.calculate_latent_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_latent_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.surface_energy_balance.turbulent_heat_flux.calculate_sensible_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_sensible_heat_flux
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      temperature_forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="temperature_forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._Robin_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _Robin_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._barrow_ocean_temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _barrow_ocean_temperature_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._barrow_temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _barrow_temperature_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._dimensional_barrow_ocean_temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _dimensional_barrow_ocean_temperature_forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.forcing.temperature_forcing._dimensional_barrow_temperature_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      _dimensional_barrow_temperature_forcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.grids" class="md-nav__link">
    <span class="md-ellipsis">
      grids
    </span>
  </a>
  
    <nav class="md-nav" aria-label="grids">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids" class="md-nav__link">
    <span class="md-ellipsis">
      Grids
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Grids">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.D_e" class="md-nav__link">
    <span class="md-ellipsis">
      D_e
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.D_g" class="md-nav__link">
    <span class="md-ellipsis">
      D_g
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.centers" class="md-nav__link">
    <span class="md-ellipsis">
      centers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.ghosts" class="md-nav__link">
    <span class="md-ellipsis">
      ghosts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.Grids.step" class="md-nav__link">
    <span class="md-ellipsis">
      step
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.add_ghost_cells" class="md-nav__link">
    <span class="md-ellipsis">
      add_ghost_cells
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.average" class="md-nav__link">
    <span class="md-ellipsis">
      average
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.calculate_ice_ocean_boundary_depth" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_ice_ocean_boundary_depth
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.grids.geometric" class="md-nav__link">
    <span class="md-ellipsis">
      geometric
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      initial_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initial_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._apply_value_in_ice_layer" class="md-nav__link">
    <span class="md-ellipsis">
      _apply_value_in_ice_layer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._get_barrow_initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      _get_barrow_initial_conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._get_oil_initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      _get_oil_initial_conditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._get_previous_simulation_final_state" class="md-nav__link">
    <span class="md-ellipsis">
      _get_previous_simulation_final_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.initial_conditions._get_uniform_initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      _get_uniform_initial_conditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
    <nav class="md-nav" aria-label="load">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.load.DISEQResults" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQResults
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DISEQResults">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.load.DISEQResults.bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      bulk_gas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults" class="md-nav__link">
    <span class="md-ellipsis">
      _BaseResults
    </span>
  </a>
  
    <nav class="md-nav" aria-label="_BaseResults">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.bulk_argon" class="md-nav__link">
    <span class="md-ellipsis">
      bulk_argon
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.corrected_liquid_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      corrected_liquid_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.corrected_solid_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      corrected_solid_fraction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.dimensional_meltpond_onset_time" class="md-nav__link">
    <span class="md-ellipsis">
      dimensional_meltpond_onset_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.oil_mass_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      oil_mass_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults._is_ice" class="md-nav__link">
    <span class="md-ellipsis">
      _is_ice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults._top_cell_is_ice" class="md-nav__link">
    <span class="md-ellipsis">
      _top_cell_is_ice
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.emitted_LW" class="md-nav__link">
    <span class="md-ellipsis">
      emitted_LW
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.ice_bulk_gas_content" class="md-nav__link">
    <span class="md-ellipsis">
      ice_bulk_gas_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.latent_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      latent_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.net_LW" class="md-nav__link">
    <span class="md-ellipsis">
      net_LW
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.sensible_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      sensible_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.surface_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      surface_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.surface_temp_K" class="md-nav__link">
    <span class="md-ellipsis">
      surface_temp_K
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.total_albedo" class="md-nav__link">
    <span class="md-ellipsis">
      total_albedo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.total_bulk_gas_content" class="md-nav__link">
    <span class="md-ellipsis">
      total_bulk_gas_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.load._BaseResults.total_transmittance" class="md-nav__link">
    <span class="md-ellipsis">
      total_transmittance
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.oil_mass" class="md-nav__link">
    <span class="md-ellipsis">
      oil_mass
    </span>
  </a>
  
    <nav class="md-nav" aria-label="oil_mass">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.oil_mass.convert_gas_fraction_to_oil_mass_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      convert_gas_fraction_to_oil_mass_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.oil_mass.convert_oil_mass_ratio_to_gas_fraction" class="md-nav__link">
    <span class="md-ellipsis">
      convert_oil_mass_ratio_to_gas_fraction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
    <nav class="md-nav" aria-label="params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.BRW09InitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09InitialConditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.CubicLiquidus" class="md-nav__link">
    <span class="md-ellipsis">
      CubicLiquidus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalBRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalBRW09OceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalConstantTurbulentFlux" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalConstantTurbulentFlux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalERA5Forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalFixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalFixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedTempOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalMonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonoBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalMonoBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalMonoBubbleParams.bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalMonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.B" class="md-nav__link">
    <span class="md-ellipsis">
      B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.Rayleigh_salt" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.damkohler_number" class="md-nav__link">
    <span class="md-ellipsis">
      damkohler_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.expansion_coefficient" class="md-nav__link">
    <span class="md-ellipsis">
      expansion_coefficient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.frame_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      frame_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.lewis_gas" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.savefreq" class="md-nav__link">
    <span class="md-ellipsis">
      savefreq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.scales" class="md-nav__link">
    <span class="md-ellipsis">
      scales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.total_time" class="md-nav__link">
    <span class="md-ellipsis">
      total_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalParams.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalPowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalPowerLawBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalPowerLawBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      maximum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      minimum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalRobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalRobinForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalWaterParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalWaterParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.concentration_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      concentration_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.eddy_diffusivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      eddy_diffusivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.lewis_salt" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.ocean_freezing_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_freezing_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.salinity_difference" class="md-nav__link">
    <span class="md-ellipsis">
      salinity_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.snow_conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      snow_conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.specific_heat_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      specific_heat_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.stefan_number" class="md-nav__link">
    <span class="md-ellipsis">
      stefan_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.temperature_difference" class="md-nav__link">
    <span class="md-ellipsis">
      temperature_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.DimensionalWaterParams.thermal_diffusivity" class="md-nav__link">
    <span class="md-ellipsis">
      thermal_diffusivity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.NoBrineConvection" class="md-nav__link">
    <span class="md-ellipsis">
      NoBrineConvection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.NumericalParams" class="md-nav__link">
    <span class="md-ellipsis">
      NumericalParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.UniformInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      UniformInitialConditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.bubble" class="md-nav__link">
    <span class="md-ellipsis">
      bubble
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bubble">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.bubble.BaseBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      BaseBubbleParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.bubble.MonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      MonoBubbleParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.bubble.PowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      PowerLawBubbleParams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convection" class="md-nav__link">
    <span class="md-ellipsis">
      convection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convection.RJW14Params" class="md-nav__link">
    <span class="md-ellipsis">
      RJW14Params
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert" class="md-nav__link">
    <span class="md-ellipsis">
      convert
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convert">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales" class="md-nav__link">
    <span class="md-ellipsis">
      Scales
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Scales">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.time_scale" class="md-nav__link">
    <span class="md-ellipsis">
      time_scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.velocity_scale" class="md-nav__link">
    <span class="md-ellipsis">
      velocity_scale
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_dimensional_bulk_air_to_argon_content" class="md-nav__link">
    <span class="md-ellipsis">
      convert_dimensional_bulk_air_to_argon_content
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_bulk_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_bulk_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_bulk_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_dissolved_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_dissolved_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_grid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_heating" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_heating
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_from_dimensional_time" class="md-nav__link">
    <span class="md-ellipsis">
      convert_from_dimensional_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_bulk_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_bulk_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_bulk_salinity" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_bulk_salinity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_dissolved_gas" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_dissolved_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_grid" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_heat_flux" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_heat_flux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.convert.Scales.convert_to_dimensional_time" class="md-nav__link">
    <span class="md-ellipsis">
      convert_to_dimensional_time
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional" class="md-nav__link">
    <span class="md-ellipsis">
      dimensional
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dimensional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble" class="md-nav__link">
    <span class="md-ellipsis">
      bubble
    </span>
  </a>
  
    <nav class="md-nav" aria-label="bubble">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalMonoBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonoBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalMonoBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalMonoBubbleParams.bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalPowerLawBubbleParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalPowerLawBubbleParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      maximum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="md-nav__link">
    <span class="md-ellipsis">
      minimum_bubble_radius_scaled
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.convection" class="md-nav__link">
    <span class="md-ellipsis">
      convection
    </span>
  </a>
  
    <nav class="md-nav" aria-label="convection">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.convection.NoBrineConvection" class="md-nav__link">
    <span class="md-ellipsis">
      NoBrineConvection
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional" class="md-nav__link">
    <span class="md-ellipsis">
      dimensional
    </span>
  </a>
  
    <nav class="md-nav" aria-label="dimensional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.B" class="md-nav__link">
    <span class="md-ellipsis">
      B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.Rayleigh_salt" class="md-nav__link">
    <span class="md-ellipsis">
      Rayleigh_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.damkohler_number" class="md-nav__link">
    <span class="md-ellipsis">
      damkohler_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.expansion_coefficient" class="md-nav__link">
    <span class="md-ellipsis">
      expansion_coefficient
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.frame_velocity" class="md-nav__link">
    <span class="md-ellipsis">
      frame_velocity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.lewis_gas" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_gas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.savefreq" class="md-nav__link">
    <span class="md-ellipsis">
      savefreq
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.scales" class="md-nav__link">
    <span class="md-ellipsis">
      scales
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.total_time" class="md-nav__link">
    <span class="md-ellipsis">
      total_time
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.load" class="md-nav__link">
    <span class="md-ellipsis">
      load
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.dimensional.DimensionalParams.save" class="md-nav__link">
    <span class="md-ellipsis">
      save
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.forcing" class="md-nav__link">
    <span class="md-ellipsis">
      forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.forcing.DimensionalConstantTurbulentFlux" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalConstantTurbulentFlux
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.forcing.DimensionalERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalERA5Forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.forcing.DimensionalRobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalRobinForcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      initial_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initial_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.initial_conditions.BRW09InitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09InitialConditions
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.initial_conditions.UniformInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      UniformInitialConditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.numerical" class="md-nav__link">
    <span class="md-ellipsis">
      numerical
    </span>
  </a>
  
    <nav class="md-nav" aria-label="numerical">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.numerical.NumericalParams" class="md-nav__link">
    <span class="md-ellipsis">
      NumericalParams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ocean_forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing.DimensionalBRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalBRW09OceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing.DimensionalFixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing.DimensionalFixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalFixedTempOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.ocean_forcing.DimensionalMonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalMonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water" class="md-nav__link">
    <span class="md-ellipsis">
      water
    </span>
  </a>
  
    <nav class="md-nav" aria-label="water">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.CubicLiquidus" class="md-nav__link">
    <span class="md-ellipsis">
      CubicLiquidus
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams" class="md-nav__link">
    <span class="md-ellipsis">
      DimensionalWaterParams
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DimensionalWaterParams">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.concentration_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      concentration_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.eddy_diffusivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      eddy_diffusivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.lewis_salt" class="md-nav__link">
    <span class="md-ellipsis">
      lewis_salt
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.ocean_freezing_temperature" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_freezing_temperature
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.salinity_difference" class="md-nav__link">
    <span class="md-ellipsis">
      salinity_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.snow_conductivity_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      snow_conductivity_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.specific_heat_ratio" class="md-nav__link">
    <span class="md-ellipsis">
      specific_heat_ratio
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.stefan_number" class="md-nav__link">
    <span class="md-ellipsis">
      stefan_number
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.temperature_difference" class="md-nav__link">
    <span class="md-ellipsis">
      temperature_difference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.dimensional.water.DimensionalWaterParams.thermal_diffusivity" class="md-nav__link">
    <span class="md-ellipsis">
      thermal_diffusivity
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing" class="md-nav__link">
    <span class="md-ellipsis">
      forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.BRW09Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09Forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BRW09Forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.BRW09Forcing.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.ConstantForcing" class="md-nav__link">
    <span class="md-ellipsis">
      ConstantForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.ERA5Forcing" class="md-nav__link">
    <span class="md-ellipsis">
      ERA5Forcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.RadForcing" class="md-nav__link">
    <span class="md-ellipsis">
      RadForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.RobinForcing" class="md-nav__link">
    <span class="md-ellipsis">
      RobinForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing.YearlyForcing" class="md-nav__link">
    <span class="md-ellipsis">
      YearlyForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing._calculate_specific_humidity" class="md-nav__link">
    <span class="md-ellipsis">
      _calculate_specific_humidity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.forcing._filter_missing_values" class="md-nav__link">
    <span class="md-ellipsis">
      _filter_missing_values
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.initial_conditions" class="md-nav__link">
    <span class="md-ellipsis">
      initial_conditions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="initial_conditions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.initial_conditions.OilInitialConditions" class="md-nav__link">
    <span class="md-ellipsis">
      OilInitialConditions
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing" class="md-nav__link">
    <span class="md-ellipsis">
      ocean_forcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ocean_forcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.BRW09OceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      BRW09OceanForcing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="BRW09OceanForcing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.BRW09OceanForcing.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.FixedHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      FixedHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.FixedTempOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      FixedTempOceanForcing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.ocean_forcing.MonthlyHeatFluxOceanForcing" class="md-nav__link">
    <span class="md-ellipsis">
      MonthlyHeatFluxOceanForcing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.params" class="md-nav__link">
    <span class="md-ellipsis">
      params
    </span>
  </a>
  
    <nav class="md-nav" aria-label="params">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.params.Config" class="md-nav__link">
    <span class="md-ellipsis">
      Config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.params.get_config" class="md-nav__link">
    <span class="md-ellipsis">
      get_config
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.physical" class="md-nav__link">
    <span class="md-ellipsis">
      physical
    </span>
  </a>
  
    <nav class="md-nav" aria-label="physical">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.physical.BasePhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      BasePhysicalParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.physical.DISEQPhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQPhysicalParams
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.params.physical.EQMPhysicalParams" class="md-nav__link">
    <span class="md-ellipsis">
      EQMPhysicalParams
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.plot" class="md-nav__link">
    <span class="md-ellipsis">
      plot
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.run_simulation" class="md-nav__link">
    <span class="md-ellipsis">
      run_simulation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="run_simulation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.run_simulation.run_batch" class="md-nav__link">
    <span class="md-ellipsis">
      run_batch
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#seaice3p.state" class="md-nav__link">
    <span class="md-ellipsis">
      state
    </span>
  </a>
  
    <nav class="md-nav" aria-label="state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state" class="md-nav__link">
    <span class="md-ellipsis">
      disequilibrium_state
    </span>
  </a>
  
    <nav class="md-nav" aria-label="disequilibrium_state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQState" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQState
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DISEQState">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQState.gas" class="md-nav__link">
    <span class="md-ellipsis">
      gas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQStateBCs" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQStateBCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQStateFull" class="md-nav__link">
    <span class="md-ellipsis">
      DISEQStateFull
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DISEQStateFull">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.disequilibrium_state.DISEQStateFull.gas" class="md-nav__link">
    <span class="md-ellipsis">
      gas
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.equilibrium_state" class="md-nav__link">
    <span class="md-ellipsis">
      equilibrium_state
    </span>
  </a>
  
    <nav class="md-nav" aria-label="equilibrium_state">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.equilibrium_state.EQMState" class="md-nav__link">
    <span class="md-ellipsis">
      EQMState
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.equilibrium_state.EQMStateBCs" class="md-nav__link">
    <span class="md-ellipsis">
      EQMStateBCs
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#seaice3p.state.equilibrium_state.EQMStateFull" class="md-nav__link">
    <span class="md-ellipsis">
      EQMStateFull
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="api-reference">API Reference</h1>


<div class="doc doc-object doc-module">



<a id="seaice3p"></a>
    <div class="doc doc-contents first">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="seaice3p.BRW09Forcing" class="doc doc-heading">
            <code>BRW09Forcing</code>


</h2>


    <div class="doc doc-contents ">


        <p>Surface and ocean temperature data loaded from thermistor temperature record
during the Barrow 2009 field study.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BRW09Forcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Surface and ocean temperature data loaded from thermistor temperature record</span>
<span class="sd">    during the Barrow 2009 field study.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Barrow_top_temperature_data_choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;air&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;populate class attributes with barrow dimensional air temperature</span>
<span class="sd">        and time in days (with missing values filtered out).</span>

<span class="sd">        Note the metadata explaining how to use the barrow temperature data is also</span>
<span class="sd">        in seaice3p/forcing_data. The indices corresponding to days and air temp are</span>
<span class="sd">        hard coded in as class variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DATA_INDICES</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;air&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;bottom_snow&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
            <span class="s2">&quot;top_ice&quot;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;forcing_data/BRW09.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">top_temp_index</span> <span class="o">=</span> <span class="n">DATA_INDICES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Barrow_top_temperature_data_choice</span><span class="p">]</span>
        <span class="n">time_index</span> <span class="o">=</span> <span class="n">DATA_INDICES</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>

        <span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">top_temp_index</span><span class="p">]</span>
        <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">time_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="p">]</span>
        <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">_filter_missing_values</span><span class="p">(</span>
            <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">barrow_days</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">barrow_top_temp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barrow_days</span> <span class="o">=</span> <span class="n">barrow_days</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="seaice3p.BRW09Forcing.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>populate class attributes with barrow dimensional air temperature
and time in days (with missing values filtered out).</p>
<p>Note the metadata explaining how to use the barrow temperature data is also
in seaice3p/forcing_data. The indices corresponding to days and air temp are
hard coded in as class variables.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;populate class attributes with barrow dimensional air temperature</span>
<span class="sd">    and time in days (with missing values filtered out).</span>

<span class="sd">    Note the metadata explaining how to use the barrow temperature data is also</span>
<span class="sd">    in seaice3p/forcing_data. The indices corresponding to days and air temp are</span>
<span class="sd">    hard coded in as class variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DATA_INDICES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;air&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s2">&quot;bottom_snow&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
        <span class="s2">&quot;top_ice&quot;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;forcing_data/BRW09.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">top_temp_index</span> <span class="o">=</span> <span class="n">DATA_INDICES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Barrow_top_temperature_data_choice</span><span class="p">]</span>
    <span class="n">time_index</span> <span class="o">=</span> <span class="n">DATA_INDICES</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>

    <span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">top_temp_index</span><span class="p">]</span>
    <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">time_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="p">]</span>
    <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">_filter_missing_values</span><span class="p">(</span>
        <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">barrow_days</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">barrow_top_temp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">barrow_days</span> <span class="o">=</span> <span class="n">barrow_days</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.BRW09InitialConditions" class="doc doc-heading">
            <code>BRW09InitialConditions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>values for bottom (ocean) boundary</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/initial_conditions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BRW09InitialConditions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;values for bottom (ocean) boundary&quot;&quot;&quot;</span>

    <span class="n">Barrow_initial_bulk_gas_in_ice</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.BRW09OceanForcing" class="doc doc-heading">
            <code>BRW09OceanForcing</code>


</h2>


    <div class="doc doc-contents ">


        <p>Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean
fixed gas saturation state</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BRW09OceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean</span>
<span class="sd">    fixed gas saturation state&quot;&quot;&quot;</span>

    <span class="n">ocean_gas_sat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;populate class attributes with barrow dimensional ocean temperature</span>
<span class="sd">        and time in days (with missing values filtered out).</span>

<span class="sd">        Note the metadata explaining how to use the barrow temperature data is also</span>
<span class="sd">        in seaice3p/forcing_data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;forcing_data/BRW09.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">ocean_temp_index</span> <span class="o">=</span> <span class="mi">43</span>
        <span class="n">time_index</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ocean_temp_index</span><span class="p">]</span>
        <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">time_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="p">]</span>
        <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">_filter_missing_values</span><span class="p">(</span>
            <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">barrow_ocean_days</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">barrow_bottom_temp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">barrow_ocean_days</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="seaice3p.BRW09OceanForcing.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>populate class attributes with barrow dimensional ocean temperature
and time in days (with missing values filtered out).</p>
<p>Note the metadata explaining how to use the barrow temperature data is also
in seaice3p/forcing_data.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;populate class attributes with barrow dimensional ocean temperature</span>
<span class="sd">    and time in days (with missing values filtered out).</span>

<span class="sd">    Note the metadata explaining how to use the barrow temperature data is also</span>
<span class="sd">    in seaice3p/forcing_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;forcing_data/BRW09.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">ocean_temp_index</span> <span class="o">=</span> <span class="mi">43</span>
    <span class="n">time_index</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ocean_temp_index</span><span class="p">]</span>
    <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">time_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="p">]</span>
    <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">_filter_missing_values</span><span class="p">(</span>
        <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">barrow_ocean_days</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">barrow_bottom_temp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">barrow_ocean_days</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.Config" class="doc doc-heading">
            <code>Config</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>contains all information needed to run a simulation and save output</p>
<p>this config object can be saved and loaded to a yaml file.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/params.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Config</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;contains all information needed to run a simulation and save output</span>

<span class="sd">    this config object can be saved and loaded to a yaml file.&quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">savefreq</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">physical_params</span><span class="p">:</span> <span class="n">PhysicalParams</span>
    <span class="n">bubble_params</span><span class="p">:</span> <span class="n">BubbleParams</span>
    <span class="n">brine_convection_params</span><span class="p">:</span> <span class="n">BrineConvectionParams</span>
    <span class="n">forcing_config</span><span class="p">:</span> <span class="n">ForcingConfig</span>
    <span class="n">ocean_forcing_config</span><span class="p">:</span> <span class="n">OceanForcingConfig</span>
    <span class="n">initial_conditions_config</span><span class="p">:</span> <span class="n">InitialConditionsConfig</span>
    <span class="n">numerical_params</span><span class="p">:</span> <span class="n">NumericalParams</span> <span class="o">=</span> <span class="n">NumericalParams</span><span class="p">()</span>
    <span class="n">scales</span><span class="p">:</span> <span class="n">Scales</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">yaml</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.ConstantForcing" class="doc doc-heading">
            <code>ConstantForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Constant temperature forcing</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConstantForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constant temperature forcing&quot;&quot;&quot;</span>

    <span class="n">constant_top_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.CubicLiquidus" class="doc doc-heading">
            <code>CubicLiquidus</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Cubic fit to liquidus to give liquidus salinity in terms of temperature</p>
<p>S = a0 + a1 T + a2 T^2 + a3 T^3</p>
<p>defaults are taken from Notz PhD thesis for fit to Assur seawater data</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/water.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CubicLiquidus</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cubic fit to liquidus to give liquidus salinity in terms of temperature</span>

<span class="sd">    S = a0 + a1 T + a2 T^2 + a3 T^3</span>

<span class="sd">    defaults are taken from Notz PhD thesis for fit to Assur seawater data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">eutectic_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">21.1</span>  <span class="c1"># deg Celsius</span>
    <span class="n">a0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2</span>
    <span class="n">a1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">21.8</span>
    <span class="n">a2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.919</span>
    <span class="n">a3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0178</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_liquidus_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a0</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span> <span class="o">*</span> <span class="n">temperature</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span> <span class="o">*</span> <span class="n">temperature</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span> <span class="o">*</span> <span class="n">temperature</span><span class="o">**</span><span class="mi">3</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_liquidus_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">salinity</span><span class="p">):</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_liquidus_salinity</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">salinity</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">temperature</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">temperature</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DISEQPhysicalParams" class="doc doc-heading">
            <code>DISEQPhysicalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.params.physical.BasePhysicalParams" href="#seaice3p.params.physical.BasePhysicalParams">BasePhysicalParams</a></code></p>


        <p>non dimensional numbers for the mushy layer</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/physical.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DISEQPhysicalParams</span><span class="p">(</span><span class="n">BasePhysicalParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;non dimensional numbers for the mushy layer&quot;&quot;&quot;</span>

    <span class="c1"># only used in DISEQ model</span>
    <span class="n">damkohler_number</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalBRW09OceanForcing" class="doc doc-heading">
            <code>DimensionalBRW09OceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean
fixed gas saturation state</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalBRW09OceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean</span>
<span class="sd">    fixed gas saturation state&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalConstantTurbulentFlux" class="doc doc-heading">
            <code>DimensionalConstantTurbulentFlux</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Parameters for calculating the turbulent surface sensible and latent heat
fluxes</p>
<p>NOTE: If you are running a simulation with ERA5 reanalysis forcing you must set
the ref_height=2m as this is the appropriate value for the atmospheric reanalysis
quantities</p>
<p>The windspeed given here will only be used with ERA5 forcing if the windspeed key
is set to None in the forcing_data_file_keys dictionary.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalConstantTurbulentFlux</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for calculating the turbulent surface sensible and latent heat</span>
<span class="sd">    fluxes</span>

<span class="sd">    NOTE: If you are running a simulation with ERA5 reanalysis forcing you must set</span>
<span class="sd">    the ref_height=2m as this is the appropriate value for the atmospheric reanalysis</span>
<span class="sd">    quantities</span>

<span class="sd">    The windspeed given here will only be used with ERA5 forcing if the windspeed key</span>
<span class="sd">    is set to None in the forcing_data_file_keys dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ref_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># m</span>
    <span class="n">windspeed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># m/s</span>
    <span class="n">air_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># deg C</span>
    <span class="n">specific_humidity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.6e-3</span>  <span class="c1"># kg water / kg air</span>
    <span class="n">atm_pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">101.325</span>  <span class="c1"># KPa</span>

    <span class="n">air_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.275</span>  <span class="c1"># kg/m3</span>
    <span class="n">air_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1005</span>  <span class="c1"># J/kg K</span>
    <span class="n">air_latent_heat_of_vaporisation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.501e6</span>  <span class="c1"># J/kg</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalERA5Forcing" class="doc doc-heading">
            <code>DimensionalERA5Forcing</code>


</h2>


    <div class="doc doc-contents ">


        <p>read ERA5 data from netCDF file located at data_path.</p>
<p>Simulation will take atmospheric forcings from the start date specified in the
string format YYYY-MM-DD</p>
<p>forcing_data_file_keys is a mapping of the descriptive names of the
forcing data to be provided to the simulationa and the values are the corresponding
strings giving the name of that variable in the netCDF file.
The default values are the ERA5 variable names and the SnowModel-LG snow depth name.</p>
<p>Note that if you pass "sd" for the snow depth the simulation will assume you have
provided snow depth in m of water equivalent and you must provide a snow density for
the conversion.</p>
<p>If you pass None for the snow depth the simulation will procede with no snow layer.
If you pass None for the windspeed the simulation will use the constant windspeed
defined in the turbulent flux forcing parameters.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalERA5Forcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;read ERA5 data from netCDF file located at data_path.</span>

<span class="sd">    Simulation will take atmospheric forcings from the start date specified in the</span>
<span class="sd">    string format YYYY-MM-DD</span>

<span class="sd">    forcing_data_file_keys is a mapping of the descriptive names of the</span>
<span class="sd">    forcing data to be provided to the simulationa and the values are the corresponding</span>
<span class="sd">    strings giving the name of that variable in the netCDF file.</span>
<span class="sd">    The default values are the ERA5 variable names and the SnowModel-LG snow depth name.</span>

<span class="sd">    Note that if you pass &quot;sd&quot; for the snow depth the simulation will assume you have</span>
<span class="sd">    provided snow depth in m of water equivalent and you must provide a snow density for</span>
<span class="sd">    the conversion.</span>

<span class="sd">    If you pass None for the snow depth the simulation will procede with no snow layer.</span>
<span class="sd">    If you pass None for the windspeed the simulation will use the constant windspeed</span>
<span class="sd">    defined in the turbulent flux forcing parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_path</span><span class="p">:</span> <span class="n">Path</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># YYYY-MM-DD</span>
    <span class="n">forcing_data_file_keys</span><span class="p">:</span> <span class="n">ERA5FileKeys</span> <span class="o">=</span> <span class="n">ERA5FileKeys</span><span class="p">()</span>
    <span class="n">SW_forcing</span><span class="p">:</span> <span class="n">DimensionalSWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantSWForcing</span><span class="p">()</span>
    <span class="n">LW_forcing</span><span class="p">:</span> <span class="n">DimensionalLWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantLWForcing</span><span class="p">()</span>
    <span class="n">turbulent_flux</span><span class="p">:</span> <span class="n">DimensionalTurbulentFlux</span> <span class="o">=</span> <span class="n">DimensionalConstantTurbulentFlux</span><span class="p">()</span>
    <span class="n">oil_heating</span><span class="p">:</span> <span class="n">DimensionalOilHeating</span> <span class="o">=</span> <span class="n">DimensionalBackgroundOilHeating</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalFixedHeatFluxOceanForcing" class="doc doc-heading">
            <code>DimensionalFixedHeatFluxOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Provides constant ocean heat flux at the bottom of the domain</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ocean_heat_flux</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constant heat flux at the bottom of the domain in W/m2</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalFixedHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant ocean heat flux at the bottom of the domain</span>

<span class="sd">    Args:</span>
<span class="sd">        ocean_heat_flux: The constant heat flux at the bottom of the domain in W/m2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ocean_heat_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalFixedTempOceanForcing" class="doc doc-heading">
            <code>DimensionalFixedTempOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Fixed temperature and gas saturation ocean boundary condition</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalFixedTempOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixed temperature and gas saturation ocean boundary condition&quot;&quot;&quot;</span>

    <span class="n">ocean_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalMonoBubbleParams" class="doc doc-heading">
            <code>DimensionalMonoBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="seaice3p.params.dimensional.bubble.DimensionalBaseBubbleParams">DimensionalBaseBubbleParams</span></code></p>







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalMonoBubbleParams</span><span class="p">(</span><span class="n">DimensionalBaseBubbleParams</span><span class="p">):</span>
    <span class="n">bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># bubble radius in m</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalMonoBubbleParams.bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalMonthlyHeatFluxOceanForcing" class="doc doc-heading">
            <code>DimensionalMonthlyHeatFluxOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Provides constant ocean heat flux at the bottom of the domain in each month</p>
<p>Proivde an average monthly ocean heat flux with the entries
i=0, 1, 2, 3, ...., 11
in the tuple corresponding to the months
January, February, March, April, ...., December</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>monthly_ocean_heat_flux</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of ocean heat flux values in each month in W/m2</p>
              </div>
            </td>
            <td>
                  <code>(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0)</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalMonthlyHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant ocean heat flux at the bottom of the domain in each month</span>

<span class="sd">    Proivde an average monthly ocean heat flux with the entries</span>
<span class="sd">    i=0, 1, 2, 3, ...., 11</span>
<span class="sd">    in the tuple corresponding to the months</span>
<span class="sd">    January, February, March, April, ...., December</span>

<span class="sd">    Args:</span>
<span class="sd">        monthly_ocean_heat_flux: Tuple of ocean heat flux values in each month in W/m2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">monthly_ocean_heat_flux</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalParams" class="doc doc-heading">
            <code>DimensionalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Contains all dimensional parameters needed to calculate non dimensional numbers.</p>
<p>To see the units each input should have look at the comment next to the default
value.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains all dimensional parameters needed to calculate non dimensional numbers.</span>

<span class="sd">    To see the units each input should have look at the comment next to the default</span>
<span class="sd">    value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_time_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">savefreq_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">lengthscale</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">gas_params</span><span class="p">:</span> <span class="n">DimensionalEQMGasParams</span> <span class="o">|</span> <span class="n">DimensionalDISEQGasParams</span>
    <span class="n">bubble_params</span><span class="p">:</span> <span class="n">DimensionalMonoBubbleParams</span> <span class="o">|</span> <span class="n">DimensionalPowerLawBubbleParams</span>
    <span class="n">brine_convection_params</span><span class="p">:</span> <span class="n">DimensionalRJW14Params</span> <span class="o">|</span> <span class="n">NoBrineConvection</span>
    <span class="n">forcing_config</span><span class="p">:</span> <span class="n">DimensionalRadForcing</span> <span class="o">|</span> <span class="n">DimensionalBRW09Forcing</span> <span class="o">|</span> <span class="n">DimensionalConstantForcing</span> <span class="o">|</span> <span class="n">DimensionalYearlyForcing</span> <span class="o">|</span> <span class="n">DimensionalRobinForcing</span> <span class="o">|</span> <span class="n">DimensionalERA5Forcing</span>
    <span class="n">ocean_forcing_config</span><span class="p">:</span> <span class="n">DimensionalBRW09OceanForcing</span> <span class="o">|</span> <span class="n">DimensionalFixedTempOceanForcing</span> <span class="o">|</span> <span class="n">DimensionalFixedHeatFluxOceanForcing</span> <span class="o">|</span> <span class="n">DimensionalMonthlyHeatFluxOceanForcing</span>
    <span class="n">initial_conditions_config</span><span class="p">:</span> <span class="n">DimensionalOilInitialConditions</span> <span class="o">|</span> <span class="n">UniformInitialConditions</span> <span class="o">|</span> <span class="n">BRW09InitialConditions</span> <span class="o">|</span> <span class="n">PreviousSimulation</span>

    <span class="n">water_params</span><span class="p">:</span> <span class="n">DimensionalWaterParams</span> <span class="o">=</span> <span class="n">DimensionalWaterParams</span><span class="p">()</span>
    <span class="n">numerical_params</span><span class="p">:</span> <span class="n">NumericalParams</span> <span class="o">=</span> <span class="n">NumericalParams</span><span class="p">()</span>
    <span class="n">frame_velocity_dimensional</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># velocity of frame in m/day</span>
    <span class="n">gravity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">9.81</span>  <span class="c1"># m/s2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">damkohler_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return damkohler number as ratio of thermal timescale to nucleation</span>
<span class="sd">        timescale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="p">,</span> <span class="n">DimensionalEQMGasParams</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">nucleation_timescale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the total time in non dimensional units for the simulation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_time_in_days</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">savefreq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the save frequency in non dimensional time&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">savefreq_in_days</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">frame_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the frame velocity in non dimensional units&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_velocity_dimensional</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">velocity_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">B</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the non dimensional scale for buoyant rise of gas bubbles as</span>

<span class="sd">        .. math:: \mathcal{B} = \frac{\rho_l g R_0^2 h}{3 \mu \kappa}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stokes_velocity</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">pore_radius</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_viscosity</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">velocity_scale_in_m_per_second</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">stokes_velocity</span> <span class="o">/</span> <span class="n">velocity_scale_in_m_per_second</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Rayleigh_salt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the haline Rayleigh number as</span>

<span class="sd">        .. math:: \text{Ra}_S = \frac{\rho_l g \beta \Delta S H K_0}{\kappa \mu}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">DimensionalRJW14Params</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">haline_contraction_coefficient</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">salinity_difference</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">reference_permeability</span>
                    <span class="o">/</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span>
                        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_viscosity</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">case</span> <span class="n">NoBrineConvection</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expansion_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate</span>

<span class="sd">        .. math:: \chi = \rho_l \xi_{\text{sat}} / \rho_g</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">saturation_concentration</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lewis_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the lewis number for dissolved gas, return np.inf if there is no</span>
<span class="sd">        dissolved gas diffusion.</span>

<span class="sd">        .. math:: \text{Le}_\xi = \kappa / D_\xi</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_diffusivity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_diffusivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">scales</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;return a Scales object used for converting between dimensional and non</span>
<span class="sd">        dimensional variables.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Scales</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ocean_salinity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">salinity_difference</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ice_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">saturation_concentration</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">pore_radius</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">haline_contraction_coefficient</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;save this object to a yaml file in the specified directory.</span>

<span class="sd">        The name will be the name given with _dimensional appended to distinguish it</span>
<span class="sd">        from a saved non-dimensional configuration.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dimensional.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;load this object from a yaml configuration file.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">yaml</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.B" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">B</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate the non dimensional scale for buoyant rise of gas bubbles as</p>
<p>.. math:: \mathcal{B} = \frac{\rho_l g R_0^2 h}{3 \mu \kappa}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.Rayleigh_salt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Rayleigh_salt</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the haline Rayleigh number as</p>
<p>.. math:: \text{Ra}_S = \frac{\rho_l g \beta \Delta S H K_0}{\kappa \mu}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.damkohler_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">damkohler_number</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return damkohler number as ratio of thermal timescale to nucleation
timescale</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.expansion_coefficient" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expansion_coefficient</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate</p>
<p>.. math:: \chi = \rho_l \xi_{\text{sat}} / \rho_g</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.frame_velocity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">frame_velocity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate the frame velocity in non dimensional units</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.lewis_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lewis_gas</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the lewis number for dissolved gas, return np.inf if there is no
dissolved gas diffusion.</p>
<p>.. math:: \text{Le}<em>\xi = \kappa / D</em>\xi</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.savefreq" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">savefreq</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate the save frequency in non dimensional time</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.scales" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scales</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>return a Scales object used for converting between dimensional and non
dimensional variables.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalParams.total_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_time</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate the total time in non dimensional units for the simulation</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="seaice3p.DimensionalParams.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>load this object from a yaml configuration file.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;load this object from a yaml configuration file.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">yaml</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.DimensionalParams.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>save this object to a yaml file in the specified directory.</p>
<p>The name will be the name given with _dimensional appended to distinguish it
from a saved non-dimensional configuration.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;save this object to a yaml file in the specified directory.</span>

<span class="sd">    The name will be the name given with _dimensional appended to distinguish it</span>
<span class="sd">    from a saved non-dimensional configuration.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dimensional.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalPowerLawBubbleParams" class="doc doc-heading">
            <code>DimensionalPowerLawBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="seaice3p.params.dimensional.bubble.DimensionalBaseBubbleParams">DimensionalBaseBubbleParams</span></code></p>







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalPowerLawBubbleParams</span><span class="p">(</span><span class="n">DimensionalBaseBubbleParams</span><span class="p">):</span>
    <span class="n">bubble_distribution_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">minimum_bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">maximum_bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">minimum_bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">maximum_bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">maximum_bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minimum_bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalRobinForcing" class="doc doc-heading">
            <code>DimensionalRobinForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>This forcing imposes a Robin boundary condition of the form
surface_heat_flux=heat_transfer_coefficient * (restoring_temp - surface_temp)</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalRobinForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This forcing imposes a Robin boundary condition of the form</span>
<span class="sd">    surface_heat_flux=heat_transfer_coefficient * (restoring_temp - surface_temp)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">heat_transfer_coefficient</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6.3</span>  <span class="c1"># W/m2K</span>
    <span class="n">restoring_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>  <span class="c1"># deg C</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.DimensionalWaterParams" class="doc doc-heading">
            <code>DimensionalWaterParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/water.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalWaterParams</span><span class="p">:</span>
    <span class="n">liquid_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1028</span>  <span class="c1"># kg/m3</span>
    <span class="n">ice_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">916</span>  <span class="c1"># kg/m3</span>
    <span class="n">ocean_salinity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">34</span>  <span class="c1"># g/kg</span>
    <span class="n">liquidus</span><span class="p">:</span> <span class="n">LinearLiquidus</span> <span class="o">|</span> <span class="n">CubicLiquidus</span> <span class="o">=</span> <span class="n">LinearLiquidus</span><span class="p">()</span>
    <span class="n">latent_heat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">334e3</span>  <span class="c1"># latent heat of fusion for ice in J/kg</span>
    <span class="n">liquid_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">4184</span>  <span class="c1"># J/kg degC</span>
    <span class="n">solid_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2009</span>  <span class="c1"># J/kg degC</span>
    <span class="n">liquid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.54</span>  <span class="c1"># water thermal conductivity in W/m deg C</span>
    <span class="n">solid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.22</span>  <span class="c1"># ice thermal conductivity in W/m deg C</span>
    <span class="n">snow_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.31</span>  <span class="c1"># snow thermal conductivity in W/m deg C</span>
    <span class="n">snow_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># snow density kg/m3</span>

    <span class="n">eddy_diffusivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">salt_diffusivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># molecular diffusivity of salt in water in m2/s</span>
    <span class="c1"># used to calculate Rayleigh number for convection and density contraction in liquid equation of state</span>
    <span class="n">haline_contraction_coefficient</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">7.5e-4</span>  <span class="c1"># 1/ppt</span>

    <span class="c1"># calculated from moreau et al 2014 value of kinematic viscosity for sewater 2.7e-6</span>
    <span class="c1"># dynamic liquid_viscosity = 2.7e-6 * liquid_density</span>
    <span class="n">liquid_viscosity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.78e-3</span>  <span class="c1"># dynamic liquid viscosity in Pa.s</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eutectic_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_salinity</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">get_liquidus_salinity</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_temperature</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eutectic_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_temperature</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">salinity_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate difference between eutectic salinity and typical ocean salinity</span>

<span class="sd">        .. math:: \Delta S = S_E - S_i</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ocean_freezing_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate salinity dependent freezing temperature using linear liquidus with</span>
<span class="sd">        ocean salinity</span>

<span class="sd">        .. math:: T_i = T_L(S_i) = T_E S_i / S_E</span>

<span class="sd">        or using a cubic fit for the liquidus curve</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_salinity</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">get_liquidus_temperature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">temperature_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate</span>

<span class="sd">        .. math:: \Delta T = T_i - T_E</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">concentration_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate concentration ratio as</span>

<span class="sd">        .. math:: \mathcal{C} = S_i / \Delta S</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">stefan_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate Stefan number</span>

<span class="sd">        .. math:: \text{St} = L / c_p \Delta T</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_heat</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">thermal_diffusivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return thermal diffusivity in m2/s</span>

<span class="sd">        .. math:: \kappa = \frac{k}{\rho_l c_p}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_density</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">conductivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of solid to liquid thermal conductivity</span>

<span class="sd">        .. math:: \lambda = \frac{k_s}{k_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_thermal_conductivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">specific_heat_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of solid to liquid specific heat capacities</span>

<span class="sd">        .. math:: \lambda = \frac{c_{p,s}}{c_{p,l}}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_specific_heat_capacity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eddy_diffusivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of eddy diffusivity to thermal diffusivity in</span>
<span class="sd">        the liquid phase</span>

<span class="sd">        .. math:: \lambda = \frac{\kappa_\text{turbulent}}{\kappa_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eddy_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_diffusivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">snow_conductivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of snow to liquid thermal conductivity</span>

<span class="sd">        .. math:: \lambda = \frac{k_{sn}}{k_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">snow_thermal_conductivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lewis_salt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the lewis number for salt, return np.inf if there is no salt</span>
<span class="sd">        diffusion.</span>

<span class="sd">        .. math:: \text{Le}_S = \kappa / D_s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">salt_diffusivity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salt_diffusivity</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.concentration_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">concentration_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate concentration ratio as</p>
<p>.. math:: \mathcal{C} = S_i / \Delta S</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.conductivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conductivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of solid to liquid thermal conductivity</p>
<p>.. math:: \lambda = \frac{k_s}{k_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.eddy_diffusivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eddy_diffusivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of eddy diffusivity to thermal diffusivity in
the liquid phase</p>
<p>.. math:: \lambda = \frac{\kappa_\text{turbulent}}{\kappa_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.lewis_salt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lewis_salt</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the lewis number for salt, return np.inf if there is no salt
diffusion.</p>
<p>.. math:: \text{Le}_S = \kappa / D_s</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.ocean_freezing_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ocean_freezing_temperature</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate salinity dependent freezing temperature using linear liquidus with
ocean salinity</p>
<p>.. math:: T_i = T_L(S_i) = T_E S_i / S_E</p>
<p>or using a cubic fit for the liquidus curve</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.salinity_difference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">salinity_difference</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate difference between eutectic salinity and typical ocean salinity</p>
<p>.. math:: \Delta S = S_E - S_i</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.snow_conductivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">snow_conductivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of snow to liquid thermal conductivity</p>
<p>.. math:: \lambda = \frac{k_{sn}}{k_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.specific_heat_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">specific_heat_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of solid to liquid specific heat capacities</p>
<p>.. math:: \lambda = \frac{c_{p,s}}{c_{p,l}}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.stefan_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stefan_number</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate Stefan number</p>
<p>.. math:: \text{St} = L / c_p \Delta T</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.temperature_difference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">temperature_difference</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>calculate</p>
<p>.. math:: \Delta T = T_i - T_E</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.DimensionalWaterParams.thermal_diffusivity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">thermal_diffusivity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>Return thermal diffusivity in m2/s</p>
<p>.. math:: \kappa = \frac{k}{\rho_l c_p}</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.EQMPhysicalParams" class="doc doc-heading">
            <code>EQMPhysicalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.params.physical.BasePhysicalParams" href="#seaice3p.params.physical.BasePhysicalParams">BasePhysicalParams</a></code></p>


        <p>non dimensional numbers for the mushy layer</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/physical.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EQMPhysicalParams</span><span class="p">(</span><span class="n">BasePhysicalParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;non dimensional numbers for the mushy layer&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.ERA5Forcing" class="doc doc-heading">
            <code>ERA5Forcing</code>


</h2>


    <div class="doc doc-contents ">


        <p>Forcing parameters for simulation forced with atmospheric variables
from reanalysis data in netCDF file located at data_path.</p>
<p>Never create this object directly but instead initialise from a dimensional
simulation configuration as we must pass it the simulation timescale to correctly
read the atmospheric variables from the netCDF file.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ERA5Forcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forcing parameters for simulation forced with atmospheric variables</span>
<span class="sd">    from reanalysis data in netCDF file located at data_path.</span>

<span class="sd">    Never create this object directly but instead initialise from a dimensional</span>
<span class="sd">    simulation configuration as we must pass it the simulation timescale to correctly</span>
<span class="sd">    read the atmospheric variables from the netCDF file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_path</span><span class="p">:</span> <span class="n">Path</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timescale_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">forcing_data_file_keys</span><span class="p">:</span> <span class="n">ERA5FileKeys</span> <span class="o">=</span> <span class="n">ERA5FileKeys</span><span class="p">()</span>
    <span class="n">snow_density</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">SW_forcing</span><span class="p">:</span> <span class="n">DimensionalSWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantSWForcing</span><span class="p">()</span>
    <span class="n">LW_forcing</span><span class="p">:</span> <span class="n">DimensionalLWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantLWForcing</span><span class="p">()</span>
    <span class="n">turbulent_flux</span><span class="p">:</span> <span class="n">DimensionalTurbulentFlux</span> <span class="o">=</span> <span class="n">DimensionalConstantTurbulentFlux</span><span class="p">()</span>
    <span class="n">oil_heating</span><span class="p">:</span> <span class="n">DimensionalOilHeating</span> <span class="o">=</span> <span class="n">DimensionalBackgroundOilHeating</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_path</span><span class="p">)</span>
        <span class="n">DATES</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">DIMLESS_TIMES</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">timescale_in_days</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">date</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">DATES</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># convert to deg C</span>
        <span class="n">T2M</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">temperature_at_2m_in_K</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="o">-</span> <span class="mf">273.15</span>
        <span class="p">)</span>
        <span class="n">D2M</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">dewpoint_at_2m_in_K</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="o">-</span> <span class="mf">273.15</span>
        <span class="p">)</span>

        <span class="n">LW</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">longwave_radiation_in_W_m2</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">SW</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">shortwave_radiation_in_W_m2</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="c1"># convert to KPa</span>
        <span class="n">ATM</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">surface_pressure_in_Pa</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="o">/</span> <span class="mf">1e3</span>
        <span class="p">)</span>

        <span class="n">wind_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">windspeed_at_2m_in_m_s</span>
        <span class="k">if</span> <span class="n">wind_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">WIND</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">windspeed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WIND</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wind_key</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="c1"># Calculate specific humidity in kg/kg from dewpoint temperature</span>
        <span class="n">SPEC_HUM</span> <span class="o">=</span> <span class="n">_calculate_specific_humidity</span><span class="p">(</span><span class="n">ATM</span><span class="p">,</span> <span class="n">D2M</span><span class="p">)</span>

        <span class="n">snow_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">snow_depth_in_m</span>
        <span class="c1"># if ERA5 standard short name for snow depth in m of water equivalent use snow</span>
        <span class="c1"># density to convert to m of snow</span>
        <span class="k">if</span> <span class="n">snow_key</span> <span class="o">==</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snow_density</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No snow density provided&quot;</span><span class="p">)</span>
            <span class="n">SNOW_DEPTH</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">snow_density</span><span class="p">)</span>

        <span class="c1"># If snow key is another name assume snow depth is just in m of snow</span>
        <span class="k">elif</span> <span class="n">snow_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">SNOW_DEPTH</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">snow_key</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="c1"># If snow key is None assume no snow</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">SNOW_DEPTH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">DIMLESS_TIMES</span><span class="p">)</span>

        <span class="c1"># Provide functions to interpolate forcing data at non-dimensional times</span>
        <span class="c1"># during simulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_2m_temp</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">T2M</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_LW</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">LW</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_SW</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">SW</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_ATM</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">ATM</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_spec_hum</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">SPEC_HUM</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_snow_depth</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">SNOW_DEPTH</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_windspeed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">WIND</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.FixedHeatFluxOceanForcing" class="doc doc-heading">
            <code>FixedHeatFluxOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Provides constant dimensionless ocean heat flux at the bottom of the domain and fixed gas
saturation state.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FixedHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant dimensionless ocean heat flux at the bottom of the domain and fixed gas</span>
<span class="sd">    saturation state.&quot;&quot;&quot;</span>

    <span class="n">ocean_heat_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ocean_gas_sat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.FixedTempOceanForcing" class="doc doc-heading">
            <code>FixedTempOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Fixed temperature and gas saturation ocean boundary condition</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FixedTempOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixed temperature and gas saturation ocean boundary condition&quot;&quot;&quot;</span>

    <span class="n">ocean_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">ocean_gas_sat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.MonoBubbleParams" class="doc doc-heading">
            <code>MonoBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.params.bubble.BaseBubbleParams" href="#seaice3p.params.bubble.BaseBubbleParams">BaseBubbleParams</a></code></p>


        <p>Parameters for population of identical spherical bubbles.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MonoBubbleParams</span><span class="p">(</span><span class="n">BaseBubbleParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for population of identical spherical bubbles.&quot;&quot;&quot;</span>

    <span class="n">bubble_radius_scaled</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.MonthlyHeatFluxOceanForcing" class="doc doc-heading">
            <code>MonthlyHeatFluxOceanForcing</code>


</h2>


    <div class="doc doc-contents ">


        <p>Provides constant dimensionless ocean heat flux at the bottom of the domain in
each month</p>
<p>and ocean gas saturation state.</p>
<p>Proivde an average monthly ocean heat flux with the entries
i=0, 1, 2, 3, ...., 11
in the tuple corresponding to the months
January, February, March, April, ...., December</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>monthly_ocean_heat_flux</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of dimensionless ocean heat flux values in</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MonthlyHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant dimensionless ocean heat flux at the bottom of the domain in</span>
<span class="sd">    each month</span>

<span class="sd">    and ocean gas saturation state.</span>

<span class="sd">    Proivde an average monthly ocean heat flux with the entries</span>
<span class="sd">    i=0, 1, 2, 3, ...., 11</span>
<span class="sd">    in the tuple corresponding to the months</span>
<span class="sd">    January, February, March, April, ...., December</span>

<span class="sd">    Args:</span>
<span class="sd">        monthly_ocean_heat_flux: Tuple of dimensionless ocean heat flux values in</span>
<span class="sd">        each month</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timescale_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">monthly_ocean_heat_flux</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ocean_gas_sat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Provide functions to interpolate day of year to monthly ocean heat flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolate_heat_flux</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span>
            <span class="n">xp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">258</span><span class="p">,</span> <span class="mi">288</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">349</span><span class="p">]),</span>
            <span class="n">fp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monthly_ocean_heat_flux</span><span class="p">),</span>
            <span class="n">period</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ocean_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simulation_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">start_datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">current_datetime</span> <span class="o">=</span> <span class="n">start_datetime</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span>
            <span class="n">days</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timescale_in_days</span> <span class="o">*</span> <span class="n">simulation_time</span>
        <span class="p">)</span>
        <span class="n">current_day</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">current_datetime</span> <span class="o">-</span> <span class="n">datetime</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">86400</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolate_heat_flux</span><span class="p">(</span><span class="n">current_day</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.NoBrineConvection" class="doc doc-heading">
            <code>NoBrineConvection</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>No brine convection</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/convection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoBrineConvection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;No brine convection&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.NumericalParams" class="doc doc-heading">
            <code>NumericalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>parameters needed for discretisation and choice of numerical method</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/numerical.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NumericalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;parameters needed for discretisation and choice of numerical method&quot;&quot;&quot;</span>

    <span class="n">I</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">regularisation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">solver_choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;RK23&quot;</span>  <span class="c1"># scipy.integrate.solve_IVP solver choice</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">I</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.OilInitialConditions" class="doc doc-heading">
            <code>OilInitialConditions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>values for bottom (ocean) boundary</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/initial_conditions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OilInitialConditions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;values for bottom (ocean) boundary&quot;&quot;&quot;</span>

    <span class="c1"># Non dimensional parameters for summer initial conditions</span>
    <span class="n">initial_ice_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">initial_ocean_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.05</span>
    <span class="n">initial_ice_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
    <span class="n">initial_oil_volume_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span>
    <span class="n">initial_ice_bulk_salinity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
    <span class="n">initial_oil_free_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.PowerLawBubbleParams" class="doc doc-heading">
            <code>PowerLawBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.params.bubble.BaseBubbleParams" href="#seaice3p.params.bubble.BaseBubbleParams">BaseBubbleParams</a></code></p>


        <p>Parameters for population of bubbles following a power law size distribution
between a minimum and maximum radius.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PowerLawBubbleParams</span><span class="p">(</span><span class="n">BaseBubbleParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for population of bubbles following a power law size distribution</span>
<span class="sd">    between a minimum and maximum radius.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bubble_distribution_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">minimum_bubble_radius_scaled</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
    <span class="n">maximum_bubble_radius_scaled</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.RJW14Params" class="doc doc-heading">
            <code>RJW14Params</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Parameters for the RJW14 parameterisation of brine convection</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/convection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RJW14Params</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for the RJW14 parameterisation of brine convection&quot;&quot;&quot;</span>

    <span class="n">Rayleigh_salt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">44105</span>
    <span class="n">Rayleigh_critical</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.9</span>
    <span class="n">convection_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.13</span>
    <span class="n">couple_bubble_to_horizontal_flow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">couple_bubble_to_vertical_flow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">advective_heat_flux_in_ocean</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.RadForcing" class="doc doc-heading">
            <code>RadForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Forcing parameters for radiative transfer simulation with oil drops</p>
<p>we have not implemented the non-dimensionalisation for these parameters yet
and so we just pass the dimensional values directly to the simulation</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RadForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forcing parameters for radiative transfer simulation with oil drops</span>

<span class="sd">    we have not implemented the non-dimensionalisation for these parameters yet</span>
<span class="sd">    and so we just pass the dimensional values directly to the simulation&quot;&quot;&quot;</span>

    <span class="n">SW_forcing</span><span class="p">:</span> <span class="n">DimensionalSWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantSWForcing</span><span class="p">()</span>
    <span class="n">LW_forcing</span><span class="p">:</span> <span class="n">DimensionalLWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantLWForcing</span><span class="p">()</span>
    <span class="n">turbulent_flux</span><span class="p">:</span> <span class="n">DimensionalTurbulentFlux</span> <span class="o">=</span> <span class="n">DimensionalConstantTurbulentFlux</span><span class="p">()</span>
    <span class="n">oil_heating</span><span class="p">:</span> <span class="n">DimensionalOilHeating</span> <span class="o">=</span> <span class="n">DimensionalBackgroundOilHeating</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.RobinForcing" class="doc doc-heading">
            <code>RobinForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Dimensionless forcing parameters for Robin boundary condition</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RobinForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimensionless forcing parameters for Robin boundary condition&quot;&quot;&quot;</span>

    <span class="n">biot</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">restoring_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.3</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.Scales" class="doc doc-heading">
            <code>Scales</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Scales</span><span class="p">:</span>
    <span class="n">lengthscale</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># domain height in m</span>
    <span class="n">thermal_diffusivity</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># m2/s</span>
    <span class="n">liquid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># W/m deg C</span>
    <span class="n">ocean_salinity</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># g/kg</span>
    <span class="n">salinity_difference</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># g/kg</span>
    <span class="n">ocean_freezing_temperature</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># deg C</span>
    <span class="n">temperature_difference</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># deg C</span>
    <span class="n">gas_density</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># kg/m3</span>
    <span class="n">liquid_density</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># kg/m3</span>
    <span class="n">ice_density</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># kg/m3</span>
    <span class="n">saturation_concentration</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># kg(gas)/kg(liquid)</span>
    <span class="n">pore_radius</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># m</span>
    <span class="n">haline_contraction_coefficient</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># 1/ppt</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">time_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;in days&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">SECONDS_TO_DAYS</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_diffusivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">velocity_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;in m /day&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_temperature</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise temperature in deg C&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;get temperature in deg C from non dimensional temperature&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_grid</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise domain depths in meters&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dimensional_grid</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get domain depths in meters from non dimensional values&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span> <span class="o">*</span> <span class="n">grid</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise time in days&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dimensional_time</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert non dimensional time into time in days since start of simulation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span> <span class="o">*</span> <span class="n">time</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_bulk_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_salinity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise bulk salinity in g/kg&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_bulk_salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_bulk_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_salinity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert non dimensional bulk salinity to g/kg&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span> <span class="o">*</span> <span class="n">bulk_salinity</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise bulk gas content in kg/m3&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dimensional_bulk_gas</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert dimensionless bulk gas content to kg/m3&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span> <span class="o">*</span> <span class="n">bulk_gas</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_dimensional_bulk_air_to_argon_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert kg/m3 of air to micromole of Argon per Liter of ice&quot;&quot;&quot;</span>
        <span class="n">mass_ratio_of_argon_in_air</span> <span class="o">=</span> <span class="mf">0.01288</span>
        <span class="n">micromoles_of_argon_in_a_kilogram_of_argon</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.9948e-8</span><span class="p">)</span>
        <span class="n">liters_in_a_meter_cubed</span> <span class="o">=</span> <span class="mf">1e3</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_bulk_gas</span>
            <span class="o">*</span> <span class="n">mass_ratio_of_argon_in_air</span>
            <span class="o">*</span> <span class="n">micromoles_of_argon_in_a_kilogram_of_argon</span>
            <span class="o">/</span> <span class="n">liters_in_a_meter_cubed</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_dissolved_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from dissolved gas in kg(gas)/kg(liquid) to dimensionless&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dimensional_dissolved_gas</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dissolved_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from non dimensional dissolved gas to dimensional dissolved gas in</span>
<span class="sd">        kg(gas)/kg(liquid)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span> <span class="o">*</span> <span class="n">dissolved_gas</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_heating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_heating</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from heating rate in W/m3 to dimensionless units&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_heating</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_heat_flux</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from heat flux in W/m2 to dimensionless units&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_heat_flux</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
            <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heat_flux</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from dimensionless heat flux to heat flux in W/m2&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">heat_flux</span>
            <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.Scales.time_scale" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">time_scale</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>in days</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="seaice3p.Scales.velocity_scale" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">velocity_scale</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">

        <p>in m /day</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_dimensional_bulk_air_to_argon_content" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_dimensional_bulk_air_to_argon_content</span><span class="p">(</span><span class="n">dimensional_bulk_gas</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert kg/m3 of air to micromole of Argon per Liter of ice</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_dimensional_bulk_air_to_argon_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert kg/m3 of air to micromole of Argon per Liter of ice&quot;&quot;&quot;</span>
    <span class="n">mass_ratio_of_argon_in_air</span> <span class="o">=</span> <span class="mf">0.01288</span>
    <span class="n">micromoles_of_argon_in_a_kilogram_of_argon</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.9948e-8</span><span class="p">)</span>
    <span class="n">liters_in_a_meter_cubed</span> <span class="o">=</span> <span class="mf">1e3</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_bulk_gas</span>
        <span class="o">*</span> <span class="n">mass_ratio_of_argon_in_air</span>
        <span class="o">*</span> <span class="n">micromoles_of_argon_in_a_kilogram_of_argon</span>
        <span class="o">/</span> <span class="n">liters_in_a_meter_cubed</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_from_dimensional_bulk_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_bulk_gas</span><span class="p">(</span><span class="n">dimensional_bulk_gas</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Non dimensionalise bulk gas content in kg/m3</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise bulk gas content in kg/m3&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dimensional_bulk_gas</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_from_dimensional_bulk_salinity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_bulk_salinity</span><span class="p">(</span><span class="n">dimensional_bulk_salinity</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Non dimensionalise bulk salinity in g/kg</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_bulk_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_salinity</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise bulk salinity in g/kg&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_bulk_salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>
    <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_from_dimensional_dissolved_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_dissolved_gas</span><span class="p">(</span><span class="n">dimensional_dissolved_gas</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>convert from dissolved gas in kg(gas)/kg(liquid) to dimensionless</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_dissolved_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from dissolved gas in kg(gas)/kg(liquid) to dimensionless&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dimensional_dissolved_gas</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_from_dimensional_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_grid</span><span class="p">(</span><span class="n">dimensional_grid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Non dimensionalise domain depths in meters</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_grid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise domain depths in meters&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dimensional_grid</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_from_dimensional_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_heat_flux</span><span class="p">(</span><span class="n">dimensional_heat_flux</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>convert from heat flux in W/m2 to dimensionless units</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_heat_flux</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from heat flux in W/m2 to dimensionless units&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_heat_flux</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
        <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_from_dimensional_heating" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_heating</span><span class="p">(</span><span class="n">dimensional_heating</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>convert from heating rate in W/m3 to dimensionless units</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_heating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_heating</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from heating rate in W/m3 to dimensionless units&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_heating</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_from_dimensional_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_temperature</span><span class="p">(</span><span class="n">dimensional_temperature</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Non dimensionalise temperature in deg C</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_temperature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise temperature in deg C&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span>
    <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_from_dimensional_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_time</span><span class="p">(</span><span class="n">dimensional_time</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Non dimensionalise time in days</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise time in days&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dimensional_time</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_to_dimensional_bulk_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_bulk_gas</span><span class="p">(</span><span class="n">bulk_gas</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert dimensionless bulk gas content to kg/m3</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert dimensionless bulk gas content to kg/m3&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span> <span class="o">*</span> <span class="n">bulk_gas</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_to_dimensional_bulk_salinity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_bulk_salinity</span><span class="p">(</span><span class="n">bulk_salinity</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert non dimensional bulk salinity to g/kg</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_bulk_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_salinity</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert non dimensional bulk salinity to g/kg&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span> <span class="o">*</span> <span class="n">bulk_salinity</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_to_dimensional_dissolved_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_dissolved_gas</span><span class="p">(</span><span class="n">dissolved_gas</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>convert from non dimensional dissolved gas to dimensional dissolved gas in
kg(gas)/kg(liquid)</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dissolved_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from non dimensional dissolved gas to dimensional dissolved gas in</span>
<span class="sd">    kg(gas)/kg(liquid)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span> <span class="o">*</span> <span class="n">dissolved_gas</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_to_dimensional_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Get domain depths in meters from non dimensional values</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get domain depths in meters from non dimensional values&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span> <span class="o">*</span> <span class="n">grid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_to_dimensional_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_heat_flux</span><span class="p">(</span><span class="n">heat_flux</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>convert from dimensionless heat flux to heat flux in W/m2</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heat_flux</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from dimensionless heat flux to heat flux in W/m2&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">heat_flux</span>
        <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
        <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_to_dimensional_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_temperature</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>get temperature in deg C from non dimensional temperature</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;get temperature in deg C from non dimensional temperature&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.Scales.convert_to_dimensional_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert non dimensional time into time in days since start of simulation</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert non dimensional time into time in days since start of simulation&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span> <span class="o">*</span> <span class="n">time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.UniformInitialConditions" class="doc doc-heading">
            <code>UniformInitialConditions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>values for bottom (ocean) boundary</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/initial_conditions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UniformInitialConditions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;values for bottom (ocean) boundary&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="seaice3p.YearlyForcing" class="doc doc-heading">
            <code>YearlyForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


    <div class="doc doc-contents ">


        <p>Yearly sinusoidal temperature forcing</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">YearlyForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Yearly sinusoidal temperature forcing&quot;&quot;&quot;</span>

    <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.75</span>
    <span class="n">period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h2 id="seaice3p.get_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_config</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Return a Config object for the simulation.</p>
<p>physical parameters and Darcy law parameters are calculated from the dimensional
input. You can modify the numerical parameters and boundary conditions and
forcing provided for the simulation.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/params.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">:</span> <span class="n">DimensionalParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a Config object for the simulation.</span>

<span class="sd">    physical parameters and Darcy law parameters are calculated from the dimensional</span>
<span class="sd">    input. You can modify the numerical parameters and boundary conditions and</span>
<span class="sd">    forcing provided for the simulation.&quot;&quot;&quot;</span>
    <span class="n">physical_params</span> <span class="o">=</span> <span class="n">get_dimensionless_physical_params</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span>
    <span class="n">initial_conditions_config</span> <span class="o">=</span> <span class="n">get_dimensionless_initial_conditions_config</span><span class="p">(</span>
        <span class="n">dimensional_params</span>
    <span class="p">)</span>
    <span class="n">brine_convection_params</span> <span class="o">=</span> <span class="n">get_dimensionless_brine_convection_params</span><span class="p">(</span>
        <span class="n">dimensional_params</span>
    <span class="p">)</span>
    <span class="n">bubble_params</span> <span class="o">=</span> <span class="n">get_dimensionless_bubble_params</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span>
    <span class="n">forcing_config</span> <span class="o">=</span> <span class="n">get_dimensionless_forcing_config</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span>
    <span class="n">ocean_forcing_config</span> <span class="o">=</span> <span class="n">get_dimensionless_ocean_forcing_config</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Config</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">physical_params</span><span class="o">=</span><span class="n">physical_params</span><span class="p">,</span>
        <span class="n">initial_conditions_config</span><span class="o">=</span><span class="n">initial_conditions_config</span><span class="p">,</span>
        <span class="n">brine_convection_params</span><span class="o">=</span><span class="n">brine_convection_params</span><span class="p">,</span>
        <span class="n">bubble_params</span><span class="o">=</span><span class="n">bubble_params</span><span class="p">,</span>
        <span class="n">forcing_config</span><span class="o">=</span><span class="n">forcing_config</span><span class="p">,</span>
        <span class="n">ocean_forcing_config</span><span class="o">=</span><span class="n">ocean_forcing_config</span><span class="p">,</span>
        <span class="n">numerical_params</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">numerical_params</span><span class="p">,</span>
        <span class="n">scales</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">scales</span><span class="p">,</span>
        <span class="n">total_time</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">total_time</span><span class="p">,</span>
        <span class="n">savefreq</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">savefreq</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>


<div class="doc doc-object doc-module">



<h2 id="seaice3p.enthalpy_method" class="doc doc-heading">
            <code>enthalpy_method</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="seaice3p.enthalpy_method.enthalpy_method" class="doc doc-heading">
            <code>enthalpy_method</code>


</h3>

    <div class="doc doc-contents ">

        <p>Module containing enthalpy method to calculate state variables from bulk enthalpy,
bulk salinity and bulk gas.</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.enthalpy_method.phase_boundaries" class="doc doc-heading">
            <code>phase_boundaries</code>


</h3>

    <div class="doc doc-contents ">

        <p>Module for calculating the phase boundaries needed for the enthalpy method.</p>
<p>calculates the phase boundaries neglecting the gas fraction so that</p>
<pre><code>.. math:: \phi_s + \phi_l = 1
</code></pre>








  <div class="doc doc-children">











  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.equations" class="doc doc-heading">
            <code>equations</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="seaice3p.equations.RJW14" class="doc doc-heading">
            <code>RJW14</code>


</h3>

    <div class="doc doc-contents ">

        <p>Module to calculate the sink terms for conservation equations when using the
Rees Jones and Worster 2014 brine drainage parameterisation.</p>
<p>These terms represent loss through the brine channels and need to be added in the
convecting region when using this parameterisation</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.RJW14.brine_channel_sink_terms" class="doc doc-heading">
            <code>brine_channel_sink_terms</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_channel_sink_terms._DISEQ_brine_convection_sink" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_DISEQ_brine_convection_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>TODO: check the sink terms for bulk_dissolved_gas and gas fraction</p>
<p>For now neglect the coupling of bubbles to the horizontal or vertical flow</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_channel_sink_terms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_DISEQ_brine_convection_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">:</span> <span class="n">DISEQStateBCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TODO: check the sink terms for bulk_dissolved_gas and gas fraction</span>

<span class="sd">    For now neglect the coupling of bubbles to the horizontal or vertical flow</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">heat_sink</span> <span class="o">=</span> <span class="n">_calculate_heat_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span>
    <span class="n">salt_sink</span> <span class="o">=</span> <span class="n">_calculate_salt_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span>
    <span class="n">bulk_dissolved_gas_sink</span> <span class="o">=</span> <span class="n">_calculate_bulk_dissolved_gas_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span>
    <span class="n">gas_fraction_sink</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">heat_sink</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">heat_sink</span><span class="p">,</span> <span class="n">salt_sink</span><span class="p">,</span> <span class="n">bulk_dissolved_gas_sink</span><span class="p">,</span> <span class="n">gas_fraction_sink</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_channel_sink_terms._EQM_brine_convection_sink" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_EQM_brine_convection_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>TODO: check the sink terms for bulk_dissolved_gas and gas fraction</p>
<p>For now neglect the coupling of bubbles to the horizontal or vertical flow</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_channel_sink_terms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_EQM_brine_convection_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">:</span> <span class="n">EQMStateBCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TODO: check the sink terms for bulk_dissolved_gas and gas fraction</span>

<span class="sd">    For now neglect the coupling of bubbles to the horizontal or vertical flow</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">heat_sink</span> <span class="o">=</span> <span class="n">_calculate_heat_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span>
    <span class="n">salt_sink</span> <span class="o">=</span> <span class="n">_calculate_salt_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span>
    <span class="n">gas_sink</span> <span class="o">=</span> <span class="n">_calculate_gas_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">heat_sink</span><span class="p">,</span> <span class="n">salt_sink</span><span class="p">,</span> <span class="n">gas_sink</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_channel_sink_terms._calculate_bulk_dissolved_gas_sink" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_bulk_dissolved_gas_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>This is for the DISEQ model</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_channel_sink_terms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_bulk_dissolved_gas_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">grids</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is for the DISEQ model&quot;&quot;&quot;</span>
    <span class="n">liquid_fraction</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">liquid_salinity</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_salinity</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dissolved_gas</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">dissolved_gas</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">center_grid</span> <span class="o">=</span> <span class="n">grids</span><span class="o">.</span><span class="n">centers</span>
    <span class="n">edge_grid</span> <span class="o">=</span> <span class="n">grids</span><span class="o">.</span><span class="n">edges</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="p">,</span> <span class="n">NoBrineConvection</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">)</span>

    <span class="n">sink</span> <span class="o">=</span> <span class="n">calculate_brine_channel_sink</span><span class="p">(</span>
        <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">sink</span> <span class="o">*</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">expansion_coefficient</span> <span class="o">*</span> <span class="n">dissolved_gas</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_channel_sink_terms._calculate_gas_sink" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_gas_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>This is for the EQM model</p>
<p>TODO: fix bug in bubble coupling to flow</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_channel_sink_terms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_gas_sink</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">grids</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This is for the EQM model</span>

<span class="sd">    TODO: fix bug in bubble coupling to flow</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">liquid_fraction</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">liquid_salinity</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_salinity</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">dissolved_gas</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">dissolved_gas</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">gas_fraction</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">center_grid</span> <span class="o">=</span> <span class="n">grids</span><span class="o">.</span><span class="n">centers</span>
    <span class="n">edge_grid</span> <span class="o">=</span> <span class="n">grids</span><span class="o">.</span><span class="n">edges</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="p">,</span> <span class="n">NoBrineConvection</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">)</span>

    <span class="n">sink</span> <span class="o">=</span> <span class="n">calculate_brine_channel_sink</span><span class="p">(</span>
        <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>

    <span class="n">dissolved_gas_term</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">expansion_coefficient</span> <span class="o">*</span> <span class="n">dissolved_gas</span>

    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">couple_bubble_to_horizontal_flow</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="p">,</span> <span class="n">MonoBubbleParams</span><span class="p">):</span>
            <span class="n">lag_factor</span> <span class="o">=</span> <span class="n">calculate_mono_lag_factor</span><span class="p">(</span><span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="p">,</span> <span class="n">PowerLawBubbleParams</span><span class="p">):</span>
            <span class="n">lag_factor</span> <span class="o">=</span> <span class="n">calculate_power_law_lag_factor</span><span class="p">(</span><span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

        <span class="n">bubble_term</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">gas_fraction</span> <span class="o">*</span> <span class="n">geometric</span><span class="p">(</span><span class="n">lag_factor</span><span class="p">)</span> <span class="o">/</span> <span class="n">liquid_fraction</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">bubble_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sink</span> <span class="o">*</span> <span class="p">(</span><span class="n">dissolved_gas_term</span> <span class="o">+</span> <span class="n">bubble_term</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.RJW14.brine_drainage" class="doc doc-heading">
            <code>brine_drainage</code>


</h4>

    <div class="doc doc-contents ">

        <p>Module to calculate the Rees Jones and Worster 2014
parameterisation for brine convection velocity and the strenght of the sink term.</p>
<p>Exports the functions:</p>
<p>calculate_brine_convection_liquid_velocity
To be used in velocities module when using brine convection parameterisation.</p>
<p>calculate_brine_channel_sink
To be used to add sink terms to conservation equations when using brine convection
parameterisation.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_drainage.calculate_Rayleigh" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_Rayleigh</span><span class="p">(</span><span class="n">cell_centers</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the local Rayleigh number for brine convection as</p>
<p>.. math:: \text{Ra}(z) = \text{Ra}_S K(z) (z+h) \Theta_l</p>
<p>:param cell_centers: The vertical coordinates of cell centers.
:type cell_centers: Numpy Array shape (I,)
:param edge_grid: The vertical coordinate positions of the edge grid.
:type edge_grid: Numpy Array (size I+1)
:param liquid_salinity: liquid salinity on center grid
:type liquid_salinity: Numpy Array shape (I,)
:param liquid_fraction: liquid fraction on center grid
:type liquid_fraction: Numpy Array (size I)
:param cfg: Configuration object for the simulation.
:type cfg: seaice3p.params.Config
:return: Array of shape (I,) of Rayleigh number at cell centers</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_drainage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_Rayleigh</span><span class="p">(</span>
    <span class="n">cell_centers</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the local Rayleigh number for brine convection as</span>

<span class="sd">    .. math:: \text{Ra}(z) = \text{Ra}_S K(z) (z+h) \Theta_l</span>

<span class="sd">    :param cell_centers: The vertical coordinates of cell centers.</span>
<span class="sd">    :type cell_centers: Numpy Array shape (I,)</span>
<span class="sd">    :param edge_grid: The vertical coordinate positions of the edge grid.</span>
<span class="sd">    :type edge_grid: Numpy Array (size I+1)</span>
<span class="sd">    :param liquid_salinity: liquid salinity on center grid</span>
<span class="sd">    :type liquid_salinity: Numpy Array shape (I,)</span>
<span class="sd">    :param liquid_fraction: liquid fraction on center grid</span>
<span class="sd">    :type liquid_fraction: Numpy Array (size I)</span>
<span class="sd">    :param cfg: Configuration object for the simulation.</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: Array of shape (I,) of Rayleigh number at cell centers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Rayleigh_salt</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">Rayleigh_salt</span>
    <span class="n">ice_depth</span> <span class="o">=</span> <span class="n">calculate_ice_ocean_boundary_depth</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">)</span>
    <span class="n">averaged_permeabilities</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">calculate_integrated_mean_permeability</span><span class="p">(</span>
                <span class="n">z</span><span class="o">=</span><span class="n">z</span><span class="p">,</span>
                <span class="n">liquid_fraction</span><span class="o">=</span><span class="n">liquid_fraction</span><span class="p">,</span>
                <span class="n">ice_depth</span><span class="o">=</span><span class="n">ice_depth</span><span class="p">,</span>
                <span class="n">cell_centers</span><span class="o">=</span><span class="n">cell_centers</span><span class="p">,</span>
                <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">cell_centers</span>
        <span class="p">]</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">Rayleigh_salt</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">ice_depth</span> <span class="o">+</span> <span class="n">cell_centers</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">averaged_permeabilities</span>
        <span class="o">*</span> <span class="n">liquid_salinity</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_drainage.calculate_brine_channel_sink" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_brine_channel_sink</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the sink term due to brine channels.</p>
<p>.. math:: \text{sink} = \mathcal{A}</p>
<p>in the convecting region. Zero elsewhere.</p>
<p>NOTE: If no ice is present or if no convecting region exists returns zero</p>
<p>:param liquid_fraction: liquid fraction on center grid
:type liquid_fraction: Numpy Array of shape (I,)
:param liquid_salinity: liquid salinity on center grid
:type liquid_salinity: Numpy Array of shape (I,)
:param center_grid: vertical coordinate of center grid
:type center_grid: Numpy Array of shape (I,)
:param edge_grid: Vertical coordinates of cell edges
:type edge_grid: Numpy Array of shape (I+1,)
:param cfg: Configuration object for the simulation.
:type cfg: seaice3p.params.Config
:return: Strength of the sink term due to brine channels on the center grid.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_drainage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_brine_channel_sink</span><span class="p">(</span>
    <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the sink term due to brine channels.</span>

<span class="sd">    .. math:: \text{sink} = \mathcal{A}</span>

<span class="sd">    in the convecting region. Zero elsewhere.</span>

<span class="sd">    NOTE: If no ice is present or if no convecting region exists returns zero</span>

<span class="sd">    :param liquid_fraction: liquid fraction on center grid</span>
<span class="sd">    :type liquid_fraction: Numpy Array of shape (I,)</span>
<span class="sd">    :param liquid_salinity: liquid salinity on center grid</span>
<span class="sd">    :type liquid_salinity: Numpy Array of shape (I,)</span>
<span class="sd">    :param center_grid: vertical coordinate of center grid</span>
<span class="sd">    :type center_grid: Numpy Array of shape (I,)</span>
<span class="sd">    :param edge_grid: Vertical coordinates of cell edges</span>
<span class="sd">    :type edge_grid: Numpy Array of shape (I+1,)</span>
<span class="sd">    :param cfg: Configuration object for the simulation.</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: Strength of the sink term due to brine channels on the center grid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ice_depth</span> <span class="o">=</span> <span class="n">calculate_ice_ocean_boundary_depth</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">)</span>
    <span class="n">Rayleigh_number</span> <span class="o">=</span> <span class="n">calculate_Rayleigh</span><span class="p">(</span>
        <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="n">convecting_region_height</span> <span class="o">=</span> <span class="n">get_convecting_region_height</span><span class="p">(</span>
        <span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="n">brine_channel_strength</span> <span class="o">=</span> <span class="n">calculate_brine_channel_strength</span><span class="p">(</span>
        <span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">ice_depth</span><span class="p">,</span> <span class="n">convecting_region_height</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>

    <span class="n">sink</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">center_grid</span><span class="p">)</span>

    <span class="c1"># No ice present</span>
    <span class="k">if</span> <span class="n">ice_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">sink</span>

    <span class="c1"># ice present but no convection occuring</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">convecting_region_height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sink</span>

    <span class="c1"># Make liquid vertical velocity continuous at bottom of the ice</span>

    <span class="n">is_convecting_ice</span> <span class="o">=</span> <span class="p">(</span><span class="n">center_grid</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">ice_depth</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
        <span class="n">center_grid</span> <span class="o">&lt;=</span> <span class="n">convecting_region_height</span>
    <span class="p">)</span>
    <span class="n">is_liquid</span> <span class="o">=</span> <span class="n">center_grid</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">ice_depth</span>

    <span class="n">sink</span><span class="p">[</span><span class="n">is_convecting_ice</span><span class="p">]</span> <span class="o">=</span> <span class="n">brine_channel_strength</span>
    <span class="n">sink</span><span class="p">[</span><span class="n">is_liquid</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">sink</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_drainage.calculate_brine_channel_strength" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_brine_channel_strength</span><span class="p">(</span><span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">ice_depth</span><span class="p">,</span> <span class="n">convecting_region_height</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the brine channel strength in the convecting region as</p>
<p>.. math:: \mathcal{A} = \frac{\alpha \text{Ra}_e}{(h+z_c)^2}</p>
<p>the effective Rayleigh number multiplied by a tuning parameter (Rees Jones and
Worster 2014) over the convecting region thickness squared.</p>
<p>:param Rayleigh_number: local Rayleigh number on center grid
:type Rayleigh_number: Numpy Array of shape (I,)
:param ice_depth: depth of ice (positive)
:type ice_depth: float
:param convecting_region_height: position of the convecting region boundary (negative)
:type convecting_region_height: float
:param cfg: Configuration object for the simulation.
:type cfg: seaice3p.params.Config
:return: Brine channel strength parameter</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_drainage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_brine_channel_strength</span><span class="p">(</span>
    <span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">ice_depth</span><span class="p">,</span> <span class="n">convecting_region_height</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the brine channel strength in the convecting region as</span>

<span class="sd">    .. math:: \mathcal{A} = \frac{\alpha \text{Ra}_e}{(h+z_c)^2}</span>

<span class="sd">    the effective Rayleigh number multiplied by a tuning parameter (Rees Jones and</span>
<span class="sd">    Worster 2014) over the convecting region thickness squared.</span>

<span class="sd">    :param Rayleigh_number: local Rayleigh number on center grid</span>
<span class="sd">    :type Rayleigh_number: Numpy Array of shape (I,)</span>
<span class="sd">    :param ice_depth: depth of ice (positive)</span>
<span class="sd">    :type ice_depth: float</span>
<span class="sd">    :param convecting_region_height: position of the convecting region boundary (negative)</span>
<span class="sd">    :type convecting_region_height: float</span>
<span class="sd">    :param cfg: Configuration object for the simulation.</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: Brine channel strength parameter</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">convection_strength</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">convection_strength</span>
    <span class="k">if</span> <span class="n">ice_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">convecting_region_height</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="n">convecting_layer_thickness</span> <span class="o">=</span> <span class="n">ice_depth</span> <span class="o">+</span> <span class="n">convecting_region_height</span>
    <span class="n">effective_Rayleigh</span> <span class="o">=</span> <span class="n">get_effective_Rayleigh_number</span><span class="p">(</span><span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">convection_strength</span> <span class="o">*</span> <span class="n">effective_Rayleigh</span> <span class="o">/</span> <span class="n">convecting_layer_thickness</span><span class="o">**</span><span class="mi">2</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_drainage.calculate_brine_convection_liquid_velocity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_brine_convection_liquid_velocity</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the vertical liquid Darcy velocity from Rees Jones and Worster 2014</p>
<p>.. math:: W_l = \mathcal{A} (z_c - z)</p>
<p>in the convecting region. The velocity is stagnant above the convecting region.
The velocity is constant in the liquid region and continuous at the interface.</p>
<p>NOTE: If no ice is present or if no convecting region exists returns zero velocity</p>
<p>:param liquid_fraction: liquid fraction on center grid
:type liquid_fraction: Numpy Array of shape (I,)
:param liquid_salinity: liquid salinity on center grid
:type liquid_salinity: Numpy Array of shape (I,)
:param center_grid: vertical coordinate of center grid
:type center_grid: Numpy Array of shape (I,)
:param edge_grid: Vertical coordinates of cell edges
:type edge_grid: Numpy Array of shape (I+1,)
:param cfg: Configuration object for the simulation.
:type cfg: seaice3p.params.Config
:return: Liquid darcy velocity on the edge grid.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_drainage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_brine_convection_liquid_velocity</span><span class="p">(</span>
    <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the vertical liquid Darcy velocity from Rees Jones and Worster 2014</span>

<span class="sd">    .. math:: W_l = \mathcal{A} (z_c - z)</span>

<span class="sd">    in the convecting region. The velocity is stagnant above the convecting region.</span>
<span class="sd">    The velocity is constant in the liquid region and continuous at the interface.</span>

<span class="sd">    NOTE: If no ice is present or if no convecting region exists returns zero velocity</span>

<span class="sd">    :param liquid_fraction: liquid fraction on center grid</span>
<span class="sd">    :type liquid_fraction: Numpy Array of shape (I,)</span>
<span class="sd">    :param liquid_salinity: liquid salinity on center grid</span>
<span class="sd">    :type liquid_salinity: Numpy Array of shape (I,)</span>
<span class="sd">    :param center_grid: vertical coordinate of center grid</span>
<span class="sd">    :type center_grid: Numpy Array of shape (I,)</span>
<span class="sd">    :param edge_grid: Vertical coordinates of cell edges</span>
<span class="sd">    :type edge_grid: Numpy Array of shape (I+1,)</span>
<span class="sd">    :param cfg: Configuration object for the simulation.</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: Liquid darcy velocity on the edge grid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ice_depth</span> <span class="o">=</span> <span class="n">calculate_ice_ocean_boundary_depth</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">)</span>
    <span class="n">Rayleigh_number</span> <span class="o">=</span> <span class="n">calculate_Rayleigh</span><span class="p">(</span>
        <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="n">convecting_region_height</span> <span class="o">=</span> <span class="n">get_convecting_region_height</span><span class="p">(</span>
        <span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="n">brine_channel_strength</span> <span class="o">=</span> <span class="n">calculate_brine_channel_strength</span><span class="p">(</span>
        <span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">ice_depth</span><span class="p">,</span> <span class="n">convecting_region_height</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>

    <span class="n">Wl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">edge_grid</span><span class="p">)</span>

    <span class="c1"># No ice present</span>
    <span class="k">if</span> <span class="n">ice_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Wl</span>

    <span class="c1"># ice present but no convection occuring</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">convecting_region_height</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Wl</span>

    <span class="c1"># Make liquid vertical velocity continuous at bottom of the ice</span>
    <span class="n">ocean_velocity</span> <span class="o">=</span> <span class="n">brine_channel_strength</span> <span class="o">*</span> <span class="p">(</span><span class="n">ice_depth</span> <span class="o">+</span> <span class="n">convecting_region_height</span><span class="p">)</span>

    <span class="n">is_convecting_ice</span> <span class="o">=</span> <span class="p">(</span><span class="n">edge_grid</span> <span class="o">&gt;=</span> <span class="o">-</span><span class="n">ice_depth</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span>
        <span class="n">edge_grid</span> <span class="o">&lt;=</span> <span class="n">convecting_region_height</span>
    <span class="p">)</span>
    <span class="n">is_liquid</span> <span class="o">=</span> <span class="n">edge_grid</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">ice_depth</span>

    <span class="n">Wl</span><span class="p">[</span><span class="n">is_convecting_ice</span><span class="p">]</span> <span class="o">=</span> <span class="n">brine_channel_strength</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">convecting_region_height</span> <span class="o">-</span> <span class="n">edge_grid</span><span class="p">[</span><span class="n">is_convecting_ice</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">Wl</span><span class="p">[</span><span class="n">is_liquid</span><span class="p">]</span> <span class="o">=</span> <span class="n">ocean_velocity</span>

    <span class="k">return</span> <span class="n">Wl</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_drainage.calculate_integrated_mean_permeability" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_integrated_mean_permeability</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">ice_depth</span><span class="p">,</span> <span class="n">cell_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the harmonic mean permeability from the base of the ice up to the
cell containing the specified z value using the expression of ReesJones2014.</p>
<p>.. math:: K(z) = (\frac{1}{h+z}\int_{-h}^{z} \frac{1}{\Pi(\phi_l(z'))}dz')^{-1}</p>
<p>:param z: height to integrate permeability up to
:type z: float
:param liquid_fraction: liquid fraction on the center grid
:type liquid_fraction: Numpy Array shape (I,)
:param ice_depth: positive depth position of ice ocean interface
:type ice_depth: float
:param cell_centers: cell center positions
:type cell_centers: Numpy Array of shape (I,)
:param cfg: Configuration object for the simulation.
:type cfg: seaice3p.params.Config
:return: permeability averaged from base of the ice up to given z value</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_drainage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_integrated_mean_permeability</span><span class="p">(</span>
    <span class="n">z</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">ice_depth</span><span class="p">,</span> <span class="n">cell_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the harmonic mean permeability from the base of the ice up to the</span>
<span class="sd">    cell containing the specified z value using the expression of ReesJones2014.</span>

<span class="sd">    .. math:: K(z) = (\frac{1}{h+z}\int_{-h}^{z} \frac{1}{\Pi(\phi_l(z&#39;))}dz&#39;)^{-1}</span>

<span class="sd">    :param z: height to integrate permeability up to</span>
<span class="sd">    :type z: float</span>
<span class="sd">    :param liquid_fraction: liquid fraction on the center grid</span>
<span class="sd">    :type liquid_fraction: Numpy Array shape (I,)</span>
<span class="sd">    :param ice_depth: positive depth position of ice ocean interface</span>
<span class="sd">    :type ice_depth: float</span>
<span class="sd">    :param cell_centers: cell center positions</span>
<span class="sd">    :type cell_centers: Numpy Array of shape (I,)</span>
<span class="sd">    :param cfg: Configuration object for the simulation.</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: permeability averaged from base of the ice up to given z value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">z</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">ice_depth</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="n">step</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">step</span>
    <span class="n">ice_mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">cell_centers</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">ice_depth</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cell_centers</span> <span class="o">&lt;=</span> <span class="n">z</span><span class="p">)</span>
    <span class="n">permeabilities</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">calculate_permeability</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">[</span><span class="n">ice_mask</span><span class="p">],</span> <span class="n">cfg</span><span class="p">)</span>
        <span class="o">/</span> <span class="n">liquid_fraction</span><span class="p">[</span><span class="n">ice_mask</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
    <span class="p">)</span>
    <span class="n">harmonic_mean</span> <span class="o">=</span> <span class="n">hmean</span><span class="p">(</span><span class="n">permeabilities</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">ice_depth</span> <span class="o">+</span> <span class="n">z</span> <span class="o">+</span> <span class="n">step</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">harmonic_mean</span> <span class="o">/</span> <span class="n">step</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_drainage.calculate_permeability" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_permeability</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the absolute permeability as a function of liquid fraction</p>
<p>.. math:: \Pi(\phi_l) = \phi_l^3</p>
<p>Alternatively if the porosity threshold flag is true</p>
<p>.. math:: \Pi(\phi_l) = \phi_l^2 (\phi_l - \phi_c)</p>
<p>:param liquid_fraction: liquid fraction
:type liquid_fraction: Numpy Array
:param cfg: Configuration object for the simulation.
:type cfg: seaice3p.params.Config
:return: permeability on the same grid as liquid fraction</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_drainage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_permeability</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the absolute permeability as a function of liquid fraction</span>

<span class="sd">    .. math:: \Pi(\phi_l) = \phi_l^3</span>

<span class="sd">    Alternatively if the porosity threshold flag is true</span>

<span class="sd">    .. math:: \Pi(\phi_l) = \phi_l^2 (\phi_l - \phi_c)</span>

<span class="sd">    :param liquid_fraction: liquid fraction</span>
<span class="sd">    :type liquid_fraction: Numpy Array</span>
<span class="sd">    :param cfg: Configuration object for the simulation.</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: permeability on the same grid as liquid fraction</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">porosity_threshold</span><span class="p">:</span>
        <span class="n">cutoff</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">porosity_threshold_value</span>
        <span class="n">step_function</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">heaviside</span><span class="p">(</span><span class="n">liquid_fraction</span> <span class="o">-</span> <span class="n">cutoff</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">liquid_fraction</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">liquid_fraction</span> <span class="o">-</span> <span class="n">cutoff</span><span class="p">)</span> <span class="o">*</span> <span class="n">step_function</span>
    <span class="k">return</span> <span class="n">liquid_fraction</span><span class="o">**</span><span class="mi">3</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_drainage.get_convecting_region_height" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_convecting_region_height</span><span class="p">(</span><span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the height of the convecting region as the top edge of the highest
cell in the domain for which the quantity</p>
<p>.. math:: \text{Ra}(z) - \text{Ra}_c</p>
<p>is greater than or equal to zero.</p>
<p>NOTE: if no convecting region exists return np.nan</p>
<p>:param Rayleigh_number: local rayleigh number on center grid
:type Rayleigh_number: Numpy Array of shape (I,)
:param edge_grid: The vertical coordinate positions of the edge grid.
:type edge_grid: Numpy Array (size I+1)
:param cfg: Configuration object for the simulation.
:type cfg: seaice3p.params.Config
:return: Edge grid value at convecting boundary.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_drainage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_convecting_region_height</span><span class="p">(</span><span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the height of the convecting region as the top edge of the highest</span>
<span class="sd">    cell in the domain for which the quantity</span>

<span class="sd">    .. math:: \text{Ra}(z) - \text{Ra}_c</span>

<span class="sd">    is greater than or equal to zero.</span>

<span class="sd">    NOTE: if no convecting region exists return np.nan</span>

<span class="sd">    :param Rayleigh_number: local rayleigh number on center grid</span>
<span class="sd">    :type Rayleigh_number: Numpy Array of shape (I,)</span>
<span class="sd">    :param edge_grid: The vertical coordinate positions of the edge grid.</span>
<span class="sd">    :type edge_grid: Numpy Array (size I+1)</span>
<span class="sd">    :param cfg: Configuration object for the simulation.</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: Edge grid value at convecting boundary.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Rayleigh_critical</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">Rayleigh_critical</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">Rayleigh_number</span> <span class="o">-</span> <span class="n">Rayleigh_critical</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">Rayleigh_number</span> <span class="o">&gt;=</span> <span class="n">Rayleigh_critical</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">edge_grid</span><span class="p">[</span><span class="n">indices</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.RJW14.brine_drainage.get_effective_Rayleigh_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_effective_Rayleigh_number</span><span class="p">(</span><span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate the effective Rayleigh Number as the maximum of</p>
<p>.. math:: \text{Ra}(z) - \text{Ra}_c</p>
<p>in the convecting region.</p>
<p>NOTE: if no convecting region exists returns 0.</p>
<p>:param Rayleigh_number: local rayleigh number on center grid
:type Rayleigh_number: Numpy Array of shape (I,)
:param cfg: Configuration object for the simulation.
:type cfg: seaice3p.params.Config
:return: Effective Rayleigh number.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/RJW14/brine_drainage.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_effective_Rayleigh_number</span><span class="p">(</span><span class="n">Rayleigh_number</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the effective Rayleigh Number as the maximum of</span>

<span class="sd">    .. math:: \text{Ra}(z) - \text{Ra}_c</span>

<span class="sd">    in the convecting region.</span>

<span class="sd">    NOTE: if no convecting region exists returns 0.</span>

<span class="sd">    :param Rayleigh_number: local rayleigh number on center grid</span>
<span class="sd">    :type Rayleigh_number: Numpy Array of shape (I,)</span>
<span class="sd">    :param cfg: Configuration object for the simulation.</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: Effective Rayleigh number.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">Rayleigh_critical</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">Rayleigh_critical</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
            <span class="n">Rayleigh_number</span> <span class="o">&gt;=</span> <span class="n">Rayleigh_critical</span><span class="p">,</span> <span class="n">Rayleigh_number</span> <span class="o">-</span> <span class="n">Rayleigh_critical</span><span class="p">,</span> <span class="mi">0</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.equations.equations" class="doc doc-heading">
            <code>equations</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="seaice3p.equations.equations._prevent_gas_rise_into_saturated_cell" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_prevent_gas_rise_into_saturated_cell</span><span class="p">(</span><span class="n">Vg</span><span class="p">,</span> <span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Modify the gas interstitial velocity to prevent bubble rise into a cell which
is already theoretically saturated with gas.</p>
<p>From the state with boundary conditions calculate the gas and solid fraction in the
cells (except at lower ghost cell). If any of these are such that there is more gas
fraction than pore space available then set gas insterstitial velocity to zero on
the edge below. Make sure the very top boundary velocity is not changed as we want
to always alow flux to the atmosphere regardless of the boundary conditions imposed.</p>
<p>:param Vg: gas insterstitial velocity on cell edges
:type Vg: Numpy array (size I+1)
:param state_BCs: state of system with boundary conditions
:type state_BCs: seaice3p.state.StateBCs
:return: filtered gas interstitial velocities on edges to prevent gas rise into a
    fully gas saturated cell</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/equations.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_prevent_gas_rise_into_saturated_cell</span><span class="p">(</span>
    <span class="n">Vg</span><span class="p">,</span> <span class="n">state_BCs</span><span class="p">:</span> <span class="n">StateBCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Modify the gas interstitial velocity to prevent bubble rise into a cell which</span>
<span class="sd">    is already theoretically saturated with gas.</span>

<span class="sd">    From the state with boundary conditions calculate the gas and solid fraction in the</span>
<span class="sd">    cells (except at lower ghost cell). If any of these are such that there is more gas</span>
<span class="sd">    fraction than pore space available then set gas insterstitial velocity to zero on</span>
<span class="sd">    the edge below. Make sure the very top boundary velocity is not changed as we want</span>
<span class="sd">    to always alow flux to the atmosphere regardless of the boundary conditions imposed.</span>

<span class="sd">    :param Vg: gas insterstitial velocity on cell edges</span>
<span class="sd">    :type Vg: Numpy array (size I+1)</span>
<span class="sd">    :param state_BCs: state of system with boundary conditions</span>
<span class="sd">    :type state_BCs: seaice3p.state.StateBCs</span>
<span class="sd">    :return: filtered gas interstitial velocities on edges to prevent gas rise into a</span>
<span class="sd">        fully gas saturated cell</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prevent gas rising into already gas saturated cell</span>
    <span class="n">gas_fraction_above</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">solid_fraction_above</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">filtered_Vg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">gas_fraction_above</span> <span class="o">+</span> <span class="n">solid_fraction_above</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Vg</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">escape_ice_surface</span><span class="p">:</span>
        <span class="c1"># Allow gas to leave top boundary</span>
        <span class="n">filtered_Vg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">Vg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># impermeable top boundary</span>
        <span class="n">filtered_Vg</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">return</span> <span class="n">filtered_Vg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.equations.flux" class="doc doc-heading">
            <code>flux</code>


</h3>

    <div class="doc doc-contents ">

        <p>Module for calculating the fluxes using upwind scheme</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.flux.bulk_dissolved_gas_flux" class="doc doc-heading">
            <code>bulk_dissolved_gas_flux</code>


</h4>

    <div class="doc doc-contents ">

        <p>calculate the flux terms for the dissolved gas equation in DISEQ model</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.flux.gas_fraction_flux" class="doc doc-heading">
            <code>gas_fraction_flux</code>


</h4>

    <div class="doc doc-contents ">

        <p>Calculate gas phase fluxes for disequilibrium model</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.flux.heat_flux" class="doc doc-heading">
            <code>heat_flux</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.flux.heat_flux.calculate_conductive_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_conductive_heat_flux</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">D_g</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate conductive heat flux as</p>
<p>.. math:: -[(\phi_l + \lambda \phi_s) \frac{\partial \theta}{\partial z}]</p>
<p>:param temperature: temperature including ghost cells
:type temperature: Numpy Array of size I+2
:param D_g: difference matrix for ghost grid
:type D_g: Numpy Array
:param cfg: Simulation configuration
:type cfg: seaice3p.params.Config
:return: conductive heat flux</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/flux/heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_conductive_heat_flux</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">D_g</span><span class="p">,</span> <span class="n">cfg</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate conductive heat flux as</span>

<span class="sd">    .. math:: -[(\phi_l + \lambda \phi_s) \frac{\partial \theta}{\partial z}]</span>

<span class="sd">    :param temperature: temperature including ghost cells</span>
<span class="sd">    :type temperature: Numpy Array of size I+2</span>
<span class="sd">    :param D_g: difference matrix for ghost grid</span>
<span class="sd">    :type D_g: Numpy Array</span>
<span class="sd">    :param cfg: Simulation configuration</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: conductive heat flux</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">temperature</span>
    <span class="n">edge_liquid_fraction</span> <span class="o">=</span> <span class="n">geometric</span><span class="p">(</span><span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">)</span>
    <span class="n">edge_solid_fraction</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">edge_liquid_fraction</span>
    <span class="n">conductivity</span> <span class="o">=</span> <span class="n">calculate_conductivity</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">edge_solid_fraction</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">conductivity</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">D_g</span><span class="p">,</span> <span class="n">temperature</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.flux.heat_flux.pure_liquid_switch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">pure_liquid_switch</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Take the liquid fraction and return a smoothed switch that is equal to 1 in a
pure liquid region and goes to zero rapidly outside of this</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/flux/heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pure_liquid_switch</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">:</span> <span class="n">NDArray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span> <span class="o">|</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take the liquid fraction and return a smoothed switch that is equal to 1 in a</span>
<span class="sd">    pure liquid region and goes to zero rapidly outside of this&quot;&quot;&quot;</span>
    <span class="n">SCALE</span> <span class="o">=</span> <span class="mf">1e-2</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">liquid_fraction</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">SCALE</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.flux.salt_flux" class="doc doc-heading">
            <code>salt_flux</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.flux.salt_flux.calculate_diffusive_salt_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_diffusive_salt_flux</span><span class="p">(</span><span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">D_g</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Take liquid salinity and liquid fraction on ghost grid and interpolate liquid
fraction geometrically</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/flux/salt_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_diffusive_salt_flux</span><span class="p">(</span><span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">D_g</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take liquid salinity and liquid fraction on ghost grid and interpolate liquid</span>
<span class="sd">    fraction geometrically&quot;&quot;&quot;</span>
    <span class="n">lewis_salt</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">lewis_salt</span>
    <span class="n">edge_liquid_fraction</span> <span class="o">=</span> <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">)</span>
    <span class="c1"># In pure liquid phase enhanced eddy diffusivity of dissolved salt</span>
    <span class="n">salt_diffusivity</span> <span class="o">=</span> <span class="n">edge_liquid_fraction</span> <span class="o">*</span> <span class="p">(</span>
        <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">lewis_salt</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">eddy_diffusivity_ratio</span>
        <span class="o">*</span> <span class="n">pure_liquid_switch</span><span class="p">(</span><span class="n">edge_liquid_fraction</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">salt_diffusivity</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">D_g</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.equations.nucleation" class="doc doc-heading">
            <code>nucleation</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="seaice3p.equations.nucleation._DISEQ_nucleation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_DISEQ_nucleation</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>implement nucleation term</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/nucleation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_DISEQ_nucleation</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">:</span> <span class="n">DISEQStateBCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;implement nucleation term&quot;&quot;&quot;</span>
    <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">state_BCs</span><span class="o">.</span><span class="n">enthalpy</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">chi</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">expansion_coefficient</span>
    <span class="n">Da</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">damkohler_number</span>
    <span class="n">centers</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">s_</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">bulk_dissolved_gas</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">bulk_dissolved_gas</span><span class="p">[</span><span class="n">centers</span><span class="p">]</span>
    <span class="n">liquid_fraction</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[</span><span class="n">centers</span><span class="p">]</span>
    <span class="n">saturation</span> <span class="o">=</span> <span class="n">chi</span> <span class="o">*</span> <span class="n">liquid_fraction</span>
    <span class="n">gas_fraction</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">[</span><span class="n">centers</span><span class="p">]</span>

    <span class="n">is_saturated</span> <span class="o">=</span> <span class="n">bulk_dissolved_gas</span> <span class="o">&gt;</span> <span class="n">saturation</span>
    <span class="n">nucleation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">bulk_dissolved_gas</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">nucleation</span><span class="p">[</span><span class="n">is_saturated</span><span class="p">]</span> <span class="o">=</span> <span class="n">Da</span> <span class="o">*</span> <span class="p">(</span>
        <span class="n">bulk_dissolved_gas</span><span class="p">[</span><span class="n">is_saturated</span><span class="p">]</span> <span class="o">-</span> <span class="n">saturation</span><span class="p">[</span><span class="n">is_saturated</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">nucleation</span><span class="p">[</span><span class="o">~</span><span class="n">is_saturated</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">Da</span> <span class="o">*</span> <span class="n">gas_fraction</span><span class="p">[</span><span class="o">~</span><span class="n">is_saturated</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
        <span class="p">(</span>
            <span class="n">zeros</span><span class="p">,</span>
            <span class="n">zeros</span><span class="p">,</span>
            <span class="o">-</span><span class="n">nucleation</span><span class="p">,</span>
            <span class="n">nucleation</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.equations.nucleation._EQM_nucleation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_EQM_nucleation</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>implement nucleation term</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/nucleation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_EQM_nucleation</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">:</span> <span class="n">EQMStateBCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;implement nucleation term&quot;&quot;&quot;</span>
    <span class="n">zeros</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">state_BCs</span><span class="o">.</span><span class="n">enthalpy</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">zeros</span><span class="p">,</span> <span class="n">zeros</span><span class="p">,</span> <span class="n">zeros</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.equations.radiative_heating" class="doc doc-heading">
            <code>radiative_heating</code>


</h3>

    <div class="doc doc-contents ">

        <p>Calculate internal shortwave radiative heating due to oil droplets</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="seaice3p.equations.radiative_heating._calculate_non_dimensional_shortwave_heating" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_non_dimensional_shortwave_heating</span><span class="p">(</span><span class="n">state_bcs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate internal shortwave heating due to oil droplets on center grid</p>
<p>Assumes a configuration with the RadForcing object as the forcing config is
passed.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/radiative_heating.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_non_dimensional_shortwave_heating</span><span class="p">(</span>
    <span class="n">state_bcs</span><span class="p">:</span> <span class="n">StateBCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">grids</span><span class="p">:</span> <span class="n">Grids</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate internal shortwave heating due to oil droplets on center grid</span>

<span class="sd">    Assumes a configuration with the RadForcing object as the forcing config is</span>
<span class="sd">    passed.&quot;&quot;&quot;</span>
    <span class="c1"># If we don&#39;t have radiative forcing then just return array of zeros for heating</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">RadForcing</span><span class="p">)</span>
        <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">ERA5Forcing</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grids</span><span class="o">.</span><span class="n">centers</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">oil_heating</span><span class="p">,</span> <span class="n">DimensionalNoHeating</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grids</span><span class="o">.</span><span class="n">centers</span><span class="p">)</span>

    <span class="n">incident_SW_in_W_m2</span> <span class="o">=</span> <span class="n">get_SW_forcing</span><span class="p">(</span><span class="n">state_bcs</span><span class="o">.</span><span class="n">time</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
    <span class="c1"># If incident shortwave is small then optimize by not running the two-stream model</span>
    <span class="k">if</span> <span class="n">incident_SW_in_W_m2</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">grids</span><span class="o">.</span><span class="n">centers</span><span class="p">)</span>

    <span class="n">dimensionless_incident_SW</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_from_dimensional_heat_flux</span><span class="p">(</span>
        <span class="n">incident_SW_in_W_m2</span>
    <span class="p">)</span>

    <span class="n">spectral_irradiances</span> <span class="o">=</span> <span class="n">run_two_stream_model</span><span class="p">(</span><span class="n">state_bcs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span>
    <span class="n">integrated_irradiance</span> <span class="o">=</span> <span class="n">oi</span><span class="o">.</span><span class="n">integrate_over_SW</span><span class="p">(</span><span class="n">spectral_irradiances</span><span class="p">)</span>

    <span class="n">dz_dF_net</span> <span class="o">=</span> <span class="n">grids</span><span class="o">.</span><span class="n">D_e</span> <span class="o">@</span> <span class="n">integrated_irradiance</span><span class="o">.</span><span class="n">net_irradiance</span>
    <span class="k">return</span> <span class="n">dimensionless_incident_SW</span> <span class="o">*</span> <span class="n">dz_dF_net</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.equations.radiative_heating.get_radiative_heating" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_radiative_heating</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate internal shortwave heating source for enthalpy equation.</p>
<p>if the RadForcing object is given as the forcing config then calculates internal
heating based on the object given in the configuration for oil_heating.</p>
<p>If another forcing is chosen then just returns a function to create an array of
zeros as no internal heating is calculated.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/radiative_heating.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_radiative_heating</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">grids</span><span class="p">:</span> <span class="n">Grids</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">StateBCs</span><span class="p">],</span> <span class="n">NDArray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate internal shortwave heating source for enthalpy equation.</span>

<span class="sd">    if the RadForcing object is given as the forcing config then calculates internal</span>
<span class="sd">    heating based on the object given in the configuration for oil_heating.</span>

<span class="sd">    If another forcing is chosen then just returns a function to create an array of</span>
<span class="sd">    zeros as no internal heating is calculated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fun_map</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">EQMPhysicalParams</span><span class="p">:</span> <span class="n">_EQM_radiative_heating</span><span class="p">,</span>
        <span class="n">DISEQPhysicalParams</span><span class="p">:</span> <span class="n">_DISEQ_radiative_heating</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">radiative_heating</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">:</span> <span class="n">StateBCs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fun_map</span><span class="p">[</span><span class="nb">type</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="p">)](</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">grids</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">radiative_heating</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.equations.velocities" class="doc doc-heading">
            <code>velocities</code>


</h3>

    <div class="doc doc-contents ">

        <p>Module to calculate Darcy velocities.</p>
<p>The liquid Darcy velocity must be parameterised.</p>
<p>The gas Darcy velocity is calculated as gas_fraction x interstitial bubble velocity</p>
<p>Interstitial bubble velocity is found by a steady state Stoke's flow calculation.
We have implemented two cases
mono: All bubbles nucleate and remain the same size
power_law: A power law bubble size distribution with fixed max and min.</p>








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.velocities.bubble_parameters" class="doc doc-heading">
            <code>bubble_parameters</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.bubble_parameters.calculate_bubble_size_fraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_bubble_size_fraction</span><span class="p">(</span><span class="n">bubble_radius_scaled</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Takes bubble radius scaled and liquid fraction on edges and calculates the
bubble size fraction as</p>
<p>.. math:: \lambda = \Lambda / (\phi_l^q + \text{reg})</p>
<p>Returns the bubble size fraction on the edge grid.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/bubble_parameters.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_bubble_size_fraction</span><span class="p">(</span><span class="n">bubble_radius_scaled</span><span class="p">,</span> <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Takes bubble radius scaled and liquid fraction on edges and calculates the</span>
<span class="sd">    bubble size fraction as</span>

<span class="sd">    .. math:: \lambda = \Lambda / (\phi_l^q + \text{reg})</span>

<span class="sd">    Returns the bubble size fraction on the edge grid.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">pore_throat_scaling</span>
    <span class="n">reg</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">regularisation</span>
    <span class="n">effective_tube_radius</span> <span class="o">=</span> <span class="n">liquid_fraction</span><span class="o">**</span><span class="n">exponent</span> <span class="o">+</span> <span class="n">reg</span>
    <span class="k">return</span> <span class="n">bubble_radius_scaled</span> <span class="o">/</span> <span class="n">effective_tube_radius</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.velocities.mono_distribution" class="doc doc-heading">
            <code>mono_distribution</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.mono_distribution.calculate_lag_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_lag_function</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate lag function from bubble size fraction on edge grid as</p>
<p>.. math:: G(\lambda) = 1 - \lambda / 2</p>
<p>for 0&lt;lambda&lt;1. Edge cases are given by G(0)=1 and G(1) = 0.5 for values outside
this range.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/mono_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_lag_function</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate lag function from bubble size fraction on edge grid as</span>

<span class="sd">    .. math:: G(\lambda) = 1 - \lambda / 2</span>

<span class="sd">    for 0&lt;lambda&lt;1. Edge cases are given by G(0)=1 and G(1) = 0.5 for values outside</span>
<span class="sd">    this range.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">lag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">intermediate</span> <span class="o">=</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">large</span> <span class="o">=</span> <span class="n">bubble_size_fraction</span> <span class="o">&gt;=</span> <span class="mi">1</span>
    <span class="n">lag</span><span class="p">[</span><span class="n">bubble_size_fraction</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">lag</span><span class="p">[</span><span class="n">intermediate</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span><span class="p">[</span><span class="n">intermediate</span><span class="p">]</span>
    <span class="n">lag</span><span class="p">[</span><span class="n">large</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="k">return</span> <span class="n">lag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.mono_distribution.calculate_mono_lag_factor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_mono_lag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Take liquid fraction on the ghost grid and calculate the lag factor
for a mono bubble size distribution as</p>
<p>.. math:: I_2 = G(\lambda)</p>
<p>returns lag factor on the edge grid</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/mono_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_mono_lag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Take liquid fraction on the ghost grid and calculate the lag factor</span>
<span class="sd">    for a mono bubble size distribution as</span>

<span class="sd">    .. math:: I_2 = G(\lambda)</span>

<span class="sd">    returns lag factor on the edge grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bubble_radius_scaled</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">bubble_radius_scaled</span>
    <span class="n">bubble_size_fraction</span> <span class="o">=</span> <span class="n">calculate_bubble_size_fraction</span><span class="p">(</span>
        <span class="n">bubble_radius_scaled</span><span class="p">,</span> <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">),</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">calculate_lag_function</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.mono_distribution.calculate_mono_wall_drag_factor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_mono_wall_drag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Take liquid fraction on the ghost grid and calculate the wall drag factor
for a mono bubble size distribution as</p>
<p>.. math:: I_1 = \frac{\lambda^2}{K(\lambda)}</p>
<p>returns wall drag factor on the edge grid</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/mono_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_mono_wall_drag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Take liquid fraction on the ghost grid and calculate the wall drag factor</span>
<span class="sd">    for a mono bubble size distribution as</span>

<span class="sd">    .. math:: I_1 = \frac{\lambda^2}{K(\lambda)}</span>

<span class="sd">    returns wall drag factor on the edge grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">bubble_radius_scaled</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">bubble_radius_scaled</span>
    <span class="n">bubble_size_fraction</span> <span class="o">=</span> <span class="n">calculate_bubble_size_fraction</span><span class="p">(</span>
        <span class="n">bubble_radius_scaled</span><span class="p">,</span> <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">),</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="n">drag_function</span> <span class="o">=</span> <span class="n">calculate_wall_drag_function</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
    <span class="n">drag_factor</span> <span class="o">=</span> <span class="n">drag_function</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">drag_factor</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.mono_distribution.calculate_wall_drag_function" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_wall_drag_function</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate wall drag function from bubble size fraction on edge grid as</p>
<p>.. math:: \frac{1}{K(\lambda)} = (1 - \lambda)^r</p>
<p>in the power law case or in the Haberman case from the paper</p>
<p>.. math:: \frac{1}{K(\lambda)} = \frac{1 -1.5\lambda + 1.5\lambda^5 - \lambda^6}{1+1.5\lambda^5}</p>
<p>for 0&lt;lambda&lt;1. Edge cases are given by K(0)=1 and K(1) = 0 for values outside
this range.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/mono_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_wall_drag_function</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate wall drag function from bubble size fraction on edge grid as</span>

<span class="sd">    .. math:: \frac{1}{K(\lambda)} = (1 - \lambda)^r</span>

<span class="sd">    in the power law case or in the Haberman case from the paper</span>

<span class="sd">    .. math:: \frac{1}{K(\lambda)} = \frac{1 -1.5\lambda + 1.5\lambda^5 - \lambda^6}{1+1.5\lambda^5}</span>

<span class="sd">    for 0&lt;lambda&lt;1. Edge cases are given by K(0)=1 and K(1) = 0 for values outside</span>
<span class="sd">    this range.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">drag</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">intermediate</span> <span class="o">=</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">large</span> <span class="o">=</span> <span class="n">bubble_size_fraction</span> <span class="o">&gt;=</span> <span class="mi">1</span>
    <span class="n">drag</span><span class="p">[</span><span class="n">bubble_size_fraction</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">drag</span><span class="p">[</span><span class="n">intermediate</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">1</span>
        <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span><span class="p">[</span><span class="n">intermediate</span><span class="p">]</span>
        <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span><span class="p">[</span><span class="n">intermediate</span><span class="p">]</span> <span class="o">**</span> <span class="mi">5</span>
        <span class="o">-</span> <span class="n">bubble_size_fraction</span><span class="p">[</span><span class="n">intermediate</span><span class="p">]</span> <span class="o">**</span> <span class="mi">6</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span><span class="p">[</span><span class="n">intermediate</span><span class="p">]</span> <span class="o">**</span> <span class="mi">5</span><span class="p">)</span>
    <span class="n">drag</span><span class="p">[</span><span class="n">large</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">return</span> <span class="n">drag</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.velocities.power_law_distribution" class="doc doc-heading">
            <code>power_law_distribution</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.power_law_distribution.calculate_lag_integrand" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_lag_integrand</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Scalar function to calculate lag integrand for polydispersive case.</p>
<p>Bubble size fraction is given as a scalar input to calculate</p>
<p>.. math:: \lambda^{3-p} G(\lambda)</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/power_law_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_lag_integrand</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Scalar function to calculate lag integrand for polydispersive case.</span>

<span class="sd">    Bubble size fraction is given as a scalar input to calculate</span>

<span class="sd">    .. math:: \lambda^{3-p} G(\lambda)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">power_law</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">bubble_distribution_power</span>
    <span class="k">if</span> <span class="n">bubble_size_fraction</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">bubble_size_fraction</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">power_law</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.5</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.power_law_distribution.calculate_power_law_lag_factor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_power_law_lag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Take liquid fraction on the ghost grid and calculate the lag factor
for power law bubble size distribution.</p>
<p>Return on edge grid</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/power_law_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_power_law_lag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Take liquid fraction on the ghost grid and calculate the lag factor</span>
<span class="sd">    for power law bubble size distribution.</span>

<span class="sd">    Return on edge grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">minimum_size_fractions</span> <span class="o">=</span> <span class="n">calculate_bubble_size_fraction</span><span class="p">(</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">minimum_bubble_radius_scaled</span><span class="p">,</span>
        <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">),</span>
        <span class="n">cfg</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">maximum_size_fractions</span> <span class="o">=</span> <span class="n">calculate_bubble_size_fraction</span><span class="p">(</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">maximum_bubble_radius_scaled</span><span class="p">,</span>
        <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">),</span>
        <span class="n">cfg</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">lag_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">minimum_size_fractions</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">minimum_size_fractions</span><span class="p">,</span> <span class="n">maximum_size_fractions</span><span class="p">)):</span>
        <span class="n">lag_factor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_lag_integral</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lag_factor</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.power_law_distribution.calculate_power_law_wall_drag_factor" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_power_law_wall_drag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Take liquid fraction on the ghost grid and calculate the wall drag factor
for power law bubble size distribution.</p>
<p>Return on edge grid</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/power_law_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_power_law_wall_drag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Take liquid fraction on the ghost grid and calculate the wall drag factor</span>
<span class="sd">    for power law bubble size distribution.</span>

<span class="sd">    Return on edge grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">minimum_size_fractions</span> <span class="o">=</span> <span class="n">calculate_bubble_size_fraction</span><span class="p">(</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">minimum_bubble_radius_scaled</span><span class="p">,</span>
        <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">),</span>
        <span class="n">cfg</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">maximum_size_fractions</span> <span class="o">=</span> <span class="n">calculate_bubble_size_fraction</span><span class="p">(</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">maximum_bubble_radius_scaled</span><span class="p">,</span>
        <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">),</span>
        <span class="n">cfg</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">drag_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">minimum_size_fractions</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">minimum_size_fractions</span><span class="p">,</span> <span class="n">maximum_size_fractions</span><span class="p">)):</span>
        <span class="n">drag_factor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_wall_drag_integral</span><span class="p">(</span><span class="nb">min</span><span class="p">,</span> <span class="nb">max</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">drag_factor</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.power_law_distribution.calculate_volume_integrand" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_volume_integrand</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Scalar function to calculate the integrand for volume under a power law
bubble size distribution given as</p>
<p>.. math:: \lambda^{3-p}</p>
<p>in terms of the bubble size fraction.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/power_law_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_volume_integrand</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Scalar function to calculate the integrand for volume under a power law</span>
<span class="sd">    bubble size distribution given as</span>

<span class="sd">    .. math:: \lambda^{3-p}</span>

<span class="sd">    in terms of the bubble size fraction.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">bubble_distribution_power</span>
    <span class="k">return</span> <span class="n">bubble_size_fraction</span> <span class="o">**</span> <span class="p">(</span><span class="mi">3</span> <span class="o">-</span> <span class="n">p</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.power_law_distribution.calculate_wall_drag_integrand" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_wall_drag_integrand</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Scalar function to calculate wall drag integrand for polydispersive case.</p>
<p>Bubble size fraction is given as a scalar input to calculate</p>
<p>.. math:: \frac{\lambda^{5-p}}{K(\lambda)}</p>
<p>where the wall drag enhancement funciton K can be given by a power law fit
or taken from the Haberman paper.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/power_law_distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_wall_drag_integrand</span><span class="p">(</span><span class="n">bubble_size_fraction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Scalar function to calculate wall drag integrand for polydispersive case.</span>

<span class="sd">    Bubble size fraction is given as a scalar input to calculate</span>

<span class="sd">    .. math:: \frac{\lambda^{5-p}}{K(\lambda)}</span>

<span class="sd">    where the wall drag enhancement funciton K can be given by a power law fit</span>
<span class="sd">    or taken from the Haberman paper.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">power_law</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">bubble_distribution_power</span>
    <span class="k">if</span> <span class="n">bubble_size_fraction</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">elif</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span>
                <span class="mi">1</span>
                <span class="o">-</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span>
                <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span><span class="o">**</span><span class="mi">5</span>
                <span class="o">-</span> <span class="n">bubble_size_fraction</span><span class="o">**</span><span class="mi">6</span>
            <span class="p">)</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">bubble_size_fraction</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span>
        <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">bubble_size_fraction</span> <span class="o">**</span> <span class="p">(</span><span class="mi">5</span> <span class="o">-</span> <span class="n">power_law</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.equations.velocities.velocities" class="doc doc-heading">
            <code>velocities</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.velocities.calculate_gas_interstitial_velocity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_gas_interstitial_velocity</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_darcy_velocity</span><span class="p">,</span> <span class="n">wall_drag_factor</span><span class="p">,</span> <span class="n">lag_factor</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate Vg from liquid fraction on the ghost frid and liquid interstitial velocity</p>
<p>.. math:: V_g = \mathcal{B} (\phi_l^{2q} I_1) + U_0 I_2</p>
<p>Return Vg on edge grid</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/velocities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_gas_interstitial_velocity</span><span class="p">(</span>
    <span class="n">liquid_fraction</span><span class="p">,</span>
    <span class="n">liquid_darcy_velocity</span><span class="p">,</span>
    <span class="n">wall_drag_factor</span><span class="p">,</span>
    <span class="n">lag_factor</span><span class="p">,</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate Vg from liquid fraction on the ghost frid and liquid interstitial velocity</span>

<span class="sd">    .. math:: V_g = \mathcal{B} (\phi_l^{2q} I_1) + U_0 I_2</span>

<span class="sd">    Return Vg on edge grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">B</span>
    <span class="n">exponent</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">pore_throat_scaling</span>

    <span class="n">REGULARISATION</span> <span class="o">=</span> <span class="mf">1e-10</span>
    <span class="n">liquid_interstitial_velocity</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">liquid_darcy_velocity</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">)</span> <span class="o">+</span> <span class="n">REGULARISATION</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="n">viscosity_factor</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mi">2</span>
        <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">gas_viscosity_ratio</span><span class="p">)</span>
        <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">gas_viscosity_ratio</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="n">Vg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">viscosity_factor</span>
        <span class="o">*</span> <span class="n">B</span>
        <span class="o">*</span> <span class="n">wall_drag_factor</span>
        <span class="o">*</span> <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">exponent</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">liquid_interstitial_velocity</span> <span class="o">*</span> <span class="n">lag_factor</span>
    <span class="p">)</span>

    <span class="c1"># apply a porosity cutoff to the gas interstitial velocity if necking occurs below</span>
    <span class="c1"># critical porosity.</span>
    <span class="k">if</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">porosity_threshold</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Vg</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">heaviside</span><span class="p">(</span>
            <span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">)</span> <span class="o">-</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">porosity_threshold_value</span><span class="p">,</span>
            <span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">Vg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.velocities.calculate_liquid_darcy_velocity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_liquid_darcy_velocity</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate liquid Darcy velocity either using brine convection parameterisation
or as stagnant</p>
<p>:param liquid_fraction: liquid fraction on ghost grid
:type liquid_fraction: Numpy Array (size I+2)
:param liquid_salinity: liquid salinity on ghost grid
:type liquid_salinity: Numpy Array (size I+2)
:param center_grid: vertical coordinates of cell centers
:type center_grid: Numpy Array of shape (I,)
:param edge_grid: Vertical coordinates of cell edges
:type edge_grid: Numpy Array (size I+1)
:param cfg: simulation configuration object
:type cfg: seaice3p.params.Config
:return: liquid darcy velocity on edge grid</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/velocities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_liquid_darcy_velocity</span><span class="p">(</span>
    <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
<span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate liquid Darcy velocity either using brine convection parameterisation</span>
<span class="sd">    or as stagnant</span>


<span class="sd">    :param liquid_fraction: liquid fraction on ghost grid</span>
<span class="sd">    :type liquid_fraction: Numpy Array (size I+2)</span>
<span class="sd">    :param liquid_salinity: liquid salinity on ghost grid</span>
<span class="sd">    :type liquid_salinity: Numpy Array (size I+2)</span>
<span class="sd">    :param center_grid: vertical coordinates of cell centers</span>
<span class="sd">    :type center_grid: Numpy Array of shape (I,)</span>
<span class="sd">    :param edge_grid: Vertical coordinates of cell edges</span>
<span class="sd">    :type edge_grid: Numpy Array (size I+1)</span>
<span class="sd">    :param cfg: simulation configuration object</span>
<span class="sd">    :type cfg: seaice3p.params.Config</span>
<span class="sd">    :return: liquid darcy velocity on edge grid</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="p">,</span> <span class="n">NoBrineConvection</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">geometric</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">))</span>

    <span class="n">Wl</span> <span class="o">=</span> <span class="n">calculate_brine_convection_liquid_velocity</span><span class="p">(</span>
        <span class="n">liquid_fraction</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">liquid_salinity</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">Wl</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.equations.velocities.velocities.calculate_velocities" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_velocities</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Inputs on ghost grid, outputs on edge grid</p>
<p>needs the simulation config, liquid fraction, liquid salinity and grids</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/equations/velocities/velocities.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_velocities</span><span class="p">(</span><span class="n">state_BCs</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Inputs on ghost grid, outputs on edge grid</span>

<span class="sd">    needs the simulation config, liquid fraction, liquid salinity and grids</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">liquid_fraction</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_fraction</span>
    <span class="n">liquid_salinity</span> <span class="o">=</span> <span class="n">state_BCs</span><span class="o">.</span><span class="n">liquid_salinity</span>
    <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">Grids</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">centers</span><span class="p">,</span>
        <span class="n">Grids</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">edges</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">match</span> <span class="n">cfg</span><span class="o">.</span><span class="n">bubble_params</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">MonoBubbleParams</span><span class="p">():</span>
            <span class="n">wall_drag_factor</span> <span class="o">=</span> <span class="n">calculate_mono_wall_drag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
            <span class="n">lag_factor</span> <span class="o">=</span> <span class="n">calculate_mono_lag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
        <span class="k">case</span> <span class="n">PowerLawBubbleParams</span><span class="p">():</span>
            <span class="n">wall_drag_factor</span> <span class="o">=</span> <span class="n">calculate_power_law_wall_drag_factor</span><span class="p">(</span>
                <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span>
            <span class="p">)</span>
            <span class="n">lag_factor</span> <span class="o">=</span> <span class="n">calculate_power_law_lag_factor</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
        <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="c1"># check if we want to couple the bubble to fluid motion in the vertical</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="p">,</span> <span class="n">NoBrineConvection</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">couple_bubble_to_vertical_flow</span><span class="p">:</span>
            <span class="n">lag_factor</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">wall_drag_factor</span><span class="p">)</span>

    <span class="n">Wl</span> <span class="o">=</span> <span class="n">calculate_liquid_darcy_velocity</span><span class="p">(</span>
        <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">liquid_salinity</span><span class="p">,</span> <span class="n">center_grid</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="n">Vg</span> <span class="o">=</span> <span class="n">calculate_gas_interstitial_velocity</span><span class="p">(</span>
        <span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">Wl</span><span class="p">,</span> <span class="n">wall_drag_factor</span><span class="p">,</span> <span class="n">lag_factor</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <span class="n">calculate_frame_velocity</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Vg</span><span class="p">,</span> <span class="n">Wl</span><span class="p">,</span> <span class="n">V</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.example" class="doc doc-heading">
            <code>example</code>


</h2>

    <div class="doc doc-contents ">

        <p>Script to run a simulation starting with dimensional parameters and plot output</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="seaice3p.example.main" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">main</span><span class="p">(</span><span class="n">data_directory</span><span class="p">,</span> <span class="n">frames_directory</span><span class="p">,</span> <span class="n">simulation_dimensional_params</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate non dimensional simulation config and save along with dimensional
config then run simulation and save data.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/example.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span>
    <span class="n">data_directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">frames_directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">simulation_dimensional_params</span><span class="p">:</span> <span class="n">DimensionalParams</span><span class="p">,</span>
<span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate non dimensional simulation config and save along with dimensional</span>
<span class="sd">    config then run simulation and save data.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;seaice3p version </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">cfg</span> <span class="o">=</span> <span class="n">create_and_save_config</span><span class="p">(</span><span class="n">data_directory</span><span class="p">,</span> <span class="n">simulation_dimensional_params</span><span class="p">)</span>
    <span class="n">solve</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">data_directory</span><span class="p">,</span> <span class="n">verbosity_level</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Analysis load simulation data</span>
    <span class="c1"># plot:</span>
    <span class="c1"># gas_fraction</span>
    <span class="c1"># salt</span>
    <span class="c1"># temperature</span>
    <span class="c1"># solid_fraction</span>
    <span class="c1"># save as frames in frames/gas_fraction etc...</span>
    <span class="n">simulation_name</span> <span class="o">=</span> <span class="n">simulation_dimensional_params</span><span class="o">.</span><span class="n">name</span>
    <span class="n">DIMENSIONAL_CONFIG_DATA_PATH</span> <span class="o">=</span> <span class="n">data_directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">simulation_name</span><span class="si">}</span><span class="s2">_dimensional.yml&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">load_simulation</span><span class="p">(</span>
        <span class="n">DATA_DIRECTORY</span> <span class="o">/</span> <span class="s2">&quot;example_dimensional.yml&quot;</span><span class="p">,</span>
        <span class="n">DATA_DIRECTORY</span> <span class="o">/</span> <span class="s2">&quot;example.npz&quot;</span><span class="p">,</span>
        <span class="n">is_dimensional</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">scales</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span>
    <span class="n">dimensional_grid</span> <span class="o">=</span> <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_grid</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">centers</span><span class="p">)</span>
    <span class="n">dimensional_times</span> <span class="o">=</span> <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_time</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">times</span><span class="p">)</span>

    <span class="n">GAS_FRACTION_DIR</span> <span class="o">=</span> <span class="n">frames_directory</span> <span class="o">/</span> <span class="s2">&quot;gas_fraction/&quot;</span>
    <span class="n">GAS_FRACTION_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">TEMPERATURE_DIR</span> <span class="o">=</span> <span class="n">frames_directory</span> <span class="o">/</span> <span class="s2">&quot;temperature/&quot;</span>
    <span class="n">TEMPERATURE_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">SOLID_FRAC_DIR</span> <span class="o">=</span> <span class="n">frames_directory</span> <span class="o">/</span> <span class="s2">&quot;solid_fraction/&quot;</span>
    <span class="n">SOLID_FRAC_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">BULK_AIR_DIR</span> <span class="o">=</span> <span class="n">frames_directory</span> <span class="o">/</span> <span class="s2">&quot;bulk_air/&quot;</span>
    <span class="n">BULK_AIR_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">BULK_SALT_DIR</span> <span class="o">=</span> <span class="n">frames_directory</span> <span class="o">/</span> <span class="s2">&quot;bulk_salt/&quot;</span>
    <span class="n">BULK_SALT_DIR</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">state</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">states</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">state</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">,</span>
            <span class="n">dimensional_grid</span><span class="p">,</span>
            <span class="s2">&quot;g*--&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dimensional_times</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;gas fraction&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;depth [m]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">GAS_FRACTION_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;gas_fraction</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_bulk_salinity</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">salt</span><span class="p">),</span>
            <span class="n">dimensional_grid</span><span class="p">,</span>
            <span class="s2">&quot;b*--&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dimensional_times</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;bulk salinity [g/kg]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;depth [m]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">BULK_SALT_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;bulk_salt</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">dimensional_temperature</span> <span class="o">=</span> <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_temperature</span><span class="p">(</span>
            <span class="n">state</span><span class="o">.</span><span class="n">temperature</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">dimensional_temperature</span><span class="p">,</span>
            <span class="n">dimensional_grid</span><span class="p">,</span>
            <span class="s2">&quot;r*--&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dimensional_times</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;temperature [deg C]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;depth [m]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">TEMPERATURE_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;temperature</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">state</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">,</span>
            <span class="n">dimensional_grid</span><span class="p">,</span>
            <span class="s2">&quot;m*--&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dimensional_times</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;solid fraction&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;depth [m]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">SOLID_FRAC_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;solid_fraction</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
        <span class="n">dimensional_bulk_air</span> <span class="o">=</span> <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_bulk_gas</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">gas</span><span class="p">)</span>
        <span class="n">argon_micromole_per_liter</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">scales</span><span class="o">.</span><span class="n">convert_dimensional_bulk_air_to_argon_content</span><span class="p">(</span><span class="n">dimensional_bulk_air</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">argon_micromole_per_liter</span><span class="p">,</span>
            <span class="n">dimensional_grid</span><span class="p">,</span>
            <span class="s2">&quot;m*--&quot;</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">dimensional_times</span><span class="p">[</span><span class="n">n</span><span class="p">]</span><span class="si">:</span><span class="s2">.0f</span><span class="si">}</span><span class="s2"> days&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;bulk argon [micromole/L]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;depth [m]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">BULK_AIR_DIR</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;bulk_air</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">converter</span><span class="p">,</span> <span class="n">unit</span><span class="p">,</span> <span class="n">attr</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
        <span class="p">[</span>
            <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_temperature</span><span class="p">,</span>
            <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_bulk_salinity</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
            <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_bulk_gas</span><span class="p">,</span>
        <span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;[deg C]&quot;</span><span class="p">,</span> <span class="s2">&quot;[g/kg]&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;[kg/m3]&quot;</span><span class="p">],</span>
        <span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="s2">&quot;salt&quot;</span><span class="p">,</span> <span class="s2">&quot;gas_fraction&quot;</span><span class="p">,</span> <span class="s2">&quot;solid_fraction&quot;</span><span class="p">,</span> <span class="s2">&quot;bulk_gas&quot;</span><span class="p">],</span>
    <span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span>
            <span class="n">dimensional_times</span><span class="p">,</span> <span class="n">dimensional_grid</span><span class="p">,</span> <span class="n">converter</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">attr</span><span class="p">))</span>
        <span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;time [days]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;depth [m]&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">data_directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;contours_</span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">.pdf&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.forcing" class="doc doc-heading">
            <code>forcing</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="seaice3p.forcing.boundary_conditions" class="doc doc-heading">
            <code>boundary_conditions</code>


</h3>

    <div class="doc doc-contents ">

        <p>Module to provide functions to add boundary conditions to each quantity on the
centered grid that needs to be on the ghost grid for the upwind scheme.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.boundary_conditions._dissolved_gas_BCs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_dissolved_gas_BCs</span><span class="p">(</span><span class="n">dissolved_gas_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Add ghost cells with BCs to center quantity</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_dissolved_gas_BCs</span><span class="p">(</span><span class="n">dissolved_gas_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ghost cells with BCs to center quantity&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span>
        <span class="n">dissolved_gas_centers</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">ocean_forcing_config</span><span class="o">.</span><span class="n">ocean_gas_sat</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mi">1</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.boundary_conditions._enthalpy_BCs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_enthalpy_BCs</span><span class="p">(</span><span class="n">enthalpy_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">,</span> <span class="n">bottom_temperature</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Add ghost cells with BCs to center quantity</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_enthalpy_BCs</span><span class="p">(</span><span class="n">enthalpy_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">bottom_temperature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ghost cells with BCs to center quantity&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span>
        <span class="n">enthalpy_centers</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bottom_temperature</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">enthalpy_centers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.boundary_conditions._gas_BCs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_gas_BCs</span><span class="p">(</span><span class="n">gas_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Add ghost cells with BCs to center quantity</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_gas_BCs</span><span class="p">(</span><span class="n">gas_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ghost cells with BCs to center quantity&quot;&quot;&quot;</span>
    <span class="n">chi</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">expansion_coefficient</span>
    <span class="n">far_gas_sat</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ocean_forcing_config</span><span class="o">.</span><span class="n">ocean_gas_sat</span>
    <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span><span class="n">gas_centers</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">chi</span> <span class="o">*</span> <span class="n">far_gas_sat</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">chi</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.boundary_conditions._gas_fraction_BCs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_gas_fraction_BCs</span><span class="p">(</span><span class="n">gas_fraction_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Add ghost cells with BCs to center quantity</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_gas_fraction_BCs</span><span class="p">(</span><span class="n">gas_fraction_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ghost cells with BCs to center quantity&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="p">,</span> <span class="n">OilInitialConditions</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span>
            <span class="n">gas_fraction_centers</span><span class="p">,</span>
            <span class="n">bottom</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">initial_oil_volume_fraction</span><span class="p">,</span>
            <span class="n">top</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span>
            <span class="n">gas_fraction_centers</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">gas_fraction_centers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">top</span><span class="o">=</span><span class="mi">0</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.boundary_conditions._liquid_fraction_BCs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_liquid_fraction_BCs</span><span class="p">(</span><span class="n">liquid_fraction_centers</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Add ghost cells to liquid fraction such that top and bottom boundaries take the
same value as the top and bottom cell center</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_liquid_fraction_BCs</span><span class="p">(</span><span class="n">liquid_fraction_centers</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ghost cells to liquid fraction such that top and bottom boundaries take the</span>
<span class="sd">    same value as the top and bottom cell center&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span>
        <span class="n">liquid_fraction_centers</span><span class="p">,</span>
        <span class="n">bottom</span><span class="o">=</span><span class="n">liquid_fraction_centers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">top</span><span class="o">=</span><span class="n">liquid_fraction_centers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.boundary_conditions._liquid_salinity_BCs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_liquid_salinity_BCs</span><span class="p">(</span><span class="n">liquid_salinity_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Add ghost cells with BCs to center quantity</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_liquid_salinity_BCs</span><span class="p">(</span><span class="n">liquid_salinity_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ghost cells with BCs to center quantity&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span>
        <span class="n">liquid_salinity_centers</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">liquid_salinity_centers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.boundary_conditions._salt_BCs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_salt_BCs</span><span class="p">(</span><span class="n">salt_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Add ghost cells with BCs to center quantity</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_salt_BCs</span><span class="p">(</span><span class="n">salt_centers</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ghost cells with BCs to center quantity&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span><span class="n">salt_centers</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">salt_centers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.boundary_conditions._temperature_BCs" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_temperature_BCs</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Add ghost cells with BCs to center quantity</p>
<p>Note this needs the current time as well as top temperature is forced.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/boundary_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_temperature_BCs</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">StateFull</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add ghost cells with BCs to center quantity</span>

<span class="sd">    Note this needs the current time as well as top temperature is forced.&quot;&quot;&quot;</span>
    <span class="n">far_temp</span> <span class="o">=</span> <span class="n">get_bottom_temperature_forcing</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
    <span class="n">top_temp</span> <span class="o">=</span> <span class="n">get_temperature_forcing</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">add_ghost_cells</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">temperature</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">far_temp</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="n">top_temp</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.forcing.radiative_forcing" class="doc doc-heading">
            <code>radiative_forcing</code>


</h3>

    <div class="doc doc-contents ">

        <p>Module for providing surface radiative forcing to simulation.</p>
<p>Currently only total surface shortwave irradiance (integrated over entire shortwave
part of the spectrum) is provided and this is used to calculate internal radiative
heating.</p>
<p>Unlike temperature forcing this provides dimensional forcing</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.radiative_forcing._constant_LW_forcing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_constant_LW_forcing</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns constant surface longwave downwelling irradiance in W/m2 integrated
over the entire longwave spectrum</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/radiative_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_constant_LW_forcing</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns constant surface longwave downwelling irradiance in W/m2 integrated</span>
<span class="sd">    over the entire longwave spectrum</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">LW_forcing</span><span class="o">.</span><span class="n">LW_irradiance</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.radiative_forcing._constant_SW_forcing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_constant_SW_forcing</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns constant surface shortwave downwelling irradiance in W/m2 integrated
over the entire shortwave spectrum</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/radiative_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_constant_SW_forcing</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns constant surface shortwave downwelling irradiance in W/m2 integrated</span>
<span class="sd">    over the entire shortwave spectrum</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">SW_forcing</span><span class="o">.</span><span class="n">SW_irradiance</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.forcing.surface_energy_balance" class="doc doc-heading">
            <code>surface_energy_balance</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="seaice3p.forcing.surface_energy_balance.surface_energy_balance" class="doc doc-heading">
            <code>surface_energy_balance</code>


</h4>

    <div class="doc doc-contents ">

        <p>Module to compute the surface heat flux from geophysical energy balance</p>
<p>following [1]</p>
<p>Refs:
[1] P. D. Taylor and D. L. Feltham, ‘A model of melt pond evolution on sea ice’,
J. Geophys. Res., vol. 109, no. C12, p. 2004JC002361, Dec. 2004,
doi: 10.1029/2004JC002361.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.surface_energy_balance._calculate_total_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_total_heat_flux</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">,</span> <span class="n">temp_gradient</span><span class="p">,</span> <span class="n">top_cell_conductivity</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Takes non-dimensional surface temperature and returns non-dimensional heat flux</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/surface_energy_balance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_total_heat_flux</span><span class="p">(</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span>
    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">top_cell_is_ice</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
    <span class="n">surface_temp</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">temp_gradient</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">top_cell_conductivity</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Takes non-dimensional surface temperature and returns non-dimensional heat flux&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">ERA5Forcing</span><span class="p">):</span>
        <span class="n">dimensional_temperature_gradient</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">temperature_difference</span> <span class="o">*</span> <span class="n">temp_gradient</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">lengthscale</span>
        <span class="p">)</span>
        <span class="n">surface_temp_K</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">_convert_non_dim_temperature_to_kelvin</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span><span class="n">top_cell_conductivity</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">snow_conductivity_ratio</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">get_snow_depth</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">dimensional_temperature_gradient</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">surface_temp_K</span> <span class="o">=</span> <span class="n">_convert_non_dim_temperature_to_kelvin</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">)</span>
    <span class="n">emissivity</span> <span class="o">=</span> <span class="n">_calculate_emissivity</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">)</span>
    <span class="n">dimensional_heat_flux</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">get_LW_forcing</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
        <span class="o">-</span> <span class="n">emissivity</span> <span class="o">*</span> <span class="n">STEFAN_BOLTZMANN</span> <span class="o">*</span> <span class="n">surface_temp_K</span><span class="o">**</span><span class="mi">4</span>
        <span class="o">+</span> <span class="n">calculate_sensible_heat_flux</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">,</span> <span class="n">surface_temp_K</span><span class="p">)</span>
        <span class="o">+</span> <span class="n">calculate_latent_heat_flux</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">,</span> <span class="n">surface_temp_K</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_from_dimensional_heat_flux</span><span class="p">(</span><span class="n">dimensional_heat_flux</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.surface_energy_balance.find_ghost_cell_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">find_ghost_cell_temperature</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Returns non dimensional ghost cell temperature such that surface heat flux
is the sum of incoming LW, outgoing LW, sensible and latent heat fluxes.
The SW heat flux is determined in the radiative heating term.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/surface_energy_balance.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">find_ghost_cell_temperature</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">StateFull</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns non dimensional ghost cell temperature such that surface heat flux</span>
<span class="sd">    is the sum of incoming LW, outgoing LW, sensible and latent heat fluxes.</span>
<span class="sd">    The SW heat flux is determined in the radiative heating term.&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">state</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">top_cell_is_ice</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">top_cell_is_ice</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">residual</span><span class="p">(</span><span class="n">ghost_cell_temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">surface_temperature</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">ghost_cell_temperature</span> <span class="o">+</span> <span class="n">state</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">temp_gradient</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">step</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">ghost_cell_temperature</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">conductivity</span> <span class="o">=</span> <span class="n">calculate_conductivity</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">conductivity</span> <span class="o">*</span> <span class="n">temp_gradient</span> <span class="o">-</span> <span class="n">_calculate_total_heat_flux</span><span class="p">(</span>
            <span class="n">cfg</span><span class="p">,</span>
            <span class="n">state</span><span class="o">.</span><span class="n">time</span><span class="p">,</span>
            <span class="n">top_cell_is_ice</span><span class="p">,</span>
            <span class="n">surface_temperature</span><span class="p">,</span>
            <span class="n">temp_gradient</span><span class="p">,</span>
            <span class="n">conductivity</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">initial_guess</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux" class="doc doc-heading">
            <code>turbulent_heat_flux</code>


</h4>

    <div class="doc doc-contents ">

        <p>Module to compute the turbulent atmospheric sensible and latent heat fluxes</p>
<p>All temperatures are in Kelvin in this module</p>
<p>Refs:
[1] P. D. Taylor and D. L. Feltham, ‘A model of melt pond evolution on sea ice’,
J. Geophys. Res., vol. 109, no. C12, p. 2004JC002361, Dec. 2004,
doi: 10.1029/2004JC002361.</p>
<p>[2] E. E. Ebert and J. A. Curry,
‘An intermediate one-dimensional thermodynamic sea ice model for investigating
ice-atmosphere interactions’,
Journal of Geophysical Research: Oceans, vol. 98, no. C6, pp. 10085–10109, 1993,
doi: 10.1029/93JC00656.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_bulk_transfer_coefficient" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_bulk_transfer_coefficient</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculation of bulk transfer coeff from [2]</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/turbulent_heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_bulk_transfer_coefficient</span><span class="p">(</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculation of bulk transfer coeff from [2]&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">top_cell_is_ice</span><span class="p">:</span>
        <span class="n">CT0</span> <span class="o">=</span> <span class="mf">1.3e-3</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">CT0</span> <span class="o">=</span> <span class="mf">1.0e-3</span>
    <span class="n">BPRIME</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">C</span> <span class="o">=</span> <span class="mi">1961</span> <span class="o">*</span> <span class="n">BPRIME</span> <span class="o">*</span> <span class="n">CT0</span>
    <span class="n">ref_air_temp</span> <span class="o">=</span> <span class="n">_calculate_ref_air_temp</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">ref_windspeed</span> <span class="o">=</span> <span class="n">_calculate_ref_windspeed</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">ref_height</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">ref_height</span>
    <span class="n">Richardson</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">GRAVITY</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">ref_air_temp</span> <span class="o">-</span> <span class="n">surface_temp</span><span class="p">)</span>
        <span class="o">*</span> <span class="n">ref_height</span>
        <span class="o">/</span> <span class="p">(</span><span class="n">ref_air_temp</span> <span class="o">*</span> <span class="n">ref_windspeed</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="n">Richardson</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">frac</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">BPRIME</span> <span class="o">*</span> <span class="n">Richardson</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">C</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Richardson</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">CT0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">frac</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">CT0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">BPRIME</span> <span class="o">*</span> <span class="n">Richardson</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_air_temp" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_ref_air_temp</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>return air temperature at reference level above the ice in Kelvin</p>
<p>in the configuration the air temperature is given in deg C</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/turbulent_heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_ref_air_temp</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return air temperature at reference level above the ice in Kelvin</span>

<span class="sd">    in the configuration the air temperature is given in deg C</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">RadForcing</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">air_temp</span> <span class="o">+</span> <span class="mf">273.15</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">ERA5Forcing</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">get_2m_temp</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">+</span> <span class="mf">273.15</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_atmospheric_pressure" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_ref_atmospheric_pressure</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>return atmospheric pressure at reference level above the ice in KPa</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/turbulent_heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_ref_atmospheric_pressure</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return atmospheric pressure at reference level above the ice in KPa&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">RadForcing</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">atm_pressure</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">ERA5Forcing</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">get_ATM</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_specific_humidity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_ref_specific_humidity</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>return specific humidity at reference level above the ice</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/turbulent_heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_ref_specific_humidity</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return specific humidity at reference level above the ice&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">RadForcing</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">specific_humidity</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">ERA5Forcing</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">get_spec_hum</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_ref_windspeed" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_ref_windspeed</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>return windspeed at reference level above the ice</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/turbulent_heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_ref_windspeed</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return windspeed at reference level above the ice&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">RadForcing</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">windspeed</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">ERA5Forcing</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">get_windspeed</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;No windspeed for this forcing configuration&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux._calculate_surface_specific_humidity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_surface_specific_humidity</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Following expression given in [1]</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/turbulent_heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_surface_specific_humidity</span><span class="p">(</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Following expression given in [1]&quot;&quot;&quot;</span>
    <span class="n">water_vapor_partial_pressure</span> <span class="o">=</span> <span class="mf">2.53e8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="mi">5420</span> <span class="o">/</span> <span class="n">surface_temp</span><span class="p">))</span>
    <span class="n">atm_pressure</span> <span class="o">=</span> <span class="n">_calculate_ref_atmospheric_pressure</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="mf">0.622</span>
        <span class="o">*</span> <span class="n">water_vapor_partial_pressure</span>
        <span class="o">/</span> <span class="p">(</span><span class="n">atm_pressure</span> <span class="o">-</span> <span class="mf">0.378</span> <span class="o">*</span> <span class="n">water_vapor_partial_pressure</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux.calculate_latent_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_latent_heat_flux</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate latent heat flux from [2]</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/turbulent_heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_latent_heat_flux</span><span class="p">(</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate latent heat flux from [2]&quot;&quot;&quot;</span>
    <span class="n">air_density</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">air_density</span>
    <span class="n">air_latent_heat_of_vaporisation</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">air_latent_heat_of_vaporisation</span>
    <span class="p">)</span>
    <span class="n">windspeed</span> <span class="o">=</span> <span class="n">_calculate_ref_windspeed</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">ref_specific_humidity</span> <span class="o">=</span> <span class="n">_calculate_ref_specific_humidity</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">bulk_transfer_coeff</span> <span class="o">=</span> <span class="n">_calculate_bulk_transfer_coefficient</span><span class="p">(</span>
        <span class="n">cfg</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">surface_temp</span>
    <span class="p">)</span>
    <span class="n">surface_specific_humidity</span> <span class="o">=</span> <span class="n">_calculate_surface_specific_humidity</span><span class="p">(</span>
        <span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">surface_temp</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">air_density</span>
        <span class="o">*</span> <span class="n">air_latent_heat_of_vaporisation</span>
        <span class="o">*</span> <span class="n">bulk_transfer_coeff</span>
        <span class="o">*</span> <span class="n">windspeed</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">ref_specific_humidity</span> <span class="o">-</span> <span class="n">surface_specific_humidity</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.forcing.surface_energy_balance.turbulent_heat_flux.calculate_sensible_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_sensible_heat_flux</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate sensible heat flux from [2]</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/surface_energy_balance/turbulent_heat_flux.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_sensible_heat_flux</span><span class="p">(</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">surface_temp</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate sensible heat flux from [2]&quot;&quot;&quot;</span>
    <span class="n">air_density</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">air_density</span>
    <span class="n">air_heat_capacity</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">air_heat_capacity</span>
    <span class="n">ref_air_temp</span> <span class="o">=</span> <span class="n">_calculate_ref_air_temp</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">windspeed</span> <span class="o">=</span> <span class="n">_calculate_ref_windspeed</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">)</span>
    <span class="n">bulk_transfer_coeff</span> <span class="o">=</span> <span class="n">_calculate_bulk_transfer_coefficient</span><span class="p">(</span>
        <span class="n">cfg</span><span class="p">,</span> <span class="n">top_cell_is_ice</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">surface_temp</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">air_density</span>
        <span class="o">*</span> <span class="n">air_heat_capacity</span>
        <span class="o">*</span> <span class="n">bulk_transfer_coeff</span>
        <span class="o">*</span> <span class="n">windspeed</span>
        <span class="o">*</span> <span class="p">(</span><span class="n">ref_air_temp</span> <span class="o">-</span> <span class="n">surface_temp</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.forcing.temperature_forcing" class="doc doc-heading">
            <code>temperature_forcing</code>


</h3>

    <div class="doc doc-contents ">

        <p>Module for providing surface temperature forcing to simulation.</p>
<p>Note that the barrow temperature data is read in from a file if needed by the
simulation configuration.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.temperature_forcing._Robin_forcing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_Robin_forcing</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Returns non dimensional ghost cell temperature such that surface heat flux
is given by Robin boundary condition</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/temperature_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_Robin_forcing</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">StateFull</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns non dimensional ghost cell temperature such that surface heat flux</span>
<span class="sd">    is given by Robin boundary condition&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">residual</span><span class="p">(</span><span class="n">ghost_cell_temperature</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">surface_temperature</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">ghost_cell_temperature</span> <span class="o">+</span> <span class="n">state</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">temp_gradient</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">step</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">ghost_cell_temperature</span> <span class="o">-</span> <span class="n">state</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">calculate_conductivity</span><span class="p">(</span>
            <span class="n">cfg</span><span class="p">,</span> <span class="n">state</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span> <span class="o">*</span> <span class="n">temp_gradient</span> <span class="o">-</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">biot</span> <span class="o">*</span> <span class="p">(</span>
            <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">restoring_temperature</span> <span class="o">-</span> <span class="n">surface_temperature</span>
        <span class="p">)</span>

    <span class="n">initial_guess</span> <span class="o">=</span> <span class="n">state</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">solution</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span><span class="n">residual</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">solution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.temperature_forcing._barrow_ocean_temperature_forcing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_barrow_ocean_temperature_forcing</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Take non dimensional time and return non dimensional ocean temperature at
the Barrow site in 2009.</p>
<p>For this to work you must have created the configuration cfg from dimensional
parameters as it must have the conversion scales object.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/temperature_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_barrow_ocean_temperature_forcing</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">StateFull</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take non dimensional time and return non dimensional ocean temperature at</span>
<span class="sd">    the Barrow site in 2009.</span>

<span class="sd">    For this to work you must have created the configuration cfg from dimensional</span>
<span class="sd">    parameters as it must have the conversion scales object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">time_in_days</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_time</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
    <span class="n">dimensional_temperature</span> <span class="o">=</span> <span class="n">_dimensional_barrow_ocean_temperature_forcing</span><span class="p">(</span>
        <span class="n">time_in_days</span><span class="p">,</span> <span class="n">cfg</span>
    <span class="p">)</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_from_dimensional_temperature</span><span class="p">(</span>
        <span class="n">dimensional_temperature</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">temperature</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.temperature_forcing._barrow_temperature_forcing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_barrow_temperature_forcing</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Take non dimensional time and return non dimensional air/snow/ice temperature at
the Barrow site in 2009.</p>
<p>For this to work you must have created the configuration cfg from dimensional
parameters as it must have the conversion scales object.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/temperature_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_barrow_temperature_forcing</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">StateFull</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take non dimensional time and return non dimensional air/snow/ice temperature at</span>
<span class="sd">    the Barrow site in 2009.</span>

<span class="sd">    For this to work you must have created the configuration cfg from dimensional</span>
<span class="sd">    parameters as it must have the conversion scales object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">time_in_days</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_time</span><span class="p">(</span><span class="n">state</span><span class="o">.</span><span class="n">time</span><span class="p">)</span>
    <span class="n">dimensional_temperature</span> <span class="o">=</span> <span class="n">_dimensional_barrow_temperature_forcing</span><span class="p">(</span><span class="n">time_in_days</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span>
    <span class="n">temperature</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_from_dimensional_temperature</span><span class="p">(</span>
        <span class="n">dimensional_temperature</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">temperature</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.temperature_forcing._dimensional_barrow_ocean_temperature_forcing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_dimensional_barrow_ocean_temperature_forcing</span><span class="p">(</span><span class="n">time_in_days</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Take time in days and linearly interp 2009 Barrow ocean temperature data to get
temperature in degrees Celsius.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/temperature_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_dimensional_barrow_ocean_temperature_forcing</span><span class="p">(</span>
    <span class="n">time_in_days</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take time in days and linearly interp 2009 Barrow ocean temperature data to get</span>
<span class="sd">    temperature in degrees Celsius.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ocean_forcing_config</span><span class="o">.</span><span class="n">barrow_ocean_days</span>
    <span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ocean_forcing_config</span><span class="o">.</span><span class="n">barrow_bottom_temp</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">time_in_days</span><span class="p">,</span> <span class="n">barrow_ocean_days</span><span class="p">,</span> <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.forcing.temperature_forcing._dimensional_barrow_temperature_forcing" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_dimensional_barrow_temperature_forcing</span><span class="p">(</span><span class="n">time_in_days</span><span class="p">,</span> <span class="n">cfg</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Take time in days and linearly interp 2009 Barrow air/snow/ice temperature data to get
temperature in degrees Celsius.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/forcing/temperature_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_dimensional_barrow_temperature_forcing</span><span class="p">(</span><span class="n">time_in_days</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take time in days and linearly interp 2009 Barrow air/snow/ice temperature data to get</span>
<span class="sd">    temperature in degrees Celsius.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">barrow_days</span>
    <span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">barrow_top_temp</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">time_in_days</span><span class="p">,</span> <span class="n">barrow_days</span><span class="p">,</span> <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.grids" class="doc doc-heading">
            <code>grids</code>


</h2>

    <div class="doc doc-contents ">

        <p>Module providing functions to initialise the different grids and interpolate
quantities between them.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="seaice3p.grids.Grids" class="doc doc-heading">
            <code>Grids</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Class initialised from number of grid cells to contain:</p>
<p>grid cell width, center, edge and ghost grids and difference matrices</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/grids.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Grids</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Class initialised from number of grid cells to contain:</span>

<span class="sd">    grid cell width, center, edge and ghost grids and difference matrices</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">number_of_cells</span><span class="p">:</span> <span class="nb">int</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Grid cell width&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_cells</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">centers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Center grid&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">/</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_cells</span><span class="p">)]</span>
        <span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Edge grid&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span> <span class="o">+</span> <span class="n">i</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_cells</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)])</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ghosts</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Ghost grid&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
            <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]),</span> <span class="bp">self</span><span class="o">.</span><span class="n">centers</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">step</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]))</span>
        <span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">D_e</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Difference matrix to differentiate edge grid quantities to the center grid&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_difference_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_cells</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">D_g</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Difference matrix to differentiate ghost grid quantities to the edge grid&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">get_difference_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_cells</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.grids.Grids.D_e" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">D_e</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Difference matrix to differentiate edge grid quantities to the center grid</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.grids.Grids.D_g" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">D_g</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Difference matrix to differentiate ghost grid quantities to the edge grid</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.grids.Grids.centers" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">centers</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Center grid</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.grids.Grids.edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Edge grid</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.grids.Grids.ghosts" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ghosts</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Ghost grid</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.grids.Grids.step" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">step</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Grid cell width</p>
    </div>

</div>





  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h3 id="seaice3p.grids.add_ghost_cells" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_ghost_cells</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">top</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Add specified bottom and top value to center grid</p>
<p>:param centers: numpy array on centered grid (size I).
:type centers: Numpy array
:param bottom: bottom value placed at index 0.
:type bottom: float
:param top: top value placed at index -1.
:type top: float
:return: numpy array on ghost grid (size I+2).</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/grids.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_ghost_cells</span><span class="p">(</span><span class="n">centers</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">top</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add specified bottom and top value to center grid</span>

<span class="sd">    :param centers: numpy array on centered grid (size I).</span>
<span class="sd">    :type centers: Numpy array</span>
<span class="sd">    :param bottom: bottom value placed at index 0.</span>
<span class="sd">    :type bottom: float</span>
<span class="sd">    :param top: top value placed at index -1.</span>
<span class="sd">    :type top: float</span>
<span class="sd">    :return: numpy array on ghost grid (size I+2).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">bottom</span><span class="p">]),</span> <span class="n">centers</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">top</span><span class="p">])))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.grids.average" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">average</span><span class="p">(</span><span class="n">points</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns arithmetic mean of adjacent points in an array</p>
<p>takes ghosts -&gt; edges -&gt; centers</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/grids.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">average</span><span class="p">(</span><span class="n">points</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns arithmetic mean of adjacent points in an array</span>

<span class="sd">    takes ghosts -&gt; edges -&gt; centers</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">upper</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">lower</span> <span class="o">=</span> <span class="n">points</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">upper</span> <span class="o">+</span> <span class="n">lower</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.grids.calculate_ice_ocean_boundary_depth" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">calculate_ice_ocean_boundary_depth</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Calculate the depth of the ice ocean boundary as the edge position of the
first cell from the bottom to be not completely liquid. I.e the first time the
liquid fraction goes below 1.</p>
<p>If the ice has made it to the bottom of the domain raise an error.</p>
<p>If the domain is completely liquid set h=0.</p>
<p>NOTE: depth is a positive quantity and our grid coordinate increases from -1 at the
bottom of the domain to 0 at the top.</p>
<p>:param liquid_fraction: liquid fraction on center grid
:type liquid_fraction: Numpy Array (size I)
:param edge_grid: The vertical coordinate positions of the edge grid.
:type edge_grid: Numpy Array (size I+1)
:return: positive depth value of ice ocean interface</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/grids.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">calculate_ice_ocean_boundary_depth</span><span class="p">(</span><span class="n">liquid_fraction</span><span class="p">,</span> <span class="n">edge_grid</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the depth of the ice ocean boundary as the edge position of the</span>
<span class="sd">    first cell from the bottom to be not completely liquid. I.e the first time the</span>
<span class="sd">    liquid fraction goes below 1.</span>

<span class="sd">    If the ice has made it to the bottom of the domain raise an error.</span>

<span class="sd">    If the domain is completely liquid set h=0.</span>

<span class="sd">    NOTE: depth is a positive quantity and our grid coordinate increases from -1 at the</span>
<span class="sd">    bottom of the domain to 0 at the top.</span>

<span class="sd">    :param liquid_fraction: liquid fraction on center grid</span>
<span class="sd">    :type liquid_fraction: Numpy Array (size I)</span>
<span class="sd">    :param edge_grid: The vertical coordinate positions of the edge grid.</span>
<span class="sd">    :type edge_grid: Numpy Array (size I+1)</span>
<span class="sd">    :return: positive depth value of ice ocean interface</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># locate index on center grid where liquid fraction first drops below 1</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">liquid_fraction</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span>

    <span class="c1"># if domain is completely liquid set h=0</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">liquid_fraction</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">edge_grid</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="c1"># raise error if bottom of domain freezes</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ice ocean interface has reached bottom of domain&quot;</span><span class="p">)</span>

    <span class="c1"># ice interface is at bottom edge of first frozen cell</span>
    <span class="n">depth</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">edge_grid</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">depth</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.grids.geometric" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">geometric</span><span class="p">(</span><span class="n">ghosts</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Returns geometric mean of the first dimension of an array</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/grids.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">geometric</span><span class="p">(</span><span class="n">ghosts</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns geometric mean of the first dimension of an array&quot;&quot;&quot;</span>
    <span class="n">upper_ghosts</span> <span class="o">=</span> <span class="n">ghosts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">lower_ghosts</span> <span class="o">=</span> <span class="n">ghosts</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">upper_ghosts</span> <span class="o">*</span> <span class="n">lower_ghosts</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.initial_conditions" class="doc doc-heading">
            <code>initial_conditions</code>


</h2>

    <div class="doc doc-contents ">

        <p>Module to provide initial state of bulk enthalpy, bulk salinity and bulk gas for the
simulation.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="seaice3p.initial_conditions._apply_value_in_ice_layer" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_apply_value_in_ice_layer</span><span class="p">(</span><span class="n">depth_of_ice</span><span class="p">,</span> <span class="n">ice_value</span><span class="p">,</span> <span class="n">liquid_value</span><span class="p">,</span> <span class="n">grid</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>assume that top part of domain contains mushy ice of given depth and lower part
of domain is liquid. This function returns output on the given grid where the ice
part of the domain takes one value and the liquid a different.</p>
<p>This is useful for initialising the barrow simulation where we have an initial ice
layer.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/initial_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_apply_value_in_ice_layer</span><span class="p">(</span><span class="n">depth_of_ice</span><span class="p">,</span> <span class="n">ice_value</span><span class="p">,</span> <span class="n">liquid_value</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;assume that top part of domain contains mushy ice of given depth and lower part</span>
<span class="sd">    of domain is liquid. This function returns output on the given grid where the ice</span>
<span class="sd">    part of the domain takes one value and the liquid a different.</span>

<span class="sd">    This is useful for initialising the barrow simulation where we have an initial ice</span>
<span class="sd">    layer.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">grid</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">depth_of_ice</span><span class="p">,</span> <span class="n">ice_value</span><span class="p">,</span> <span class="n">liquid_value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.initial_conditions._get_barrow_initial_conditions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_get_barrow_initial_conditions</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>initialise domain with an initial ice layer of given temperature and bulk
salinity. These values are hard coded in from Moreau paper to match barrow study.
They also assume that the initial ice layer has 1/5 the saturation amount in pure
liquid of dissolved gas to account for previous gas loss.</p>
<p>Initialise with bulk gas being (1/5) in ice and saturation in liquid.
Bulk salinity is 5.92 g/kg in ice and ocean value in liquid.
Enthalpy is calculated by inverting temperature relation in ice and ocean.
Ice temperature is given as -8.15 degC and ocean is the far value from boundary
config.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/initial_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_get_barrow_initial_conditions</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;initialise domain with an initial ice layer of given temperature and bulk</span>
<span class="sd">    salinity. These values are hard coded in from Moreau paper to match barrow study.</span>
<span class="sd">    They also assume that the initial ice layer has 1/5 the saturation amount in pure</span>
<span class="sd">    liquid of dissolved gas to account for previous gas loss.</span>

<span class="sd">    Initialise with bulk gas being (1/5) in ice and saturation in liquid.</span>
<span class="sd">    Bulk salinity is 5.92 g/kg in ice and ocean value in liquid.</span>
<span class="sd">    Enthalpy is calculated by inverting temperature relation in ice and ocean.</span>
<span class="sd">    Ice temperature is given as -8.15 degC and ocean is the far value from boundary</span>
<span class="sd">    config.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">far_gas_sat</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ocean_forcing_config</span><span class="o">.</span><span class="n">ocean_gas_sat</span>
    <span class="n">ICE_DEPTH</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_from_dimensional_grid</span><span class="p">(</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="c1"># if we are going to have brine convection ice will desalinate on its own</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="p">,</span> <span class="n">NoBrineConvection</span><span class="p">):</span>
        <span class="n">SALT_IN_ICE</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">SALT_IN_ICE</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_from_dimensional_bulk_salinity</span><span class="p">(</span><span class="mf">5.92</span><span class="p">)</span>

    <span class="n">BOTTOM_TEMP</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_from_dimensional_temperature</span><span class="p">(</span><span class="o">-</span><span class="mf">1.8</span><span class="p">)</span>
    <span class="n">BOTTOM_SALT</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">TEMP_IN_ICE</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_from_dimensional_temperature</span><span class="p">(</span><span class="o">-</span><span class="mf">8.15</span><span class="p">)</span>

    <span class="n">chi</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">expansion_coefficient</span>

    <span class="n">centers</span> <span class="o">=</span> <span class="n">Grids</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">centers</span>
    <span class="n">salt</span> <span class="o">=</span> <span class="n">_apply_value_in_ice_layer</span><span class="p">(</span>
        <span class="n">ICE_DEPTH</span><span class="p">,</span> <span class="n">ice_value</span><span class="o">=</span><span class="n">SALT_IN_ICE</span><span class="p">,</span> <span class="n">liquid_value</span><span class="o">=</span><span class="n">BOTTOM_SALT</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">centers</span>
    <span class="p">)</span>
    <span class="n">gas</span> <span class="o">=</span> <span class="n">_apply_value_in_ice_layer</span><span class="p">(</span>
        <span class="n">ICE_DEPTH</span><span class="p">,</span>
        <span class="n">ice_value</span><span class="o">=</span><span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">Barrow_initial_bulk_gas_in_ice</span> <span class="o">*</span> <span class="n">chi</span><span class="p">,</span>
        <span class="n">liquid_value</span><span class="o">=</span><span class="n">chi</span> <span class="o">*</span> <span class="n">far_gas_sat</span><span class="p">,</span>
        <span class="n">grid</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">temp</span> <span class="o">=</span> <span class="n">_apply_value_in_ice_layer</span><span class="p">(</span>
        <span class="n">ICE_DEPTH</span><span class="p">,</span> <span class="n">ice_value</span><span class="o">=</span><span class="n">TEMP_IN_ICE</span><span class="p">,</span> <span class="n">liquid_value</span><span class="o">=</span><span class="n">BOTTOM_TEMP</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">centers</span>
    <span class="p">)</span>
    <span class="n">solid_fraction_in_mush</span> <span class="o">=</span> <span class="p">(</span><span class="n">salt</span> <span class="o">+</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">temp</span> <span class="o">-</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">concentration_ratio</span>
    <span class="p">)</span>
    <span class="n">enthalpy</span> <span class="o">=</span> <span class="n">_apply_value_in_ice_layer</span><span class="p">(</span>
        <span class="n">ICE_DEPTH</span><span class="p">,</span>
        <span class="n">ice_value</span><span class="o">=</span><span class="n">temp</span> <span class="o">-</span> <span class="n">solid_fraction_in_mush</span> <span class="o">*</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">stefan_number</span><span class="p">,</span>
        <span class="n">liquid_value</span><span class="o">=</span><span class="n">temp</span><span class="p">,</span>
        <span class="n">grid</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">_pack_initial_state</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">enthalpy</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">gas</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.initial_conditions._get_oil_initial_conditions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_get_oil_initial_conditions</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>initialise domain with an initial ice layer of given temperature and bulk
salinity given by values in the configuration.</p>
<p>This is an idealised initial condition to investigate the impact of shortwave
radiative forcing on melting bare ice</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/initial_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_get_oil_initial_conditions</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;initialise domain with an initial ice layer of given temperature and bulk</span>
<span class="sd">    salinity given by values in the configuration.</span>

<span class="sd">    This is an idealised initial condition to investigate the impact of shortwave</span>
<span class="sd">    radiative forcing on melting bare ice</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">ICE_DEPTH</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">initial_ice_depth</span>

    <span class="c1"># Initialise with a constant bulk salinity in ice</span>
    <span class="n">SALT_IN_ICE</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">initial_ice_bulk_salinity</span>

    <span class="n">BOTTOM_TEMP</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">initial_ocean_temperature</span>
    <span class="n">BOTTOM_SALT</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">TEMP_IN_ICE</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">initial_ice_temperature</span>

    <span class="n">INITIAL_OIL_VOLUME_FRACTION</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">initial_oil_volume_fraction</span>
    <span class="p">)</span>

    <span class="n">centers</span> <span class="o">=</span> <span class="n">Grids</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">I</span><span class="p">)</span><span class="o">.</span><span class="n">centers</span>
    <span class="n">salt</span> <span class="o">=</span> <span class="n">_apply_value_in_ice_layer</span><span class="p">(</span>
        <span class="n">ICE_DEPTH</span><span class="p">,</span> <span class="n">ice_value</span><span class="o">=</span><span class="n">SALT_IN_ICE</span><span class="p">,</span> <span class="n">liquid_value</span><span class="o">=</span><span class="n">BOTTOM_SALT</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">centers</span>
    <span class="p">)</span>
    <span class="n">gas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
        <span class="n">centers</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">initial_oil_free_depth</span><span class="p">,</span>
        <span class="n">INITIAL_OIL_VOLUME_FRACTION</span><span class="p">,</span>
        <span class="mi">0</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">temp</span> <span class="o">=</span> <span class="n">_apply_value_in_ice_layer</span><span class="p">(</span>
        <span class="n">ICE_DEPTH</span><span class="p">,</span> <span class="n">ice_value</span><span class="o">=</span><span class="n">TEMP_IN_ICE</span><span class="p">,</span> <span class="n">liquid_value</span><span class="o">=</span><span class="n">BOTTOM_TEMP</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">centers</span>
    <span class="p">)</span>
    <span class="n">solid_fraction_in_mush</span> <span class="o">=</span> <span class="p">(</span><span class="n">salt</span> <span class="o">+</span> <span class="n">temp</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">temp</span> <span class="o">-</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">concentration_ratio</span>
    <span class="p">)</span>
    <span class="n">enthalpy</span> <span class="o">=</span> <span class="n">_apply_value_in_ice_layer</span><span class="p">(</span>
        <span class="n">ICE_DEPTH</span><span class="p">,</span>
        <span class="n">ice_value</span><span class="o">=</span><span class="n">temp</span> <span class="o">-</span> <span class="n">solid_fraction_in_mush</span> <span class="o">*</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">stefan_number</span><span class="p">,</span>
        <span class="n">liquid_value</span><span class="o">=</span><span class="n">temp</span><span class="p">,</span>
        <span class="n">grid</span><span class="o">=</span><span class="n">centers</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">_pack_initial_state</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">enthalpy</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">gas</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.initial_conditions._get_previous_simulation_final_state" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_get_previous_simulation_final_state</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate initial state from the final state of a saved simulation</p>
<p>:returns: initial solution arrays on ghost grid (enthalpy, salt, gas)</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/initial_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_get_previous_simulation_final_state</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate initial state from the final state of a saved simulation</span>

<span class="sd">    :returns: initial solution arrays on ghost grid (enthalpy, salt, gas)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">initial_conditions_config</span><span class="o">.</span><span class="n">data_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">match</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">EQMPhysicalParams</span><span class="p">():</span>
                <span class="n">enthalpy</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr_1&quot;</span><span class="p">]</span>
                <span class="n">salt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr_2&quot;</span><span class="p">]</span>
                <span class="n">bulk_gas</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr_3&quot;</span><span class="p">]</span>

                <span class="k">return</span> <span class="n">EQMState</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">enthalpy</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">salt</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bulk_gas</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">case</span> <span class="n">DISEQPhysicalParams</span><span class="p">():</span>
                <span class="n">enthalpy</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr_1&quot;</span><span class="p">]</span>
                <span class="n">salt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr_2&quot;</span><span class="p">]</span>
                <span class="n">bulk_dissolved_gas</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr_3&quot;</span><span class="p">]</span>
                <span class="n">gas_fraction</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;arr_4&quot;</span><span class="p">]</span>

                <span class="k">return</span> <span class="n">DISEQState</span><span class="p">(</span>
                    <span class="mi">0</span><span class="p">,</span>
                    <span class="n">enthalpy</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">salt</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">bulk_dissolved_gas</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">gas_fraction</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">)</span>

            <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.initial_conditions._get_uniform_initial_conditions" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_get_uniform_initial_conditions</span><span class="p">(</span><span class="n">cfg</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Generate uniform initial solution on the ghost grid</p>
<p>:returns: initial solution arrays on ghost grid (enthalpy, salt, gas)</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/initial_conditions.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_get_uniform_initial_conditions</span><span class="p">(</span><span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate uniform initial solution on the ghost grid</span>

<span class="sd">    :returns: initial solution arrays on ghost grid (enthalpy, salt, gas)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">chi</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">physical_params</span><span class="o">.</span><span class="n">expansion_coefficient</span>

    <span class="n">bottom_temp</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ocean_forcing_config</span><span class="o">.</span><span class="n">ocean_temp</span>
    <span class="n">bottom_bulk_salinity</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">bottom_dissolved_gas</span> <span class="o">=</span> <span class="n">cfg</span><span class="o">.</span><span class="n">ocean_forcing_config</span><span class="o">.</span><span class="n">ocean_gas_sat</span>
    <span class="n">bottom_bulk_gas</span> <span class="o">=</span> <span class="n">bottom_dissolved_gas</span> <span class="o">*</span> <span class="n">chi</span>

    <span class="c1"># Initialise uniform enthalpy assuming completely liquid initial domain</span>
    <span class="n">enthalpy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">((</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">I</span><span class="p">,),</span> <span class="n">bottom_temp</span><span class="p">)</span>
    <span class="n">salt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">enthalpy</span><span class="p">,</span> <span class="n">bottom_bulk_salinity</span><span class="p">)</span>
    <span class="n">gas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">enthalpy</span><span class="p">,</span> <span class="n">bottom_bulk_gas</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">_pack_initial_state</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">enthalpy</span><span class="p">,</span> <span class="n">salt</span><span class="p">,</span> <span class="n">gas</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.load" class="doc doc-heading">
            <code>load</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="seaice3p.load.DISEQResults" class="doc doc-heading">
            <code>DISEQResults</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.load._BaseResults" href="#seaice3p.load._BaseResults">_BaseResults</a></code></p>







              <details class="quote">
                <summary>Source code in <code>seaice3p/load.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DISEQResults</span><span class="p">(</span><span class="n">_BaseResults</span><span class="p">):</span>
    <span class="n">bulk_dissolved_gas</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DISEQStateFull</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">state</span> <span class="o">=</span> <span class="n">DISEQState</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">index</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">enthalpy</span><span class="p">[:,</span> <span class="n">index</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">salt</span><span class="p">[:,</span> <span class="n">index</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bulk_dissolved_gas</span><span class="p">[:,</span> <span class="n">index</span><span class="p">],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">[:,</span> <span class="n">index</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="n">enthalpy_method</span> <span class="o">=</span> <span class="n">get_enthalpy_method</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">enthalpy_method</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Dimensionless bulk gas the same as the EQM model&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bulk_dissolved_gas</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.load.DISEQResults.bulk_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bulk_gas</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Dimensionless bulk gas the same as the EQM model</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.load._BaseResults" class="doc doc-heading">
            <code>_BaseResults</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>seaice3p/load.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">_BaseResults</span><span class="p">:</span>
    <span class="n">cfg</span><span class="p">:</span> <span class="n">Config</span>
    <span class="n">dcfg</span><span class="p">:</span> <span class="kc">None</span> <span class="o">|</span> <span class="n">DimensionalParams</span>
    <span class="n">times</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">enthalpy</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">salt</span><span class="p">:</span> <span class="n">NDArray</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_state</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">))</span>

        <span class="n">boundary_conditions</span> <span class="o">=</span> <span class="n">get_boundary_conditions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">states_bcs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">boundary_conditions</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">grids</span> <span class="o">=</span> <span class="n">Grids</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">I</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StateFull</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_get_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">-</span> <span class="n">time</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_is_ice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Boolean mask True where ice is present on center grid cells at given</span>
<span class="sd">        non-dimensional time&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)]</span> <span class="o">&lt;</span> <span class="mi">1</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_top_cell_is_ice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return True if top cell is ice or False if liquid&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dates</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">datetime</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="s2">&quot;start_date&quot;</span><span class="p">):</span>
            <span class="n">days</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">time_scale</span>
            <span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="n">day</span><span class="p">)</span> <span class="o">+</span> <span class="n">start_date</span> <span class="k">for</span> <span class="n">day</span> <span class="ow">in</span> <span class="n">days</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;forcing has no start date&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">solid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_array_data</span><span class="p">(</span><span class="s2">&quot;solid_fraction&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">liquid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_array_data</span><span class="p">(</span><span class="s2">&quot;liquid_fraction&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_array_data</span><span class="p">(</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">liquid_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_array_data</span><span class="p">(</span><span class="s2">&quot;liquid_salinity&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_get_array_data</span><span class="p">(</span><span class="s2">&quot;dissolved_gas&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dimensional_meltpond_onset_time</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get meltpond onset time from start of simulation in days&quot;&quot;&quot;</span>
        <span class="n">top_liquid_fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">times_with_meltpond</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">times</span><span class="p">[</span><span class="n">top_liquid_fraction</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">times_with_meltpond</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_time</span><span class="p">(</span><span class="n">times_with_meltpond</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">oil_mass_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;in ng/g&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">convert_gas_fraction_to_oil_mass_ratio</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">gas_density</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">ice_density</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bulk_argon</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;in mircomole Ar/L&quot;&quot;&quot;</span>
        <span class="n">scales</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span>
        <span class="k">return</span> <span class="n">scales</span><span class="o">.</span><span class="n">convert_dimensional_bulk_air_to_argon_content</span><span class="p">(</span>
            <span class="n">scales</span><span class="o">.</span><span class="n">convert_to_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk_gas</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_spectral_irradiance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">oi</span><span class="o">.</span><span class="n">SixBandSpectralIrradiance</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">RadForcing</span><span class="p">)</span>
            <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">forcing_config</span><span class="p">,</span> <span class="n">ERA5Forcing</span><span class="p">)</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Simulation was not run with radiative forcing&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">run_two_stream_model</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">states_bcs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)],</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grids</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">total_albedo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Total albedo including the effect of the surface scattering layer if present,</span>
<span class="sd">        if not present then the penetration fraction is 1 and so we regain just albedo</span>
<span class="sd">        calculated from the two stream radiative transfer model&quot;&quot;&quot;</span>
        <span class="n">spec_irrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectral_irradiance</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">oi</span><span class="o">.</span><span class="n">integrate_over_SW</span><span class="p">(</span><span class="n">spec_irrad</span><span class="p">)</span><span class="o">.</span><span class="n">albedo</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">total_transmittance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Total spectrally integrated transmittance&quot;&quot;&quot;</span>
        <span class="n">spec_irrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectral_irradiance</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">oi</span><span class="o">.</span><span class="n">integrate_over_SW</span><span class="p">(</span><span class="n">spec_irrad</span><span class="p">)</span><span class="o">.</span><span class="n">transmittance</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ice_ocean_boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">liquid_fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span>

        <span class="c1"># if no ice then no boundary</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">liquid_fraction</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">is_ice_centers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">is_ice_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">is_ice_centers</span><span class="p">,</span> <span class="n">is_ice_centers</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">is_ice_edges</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ice_meltpond_boundary</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">liquid_fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span>

        <span class="c1"># if no ice then no meltpond</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">liquid_fraction</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="n">is_ice_centers</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">is_ice_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">is_ice_centers</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">is_ice_centers</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">grids</span><span class="o">.</span><span class="n">edges</span><span class="p">[</span><span class="n">is_ice_edges</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ice_thickness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">liquid_fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span>

        <span class="c1"># if no ice no thickness</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">liquid_fraction</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ice_meltpond_boundary</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ice_ocean_boundary</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">integrated_solid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)],</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">step</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">corrected_solid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adjusted so that corrected_solid_fraction + corrected_liquid_fraction + gas_fraction = 1&quot;&quot;&quot;</span>
        <span class="n">corrected_solid_fraction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">)</span>
        <span class="n">is_frozen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span> <span class="o">==</span> <span class="mi">0</span>

        <span class="n">corrected_solid_fraction</span><span class="p">[</span><span class="n">is_frozen</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">[</span><span class="n">is_frozen</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">[</span><span class="n">is_frozen</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="n">corrected_solid_fraction</span><span class="p">[</span><span class="o">~</span><span class="n">is_frozen</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_fraction</span><span class="p">[</span><span class="o">~</span><span class="n">is_frozen</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">corrected_solid_fraction</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Corrected solid fraction is negative&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">corrected_solid_fraction</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">corrected_liquid_fraction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adjusted so that corrected_solid_fraction + corrected_liquid_fraction + gas_fraction = 1&quot;&quot;&quot;</span>
        <span class="n">corrected_liquid_fraction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">)</span>
        <span class="n">is_frozen</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span> <span class="o">==</span> <span class="mi">0</span>

        <span class="n">corrected_liquid_fraction</span><span class="p">[</span><span class="n">is_frozen</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[</span><span class="n">is_frozen</span><span class="p">]</span>
        <span class="n">corrected_liquid_fraction</span><span class="p">[</span><span class="o">~</span><span class="n">is_frozen</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[</span><span class="o">~</span><span class="n">is_frozen</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span><span class="p">[</span><span class="o">~</span><span class="n">is_frozen</span><span class="p">]</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">corrected_liquid_fraction</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Corrected liquid fraction is negative&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">corrected_liquid_fraction</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dimensional_salinity_dependent_liquid_density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="n">reference_liquid_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">liquid_density</span>
        <span class="k">return</span> <span class="n">reference_liquid_density</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">1</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">haline_contraction_coefficient</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">salinity_difference</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_salinity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">dimensional_bulk_density</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">corrected_solid_fraction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">ice_density</span><span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corrected_liquid_fraction</span>
                <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensional_salinity_dependent_liquid_density</span>
            <span class="p">)</span>
            <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">gas_density</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">dimensional_ice_average_bulk_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">is_ice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">bulk_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensional_bulk_density</span><span class="p">[</span><span class="n">is_ice</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">bulk_density</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">bulk_density</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">total_bulk_gas_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;To get dimensional bulk gas in domain multiply by</span>
<span class="sd">        gas_density * lengthscale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk_gas</span><span class="p">[:,</span> <span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">ice_bulk_gas_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;To get dimensional bulk gas in ice multiply by</span>
<span class="sd">        gas_density * lengthscale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">is_ice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk_gas</span><span class="p">[</span><span class="n">is_ice</span><span class="p">,</span> <span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">surface_temp_K</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return surface temperature in K&quot;&quot;&quot;</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="n">ghost_cell_temp</span> <span class="o">=</span> <span class="n">find_ghost_cell_temperature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_convert_non_dim_temperature_to_kelvin</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">ghost_cell_temp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">])</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">sensible_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;W/m2&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">calculate_sensible_heat_flux</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_cell_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_temp_K</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">latent_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;W/m2&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">calculate_latent_heat_flux</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_cell_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_temp_K</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">emitted_LW</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;W/m2 radiated away from ice surface&quot;&quot;&quot;</span>
        <span class="n">emissivity</span> <span class="o">=</span> <span class="n">_calculate_emissivity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_cell_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">emissivity</span> <span class="o">*</span> <span class="n">STEFAN_BOLTZMANN</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_temp_K</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">net_LW</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;W/m2 net into ice&quot;&quot;&quot;</span>
        <span class="n">incident_LW</span> <span class="o">=</span> <span class="n">get_LW_forcing</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">incident_LW</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">emitted_LW</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">surface_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;W/m2 net into ice&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">net_LW</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensible_heat_flux</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_heat_flux</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.load._BaseResults.bulk_argon" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bulk_argon</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>in mircomole Ar/L</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.load._BaseResults.corrected_liquid_fraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">corrected_liquid_fraction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Adjusted so that corrected_solid_fraction + corrected_liquid_fraction + gas_fraction = 1</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.load._BaseResults.corrected_solid_fraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">corrected_solid_fraction</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Adjusted so that corrected_solid_fraction + corrected_liquid_fraction + gas_fraction = 1</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.load._BaseResults.dimensional_meltpond_onset_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">dimensional_meltpond_onset_time</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Get meltpond onset time from start of simulation in days</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.load._BaseResults.oil_mass_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">oil_mass_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>in ng/g</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults._is_ice" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Boolean mask True where ice is present on center grid cells at given
non-dimensional time</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_is_ice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Boolean mask True where ice is present on center grid cells at given</span>
<span class="sd">    non-dimensional time&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_fraction</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)]</span> <span class="o">&lt;</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults._top_cell_is_ice" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_top_cell_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return True if top cell is ice or False if liquid</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_top_cell_is_ice</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return True if top cell is ice or False if liquid&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.emitted_LW" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">emitted_LW</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>W/m2 radiated away from ice surface</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">emitted_LW</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;W/m2 radiated away from ice surface&quot;&quot;&quot;</span>
    <span class="n">emissivity</span> <span class="o">=</span> <span class="n">_calculate_emissivity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_cell_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">emissivity</span> <span class="o">*</span> <span class="n">STEFAN_BOLTZMANN</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_temp_K</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.ice_bulk_gas_content" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ice_bulk_gas_content</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>To get dimensional bulk gas in ice multiply by
gas_density * lengthscale</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">ice_bulk_gas_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To get dimensional bulk gas in ice multiply by</span>
<span class="sd">    gas_density * lengthscale</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">is_ice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk_gas</span><span class="p">[</span><span class="n">is_ice</span><span class="p">,</span> <span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.latent_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">latent_heat_flux</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>W/m2</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">latent_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;W/m2&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">calculate_latent_heat_flux</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_cell_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_temp_K</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.net_LW" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">net_LW</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>W/m2 net into ice</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">net_LW</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;W/m2 net into ice&quot;&quot;&quot;</span>
    <span class="n">incident_LW</span> <span class="o">=</span> <span class="n">get_LW_forcing</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">incident_LW</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">emitted_LW</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.sensible_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sensible_heat_flux</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>W/m2</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sensible_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;W/m2&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">calculate_sensible_heat_flux</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_cell_is_ice</span><span class="p">(</span><span class="n">time</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">surface_temp_K</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.surface_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">surface_heat_flux</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>W/m2 net into ice</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">surface_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;W/m2 net into ice&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net_LW</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sensible_heat_flux</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
        <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_heat_flux</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.surface_temp_K" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">surface_temp_K</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return surface temperature in K</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">surface_temp_K</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return surface temperature in K&quot;&quot;&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="n">ghost_cell_temp</span> <span class="o">=</span> <span class="n">find_ghost_cell_temperature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">states</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_convert_non_dim_temperature_to_kelvin</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">ghost_cell_temp</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">index</span><span class="p">])</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.total_albedo" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_albedo</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Total albedo including the effect of the surface scattering layer if present,
if not present then the penetration fraction is 1 and so we regain just albedo
calculated from the two stream radiative transfer model</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">total_albedo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Total albedo including the effect of the surface scattering layer if present,</span>
<span class="sd">    if not present then the penetration fraction is 1 and so we regain just albedo</span>
<span class="sd">    calculated from the two stream radiative transfer model&quot;&quot;&quot;</span>
    <span class="n">spec_irrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectral_irradiance</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">oi</span><span class="o">.</span><span class="n">integrate_over_SW</span><span class="p">(</span><span class="n">spec_irrad</span><span class="p">)</span><span class="o">.</span><span class="n">albedo</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.total_bulk_gas_content" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_bulk_gas_content</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>To get dimensional bulk gas in domain multiply by
gas_density * lengthscale</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">total_bulk_gas_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;To get dimensional bulk gas in domain multiply by</span>
<span class="sd">    gas_density * lengthscale</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_index</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">_integrate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bulk_gas</span><span class="p">[:,</span> <span class="n">index</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">cfg</span><span class="o">.</span><span class="n">numerical_params</span><span class="o">.</span><span class="n">step</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.load._BaseResults.total_transmittance" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_transmittance</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Total spectrally integrated transmittance</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/load.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">total_transmittance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Total spectrally integrated transmittance&quot;&quot;&quot;</span>
    <span class="n">spec_irrad</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_spectral_irradiance</span><span class="p">(</span><span class="n">time</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">oi</span><span class="o">.</span><span class="n">integrate_over_SW</span><span class="p">(</span><span class="n">spec_irrad</span><span class="p">)</span><span class="o">.</span><span class="n">transmittance</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.oil_mass" class="doc doc-heading">
            <code>oil_mass</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="seaice3p.oil_mass.convert_gas_fraction_to_oil_mass_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_gas_fraction_to_oil_mass_ratio</span><span class="p">(</span><span class="n">gas_fraction</span><span class="p">,</span> <span class="n">oil_density</span><span class="p">,</span> <span class="n">ice_density</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert gas (oil) volume fraction to oil mass ratio in ng/g</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/oil_mass.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_gas_fraction_to_oil_mass_ratio</span><span class="p">(</span>
    <span class="n">gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">oil_density</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ice_density</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert gas (oil) volume fraction to oil mass ratio in ng/g&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">gas_fraction</span> <span class="o">*</span> <span class="mf">1e9</span> <span class="o">*</span> <span class="n">oil_density</span> <span class="o">/</span> <span class="n">ice_density</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h3 id="seaice3p.oil_mass.convert_oil_mass_ratio_to_gas_fraction" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_oil_mass_ratio_to_gas_fraction</span><span class="p">(</span><span class="n">oil_mass_ratio</span><span class="p">,</span> <span class="n">oil_density</span><span class="p">,</span> <span class="n">ice_density</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Convert oil mass ratio in ng/g to gas (oil) volume fraction</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/oil_mass.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_oil_mass_ratio_to_gas_fraction</span><span class="p">(</span>
    <span class="n">oil_mass_ratio</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">oil_density</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">ice_density</span><span class="p">:</span> <span class="nb">float</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert oil mass ratio in ng/g to gas (oil) volume fraction&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">oil_mass_ratio</span> <span class="o">*</span> <span class="mf">1e-9</span> <span class="o">*</span> <span class="n">ice_density</span> <span class="o">/</span> <span class="n">oil_density</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.params" class="doc doc-heading">
            <code>params</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.BRW09InitialConditions" class="doc doc-heading">
            <code>BRW09InitialConditions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>values for bottom (ocean) boundary</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/initial_conditions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BRW09InitialConditions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;values for bottom (ocean) boundary&quot;&quot;&quot;</span>

    <span class="n">Barrow_initial_bulk_gas_in_ice</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.CubicLiquidus" class="doc doc-heading">
            <code>CubicLiquidus</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Cubic fit to liquidus to give liquidus salinity in terms of temperature</p>
<p>S = a0 + a1 T + a2 T^2 + a3 T^3</p>
<p>defaults are taken from Notz PhD thesis for fit to Assur seawater data</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/water.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CubicLiquidus</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cubic fit to liquidus to give liquidus salinity in terms of temperature</span>

<span class="sd">    S = a0 + a1 T + a2 T^2 + a3 T^3</span>

<span class="sd">    defaults are taken from Notz PhD thesis for fit to Assur seawater data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">eutectic_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">21.1</span>  <span class="c1"># deg Celsius</span>
    <span class="n">a0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2</span>
    <span class="n">a1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">21.8</span>
    <span class="n">a2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.919</span>
    <span class="n">a3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0178</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_liquidus_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a0</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span> <span class="o">*</span> <span class="n">temperature</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span> <span class="o">*</span> <span class="n">temperature</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span> <span class="o">*</span> <span class="n">temperature</span><span class="o">**</span><span class="mi">3</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_liquidus_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">salinity</span><span class="p">):</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_liquidus_salinity</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">salinity</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">temperature</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">temperature</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalBRW09OceanForcing" class="doc doc-heading">
            <code>DimensionalBRW09OceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean
fixed gas saturation state</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalBRW09OceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean</span>
<span class="sd">    fixed gas saturation state&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalConstantTurbulentFlux" class="doc doc-heading">
            <code>DimensionalConstantTurbulentFlux</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Parameters for calculating the turbulent surface sensible and latent heat
fluxes</p>
<p>NOTE: If you are running a simulation with ERA5 reanalysis forcing you must set
the ref_height=2m as this is the appropriate value for the atmospheric reanalysis
quantities</p>
<p>The windspeed given here will only be used with ERA5 forcing if the windspeed key
is set to None in the forcing_data_file_keys dictionary.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalConstantTurbulentFlux</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for calculating the turbulent surface sensible and latent heat</span>
<span class="sd">    fluxes</span>

<span class="sd">    NOTE: If you are running a simulation with ERA5 reanalysis forcing you must set</span>
<span class="sd">    the ref_height=2m as this is the appropriate value for the atmospheric reanalysis</span>
<span class="sd">    quantities</span>

<span class="sd">    The windspeed given here will only be used with ERA5 forcing if the windspeed key</span>
<span class="sd">    is set to None in the forcing_data_file_keys dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ref_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># m</span>
    <span class="n">windspeed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># m/s</span>
    <span class="n">air_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># deg C</span>
    <span class="n">specific_humidity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.6e-3</span>  <span class="c1"># kg water / kg air</span>
    <span class="n">atm_pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">101.325</span>  <span class="c1"># KPa</span>

    <span class="n">air_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.275</span>  <span class="c1"># kg/m3</span>
    <span class="n">air_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1005</span>  <span class="c1"># J/kg K</span>
    <span class="n">air_latent_heat_of_vaporisation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.501e6</span>  <span class="c1"># J/kg</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalERA5Forcing" class="doc doc-heading">
            <code>DimensionalERA5Forcing</code>


</h3>


    <div class="doc doc-contents ">


        <p>read ERA5 data from netCDF file located at data_path.</p>
<p>Simulation will take atmospheric forcings from the start date specified in the
string format YYYY-MM-DD</p>
<p>forcing_data_file_keys is a mapping of the descriptive names of the
forcing data to be provided to the simulationa and the values are the corresponding
strings giving the name of that variable in the netCDF file.
The default values are the ERA5 variable names and the SnowModel-LG snow depth name.</p>
<p>Note that if you pass "sd" for the snow depth the simulation will assume you have
provided snow depth in m of water equivalent and you must provide a snow density for
the conversion.</p>
<p>If you pass None for the snow depth the simulation will procede with no snow layer.
If you pass None for the windspeed the simulation will use the constant windspeed
defined in the turbulent flux forcing parameters.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalERA5Forcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;read ERA5 data from netCDF file located at data_path.</span>

<span class="sd">    Simulation will take atmospheric forcings from the start date specified in the</span>
<span class="sd">    string format YYYY-MM-DD</span>

<span class="sd">    forcing_data_file_keys is a mapping of the descriptive names of the</span>
<span class="sd">    forcing data to be provided to the simulationa and the values are the corresponding</span>
<span class="sd">    strings giving the name of that variable in the netCDF file.</span>
<span class="sd">    The default values are the ERA5 variable names and the SnowModel-LG snow depth name.</span>

<span class="sd">    Note that if you pass &quot;sd&quot; for the snow depth the simulation will assume you have</span>
<span class="sd">    provided snow depth in m of water equivalent and you must provide a snow density for</span>
<span class="sd">    the conversion.</span>

<span class="sd">    If you pass None for the snow depth the simulation will procede with no snow layer.</span>
<span class="sd">    If you pass None for the windspeed the simulation will use the constant windspeed</span>
<span class="sd">    defined in the turbulent flux forcing parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_path</span><span class="p">:</span> <span class="n">Path</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># YYYY-MM-DD</span>
    <span class="n">forcing_data_file_keys</span><span class="p">:</span> <span class="n">ERA5FileKeys</span> <span class="o">=</span> <span class="n">ERA5FileKeys</span><span class="p">()</span>
    <span class="n">SW_forcing</span><span class="p">:</span> <span class="n">DimensionalSWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantSWForcing</span><span class="p">()</span>
    <span class="n">LW_forcing</span><span class="p">:</span> <span class="n">DimensionalLWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantLWForcing</span><span class="p">()</span>
    <span class="n">turbulent_flux</span><span class="p">:</span> <span class="n">DimensionalTurbulentFlux</span> <span class="o">=</span> <span class="n">DimensionalConstantTurbulentFlux</span><span class="p">()</span>
    <span class="n">oil_heating</span><span class="p">:</span> <span class="n">DimensionalOilHeating</span> <span class="o">=</span> <span class="n">DimensionalBackgroundOilHeating</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalFixedHeatFluxOceanForcing" class="doc doc-heading">
            <code>DimensionalFixedHeatFluxOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Provides constant ocean heat flux at the bottom of the domain</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ocean_heat_flux</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constant heat flux at the bottom of the domain in W/m2</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalFixedHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant ocean heat flux at the bottom of the domain</span>

<span class="sd">    Args:</span>
<span class="sd">        ocean_heat_flux: The constant heat flux at the bottom of the domain in W/m2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ocean_heat_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalFixedTempOceanForcing" class="doc doc-heading">
            <code>DimensionalFixedTempOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Fixed temperature and gas saturation ocean boundary condition</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalFixedTempOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixed temperature and gas saturation ocean boundary condition&quot;&quot;&quot;</span>

    <span class="n">ocean_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalMonoBubbleParams" class="doc doc-heading">
            <code>DimensionalMonoBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="seaice3p.params.dimensional.bubble.DimensionalBaseBubbleParams">DimensionalBaseBubbleParams</span></code></p>







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalMonoBubbleParams</span><span class="p">(</span><span class="n">DimensionalBaseBubbleParams</span><span class="p">):</span>
    <span class="n">bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># bubble radius in m</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalMonoBubbleParams.bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalMonthlyHeatFluxOceanForcing" class="doc doc-heading">
            <code>DimensionalMonthlyHeatFluxOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Provides constant ocean heat flux at the bottom of the domain in each month</p>
<p>Proivde an average monthly ocean heat flux with the entries
i=0, 1, 2, 3, ...., 11
in the tuple corresponding to the months
January, February, March, April, ...., December</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>monthly_ocean_heat_flux</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of ocean heat flux values in each month in W/m2</p>
              </div>
            </td>
            <td>
                  <code>(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0)</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalMonthlyHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant ocean heat flux at the bottom of the domain in each month</span>

<span class="sd">    Proivde an average monthly ocean heat flux with the entries</span>
<span class="sd">    i=0, 1, 2, 3, ...., 11</span>
<span class="sd">    in the tuple corresponding to the months</span>
<span class="sd">    January, February, March, April, ...., December</span>

<span class="sd">    Args:</span>
<span class="sd">        monthly_ocean_heat_flux: Tuple of ocean heat flux values in each month in W/m2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">monthly_ocean_heat_flux</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalParams" class="doc doc-heading">
            <code>DimensionalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Contains all dimensional parameters needed to calculate non dimensional numbers.</p>
<p>To see the units each input should have look at the comment next to the default
value.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains all dimensional parameters needed to calculate non dimensional numbers.</span>

<span class="sd">    To see the units each input should have look at the comment next to the default</span>
<span class="sd">    value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_time_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">savefreq_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">lengthscale</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">gas_params</span><span class="p">:</span> <span class="n">DimensionalEQMGasParams</span> <span class="o">|</span> <span class="n">DimensionalDISEQGasParams</span>
    <span class="n">bubble_params</span><span class="p">:</span> <span class="n">DimensionalMonoBubbleParams</span> <span class="o">|</span> <span class="n">DimensionalPowerLawBubbleParams</span>
    <span class="n">brine_convection_params</span><span class="p">:</span> <span class="n">DimensionalRJW14Params</span> <span class="o">|</span> <span class="n">NoBrineConvection</span>
    <span class="n">forcing_config</span><span class="p">:</span> <span class="n">DimensionalRadForcing</span> <span class="o">|</span> <span class="n">DimensionalBRW09Forcing</span> <span class="o">|</span> <span class="n">DimensionalConstantForcing</span> <span class="o">|</span> <span class="n">DimensionalYearlyForcing</span> <span class="o">|</span> <span class="n">DimensionalRobinForcing</span> <span class="o">|</span> <span class="n">DimensionalERA5Forcing</span>
    <span class="n">ocean_forcing_config</span><span class="p">:</span> <span class="n">DimensionalBRW09OceanForcing</span> <span class="o">|</span> <span class="n">DimensionalFixedTempOceanForcing</span> <span class="o">|</span> <span class="n">DimensionalFixedHeatFluxOceanForcing</span> <span class="o">|</span> <span class="n">DimensionalMonthlyHeatFluxOceanForcing</span>
    <span class="n">initial_conditions_config</span><span class="p">:</span> <span class="n">DimensionalOilInitialConditions</span> <span class="o">|</span> <span class="n">UniformInitialConditions</span> <span class="o">|</span> <span class="n">BRW09InitialConditions</span> <span class="o">|</span> <span class="n">PreviousSimulation</span>

    <span class="n">water_params</span><span class="p">:</span> <span class="n">DimensionalWaterParams</span> <span class="o">=</span> <span class="n">DimensionalWaterParams</span><span class="p">()</span>
    <span class="n">numerical_params</span><span class="p">:</span> <span class="n">NumericalParams</span> <span class="o">=</span> <span class="n">NumericalParams</span><span class="p">()</span>
    <span class="n">frame_velocity_dimensional</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># velocity of frame in m/day</span>
    <span class="n">gravity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">9.81</span>  <span class="c1"># m/s2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">damkohler_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return damkohler number as ratio of thermal timescale to nucleation</span>
<span class="sd">        timescale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="p">,</span> <span class="n">DimensionalEQMGasParams</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">nucleation_timescale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the total time in non dimensional units for the simulation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_time_in_days</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">savefreq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the save frequency in non dimensional time&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">savefreq_in_days</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">frame_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the frame velocity in non dimensional units&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_velocity_dimensional</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">velocity_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">B</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the non dimensional scale for buoyant rise of gas bubbles as</span>

<span class="sd">        .. math:: \mathcal{B} = \frac{\rho_l g R_0^2 h}{3 \mu \kappa}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stokes_velocity</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">pore_radius</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_viscosity</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">velocity_scale_in_m_per_second</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">stokes_velocity</span> <span class="o">/</span> <span class="n">velocity_scale_in_m_per_second</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Rayleigh_salt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the haline Rayleigh number as</span>

<span class="sd">        .. math:: \text{Ra}_S = \frac{\rho_l g \beta \Delta S H K_0}{\kappa \mu}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">DimensionalRJW14Params</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">haline_contraction_coefficient</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">salinity_difference</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">reference_permeability</span>
                    <span class="o">/</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span>
                        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_viscosity</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">case</span> <span class="n">NoBrineConvection</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expansion_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate</span>

<span class="sd">        .. math:: \chi = \rho_l \xi_{\text{sat}} / \rho_g</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">saturation_concentration</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lewis_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the lewis number for dissolved gas, return np.inf if there is no</span>
<span class="sd">        dissolved gas diffusion.</span>

<span class="sd">        .. math:: \text{Le}_\xi = \kappa / D_\xi</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_diffusivity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_diffusivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">scales</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;return a Scales object used for converting between dimensional and non</span>
<span class="sd">        dimensional variables.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Scales</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ocean_salinity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">salinity_difference</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ice_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">saturation_concentration</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">pore_radius</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">haline_contraction_coefficient</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;save this object to a yaml file in the specified directory.</span>

<span class="sd">        The name will be the name given with _dimensional appended to distinguish it</span>
<span class="sd">        from a saved non-dimensional configuration.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dimensional.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;load this object from a yaml configuration file.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">yaml</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.B" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">B</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate the non dimensional scale for buoyant rise of gas bubbles as</p>
<p>.. math:: \mathcal{B} = \frac{\rho_l g R_0^2 h}{3 \mu \kappa}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.Rayleigh_salt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Rayleigh_salt</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the haline Rayleigh number as</p>
<p>.. math:: \text{Ra}_S = \frac{\rho_l g \beta \Delta S H K_0}{\kappa \mu}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.damkohler_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">damkohler_number</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return damkohler number as ratio of thermal timescale to nucleation
timescale</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.expansion_coefficient" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expansion_coefficient</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate</p>
<p>.. math:: \chi = \rho_l \xi_{\text{sat}} / \rho_g</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.frame_velocity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">frame_velocity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate the frame velocity in non dimensional units</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.lewis_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lewis_gas</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the lewis number for dissolved gas, return np.inf if there is no
dissolved gas diffusion.</p>
<p>.. math:: \text{Le}<em>\xi = \kappa / D</em>\xi</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.savefreq" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">savefreq</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate the save frequency in non dimensional time</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.scales" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scales</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>return a Scales object used for converting between dimensional and non
dimensional variables.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalParams.total_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_time</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate the total time in non dimensional units for the simulation</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h4 id="seaice3p.params.DimensionalParams.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>load this object from a yaml configuration file.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;load this object from a yaml configuration file.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">yaml</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.params.DimensionalParams.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>save this object to a yaml file in the specified directory.</p>
<p>The name will be the name given with _dimensional appended to distinguish it
from a saved non-dimensional configuration.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;save this object to a yaml file in the specified directory.</span>

<span class="sd">    The name will be the name given with _dimensional appended to distinguish it</span>
<span class="sd">    from a saved non-dimensional configuration.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dimensional.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalPowerLawBubbleParams" class="doc doc-heading">
            <code>DimensionalPowerLawBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="seaice3p.params.dimensional.bubble.DimensionalBaseBubbleParams">DimensionalBaseBubbleParams</span></code></p>







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalPowerLawBubbleParams</span><span class="p">(</span><span class="n">DimensionalBaseBubbleParams</span><span class="p">):</span>
    <span class="n">bubble_distribution_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">minimum_bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">maximum_bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">minimum_bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">maximum_bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">maximum_bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minimum_bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalRobinForcing" class="doc doc-heading">
            <code>DimensionalRobinForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>This forcing imposes a Robin boundary condition of the form
surface_heat_flux=heat_transfer_coefficient * (restoring_temp - surface_temp)</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalRobinForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This forcing imposes a Robin boundary condition of the form</span>
<span class="sd">    surface_heat_flux=heat_transfer_coefficient * (restoring_temp - surface_temp)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">heat_transfer_coefficient</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6.3</span>  <span class="c1"># W/m2K</span>
    <span class="n">restoring_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>  <span class="c1"># deg C</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.DimensionalWaterParams" class="doc doc-heading">
            <code>DimensionalWaterParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/water.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalWaterParams</span><span class="p">:</span>
    <span class="n">liquid_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1028</span>  <span class="c1"># kg/m3</span>
    <span class="n">ice_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">916</span>  <span class="c1"># kg/m3</span>
    <span class="n">ocean_salinity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">34</span>  <span class="c1"># g/kg</span>
    <span class="n">liquidus</span><span class="p">:</span> <span class="n">LinearLiquidus</span> <span class="o">|</span> <span class="n">CubicLiquidus</span> <span class="o">=</span> <span class="n">LinearLiquidus</span><span class="p">()</span>
    <span class="n">latent_heat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">334e3</span>  <span class="c1"># latent heat of fusion for ice in J/kg</span>
    <span class="n">liquid_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">4184</span>  <span class="c1"># J/kg degC</span>
    <span class="n">solid_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2009</span>  <span class="c1"># J/kg degC</span>
    <span class="n">liquid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.54</span>  <span class="c1"># water thermal conductivity in W/m deg C</span>
    <span class="n">solid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.22</span>  <span class="c1"># ice thermal conductivity in W/m deg C</span>
    <span class="n">snow_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.31</span>  <span class="c1"># snow thermal conductivity in W/m deg C</span>
    <span class="n">snow_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># snow density kg/m3</span>

    <span class="n">eddy_diffusivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">salt_diffusivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># molecular diffusivity of salt in water in m2/s</span>
    <span class="c1"># used to calculate Rayleigh number for convection and density contraction in liquid equation of state</span>
    <span class="n">haline_contraction_coefficient</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">7.5e-4</span>  <span class="c1"># 1/ppt</span>

    <span class="c1"># calculated from moreau et al 2014 value of kinematic viscosity for sewater 2.7e-6</span>
    <span class="c1"># dynamic liquid_viscosity = 2.7e-6 * liquid_density</span>
    <span class="n">liquid_viscosity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.78e-3</span>  <span class="c1"># dynamic liquid viscosity in Pa.s</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eutectic_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_salinity</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">get_liquidus_salinity</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_temperature</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eutectic_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_temperature</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">salinity_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate difference between eutectic salinity and typical ocean salinity</span>

<span class="sd">        .. math:: \Delta S = S_E - S_i</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ocean_freezing_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate salinity dependent freezing temperature using linear liquidus with</span>
<span class="sd">        ocean salinity</span>

<span class="sd">        .. math:: T_i = T_L(S_i) = T_E S_i / S_E</span>

<span class="sd">        or using a cubic fit for the liquidus curve</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_salinity</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">get_liquidus_temperature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">temperature_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate</span>

<span class="sd">        .. math:: \Delta T = T_i - T_E</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">concentration_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate concentration ratio as</span>

<span class="sd">        .. math:: \mathcal{C} = S_i / \Delta S</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">stefan_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate Stefan number</span>

<span class="sd">        .. math:: \text{St} = L / c_p \Delta T</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_heat</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">thermal_diffusivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return thermal diffusivity in m2/s</span>

<span class="sd">        .. math:: \kappa = \frac{k}{\rho_l c_p}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_density</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">conductivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of solid to liquid thermal conductivity</span>

<span class="sd">        .. math:: \lambda = \frac{k_s}{k_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_thermal_conductivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">specific_heat_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of solid to liquid specific heat capacities</span>

<span class="sd">        .. math:: \lambda = \frac{c_{p,s}}{c_{p,l}}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_specific_heat_capacity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eddy_diffusivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of eddy diffusivity to thermal diffusivity in</span>
<span class="sd">        the liquid phase</span>

<span class="sd">        .. math:: \lambda = \frac{\kappa_\text{turbulent}}{\kappa_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eddy_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_diffusivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">snow_conductivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of snow to liquid thermal conductivity</span>

<span class="sd">        .. math:: \lambda = \frac{k_{sn}}{k_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">snow_thermal_conductivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lewis_salt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the lewis number for salt, return np.inf if there is no salt</span>
<span class="sd">        diffusion.</span>

<span class="sd">        .. math:: \text{Le}_S = \kappa / D_s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">salt_diffusivity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salt_diffusivity</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.concentration_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">concentration_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate concentration ratio as</p>
<p>.. math:: \mathcal{C} = S_i / \Delta S</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.conductivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conductivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of solid to liquid thermal conductivity</p>
<p>.. math:: \lambda = \frac{k_s}{k_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.eddy_diffusivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eddy_diffusivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of eddy diffusivity to thermal diffusivity in
the liquid phase</p>
<p>.. math:: \lambda = \frac{\kappa_\text{turbulent}}{\kappa_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.lewis_salt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lewis_salt</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the lewis number for salt, return np.inf if there is no salt
diffusion.</p>
<p>.. math:: \text{Le}_S = \kappa / D_s</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.ocean_freezing_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ocean_freezing_temperature</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate salinity dependent freezing temperature using linear liquidus with
ocean salinity</p>
<p>.. math:: T_i = T_L(S_i) = T_E S_i / S_E</p>
<p>or using a cubic fit for the liquidus curve</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.salinity_difference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">salinity_difference</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate difference between eutectic salinity and typical ocean salinity</p>
<p>.. math:: \Delta S = S_E - S_i</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.snow_conductivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">snow_conductivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of snow to liquid thermal conductivity</p>
<p>.. math:: \lambda = \frac{k_{sn}}{k_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.specific_heat_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">specific_heat_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of solid to liquid specific heat capacities</p>
<p>.. math:: \lambda = \frac{c_{p,s}}{c_{p,l}}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.stefan_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stefan_number</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate Stefan number</p>
<p>.. math:: \text{St} = L / c_p \Delta T</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.temperature_difference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">temperature_difference</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>calculate</p>
<p>.. math:: \Delta T = T_i - T_E</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h4 id="seaice3p.params.DimensionalWaterParams.thermal_diffusivity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">thermal_diffusivity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Return thermal diffusivity in m2/s</p>
<p>.. math:: \kappa = \frac{k}{\rho_l c_p}</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.NoBrineConvection" class="doc doc-heading">
            <code>NoBrineConvection</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>No brine convection</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/convection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoBrineConvection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;No brine convection&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.NumericalParams" class="doc doc-heading">
            <code>NumericalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>parameters needed for discretisation and choice of numerical method</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/numerical.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NumericalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;parameters needed for discretisation and choice of numerical method&quot;&quot;&quot;</span>

    <span class="n">I</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">regularisation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">solver_choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;RK23&quot;</span>  <span class="c1"># scipy.integrate.solve_IVP solver choice</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">I</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="seaice3p.params.UniformInitialConditions" class="doc doc-heading">
            <code>UniformInitialConditions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>values for bottom (ocean) boundary</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/initial_conditions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UniformInitialConditions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;values for bottom (ocean) boundary&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>



<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.bubble" class="doc doc-heading">
            <code>bubble</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.bubble.BaseBubbleParams" class="doc doc-heading">
            <code>BaseBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Not to be used directly but provides parameters for bubble model in sea ice
common to other bubble parameter objects.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BaseBubbleParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Not to be used directly but provides parameters for bubble model in sea ice</span>
<span class="sd">    common to other bubble parameter objects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">B</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span>
    <span class="n">pore_throat_scaling</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.46</span>
    <span class="n">porosity_threshold</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">porosity_threshold_value</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.024</span>
    <span class="n">escape_ice_surface</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.bubble.MonoBubbleParams" class="doc doc-heading">
            <code>MonoBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.params.bubble.BaseBubbleParams" href="#seaice3p.params.bubble.BaseBubbleParams">BaseBubbleParams</a></code></p>


        <p>Parameters for population of identical spherical bubbles.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MonoBubbleParams</span><span class="p">(</span><span class="n">BaseBubbleParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for population of identical spherical bubbles.&quot;&quot;&quot;</span>

    <span class="n">bubble_radius_scaled</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.bubble.PowerLawBubbleParams" class="doc doc-heading">
            <code>PowerLawBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.params.bubble.BaseBubbleParams" href="#seaice3p.params.bubble.BaseBubbleParams">BaseBubbleParams</a></code></p>


        <p>Parameters for population of bubbles following a power law size distribution
between a minimum and maximum radius.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">PowerLawBubbleParams</span><span class="p">(</span><span class="n">BaseBubbleParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for population of bubbles following a power law size distribution</span>
<span class="sd">    between a minimum and maximum radius.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bubble_distribution_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">minimum_bubble_radius_scaled</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>
    <span class="n">maximum_bubble_radius_scaled</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.convection" class="doc doc-heading">
            <code>convection</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.convection.RJW14Params" class="doc doc-heading">
            <code>RJW14Params</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Parameters for the RJW14 parameterisation of brine convection</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/convection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RJW14Params</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for the RJW14 parameterisation of brine convection&quot;&quot;&quot;</span>

    <span class="n">Rayleigh_salt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">44105</span>
    <span class="n">Rayleigh_critical</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.9</span>
    <span class="n">convection_strength</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.13</span>
    <span class="n">couple_bubble_to_horizontal_flow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">couple_bubble_to_vertical_flow</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">advective_heat_flux_in_ocean</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.convert" class="doc doc-heading">
            <code>convert</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.convert.Scales" class="doc doc-heading">
            <code>Scales</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Scales</span><span class="p">:</span>
    <span class="n">lengthscale</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># domain height in m</span>
    <span class="n">thermal_diffusivity</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># m2/s</span>
    <span class="n">liquid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># W/m deg C</span>
    <span class="n">ocean_salinity</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># g/kg</span>
    <span class="n">salinity_difference</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># g/kg</span>
    <span class="n">ocean_freezing_temperature</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># deg C</span>
    <span class="n">temperature_difference</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># deg C</span>
    <span class="n">gas_density</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># kg/m3</span>
    <span class="n">liquid_density</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># kg/m3</span>
    <span class="n">ice_density</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># kg/m3</span>
    <span class="n">saturation_concentration</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># kg(gas)/kg(liquid)</span>
    <span class="n">pore_radius</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># m</span>
    <span class="n">haline_contraction_coefficient</span><span class="p">:</span> <span class="nb">float</span>  <span class="c1"># 1/ppt</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">time_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;in days&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">SECONDS_TO_DAYS</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_diffusivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">velocity_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;in m /day&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_temperature</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise temperature in deg C&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;get temperature in deg C from non dimensional temperature&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_grid</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise domain depths in meters&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dimensional_grid</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get domain depths in meters from non dimensional values&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span> <span class="o">*</span> <span class="n">grid</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise time in days&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dimensional_time</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert non dimensional time into time in days since start of simulation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span> <span class="o">*</span> <span class="n">time</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_bulk_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_salinity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise bulk salinity in g/kg&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_bulk_salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_bulk_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_salinity</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert non dimensional bulk salinity to g/kg&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span> <span class="o">*</span> <span class="n">bulk_salinity</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Non dimensionalise bulk gas content in kg/m3&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dimensional_bulk_gas</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert dimensionless bulk gas content to kg/m3&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span> <span class="o">*</span> <span class="n">bulk_gas</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_dimensional_bulk_air_to_argon_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Convert kg/m3 of air to micromole of Argon per Liter of ice&quot;&quot;&quot;</span>
        <span class="n">mass_ratio_of_argon_in_air</span> <span class="o">=</span> <span class="mf">0.01288</span>
        <span class="n">micromoles_of_argon_in_a_kilogram_of_argon</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.9948e-8</span><span class="p">)</span>
        <span class="n">liters_in_a_meter_cubed</span> <span class="o">=</span> <span class="mf">1e3</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_bulk_gas</span>
            <span class="o">*</span> <span class="n">mass_ratio_of_argon_in_air</span>
            <span class="o">*</span> <span class="n">micromoles_of_argon_in_a_kilogram_of_argon</span>
            <span class="o">/</span> <span class="n">liters_in_a_meter_cubed</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_dissolved_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from dissolved gas in kg(gas)/kg(liquid) to dimensionless&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">dimensional_dissolved_gas</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dissolved_gas</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from non dimensional dissolved gas to dimensional dissolved gas in</span>
<span class="sd">        kg(gas)/kg(liquid)&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span> <span class="o">*</span> <span class="n">dissolved_gas</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_heating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_heating</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from heating rate in W/m3 to dimensionless units&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_heating</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_heat_flux</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from heat flux in W/m2 to dimensionless units&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">dimensional_heat_flux</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
            <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heat_flux</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;convert from dimensionless heat flux to heat flux in W/m2&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="n">heat_flux</span>
            <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="seaice3p.params.convert.Scales.time_scale" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">time_scale</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>in days</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="seaice3p.params.convert.Scales.velocity_scale" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">velocity_scale</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>in m /day</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_dimensional_bulk_air_to_argon_content" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_dimensional_bulk_air_to_argon_content</span><span class="p">(</span><span class="n">dimensional_bulk_gas</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Convert kg/m3 of air to micromole of Argon per Liter of ice</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_dimensional_bulk_air_to_argon_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert kg/m3 of air to micromole of Argon per Liter of ice&quot;&quot;&quot;</span>
    <span class="n">mass_ratio_of_argon_in_air</span> <span class="o">=</span> <span class="mf">0.01288</span>
    <span class="n">micromoles_of_argon_in_a_kilogram_of_argon</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mf">3.9948e-8</span><span class="p">)</span>
    <span class="n">liters_in_a_meter_cubed</span> <span class="o">=</span> <span class="mf">1e3</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_bulk_gas</span>
        <span class="o">*</span> <span class="n">mass_ratio_of_argon_in_air</span>
        <span class="o">*</span> <span class="n">micromoles_of_argon_in_a_kilogram_of_argon</span>
        <span class="o">/</span> <span class="n">liters_in_a_meter_cubed</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_from_dimensional_bulk_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_bulk_gas</span><span class="p">(</span><span class="n">dimensional_bulk_gas</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Non dimensionalise bulk gas content in kg/m3</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise bulk gas content in kg/m3&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dimensional_bulk_gas</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_from_dimensional_bulk_salinity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_bulk_salinity</span><span class="p">(</span><span class="n">dimensional_bulk_salinity</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Non dimensionalise bulk salinity in g/kg</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_bulk_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_bulk_salinity</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise bulk salinity in g/kg&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_bulk_salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>
    <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_from_dimensional_dissolved_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_dissolved_gas</span><span class="p">(</span><span class="n">dimensional_dissolved_gas</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>convert from dissolved gas in kg(gas)/kg(liquid) to dimensionless</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_dissolved_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from dissolved gas in kg(gas)/kg(liquid) to dimensionless&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dimensional_dissolved_gas</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_from_dimensional_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_grid</span><span class="p">(</span><span class="n">dimensional_grid</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Non dimensionalise domain depths in meters</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_grid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise domain depths in meters&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dimensional_grid</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_from_dimensional_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_heat_flux</span><span class="p">(</span><span class="n">dimensional_heat_flux</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>convert from heat flux in W/m2 to dimensionless units</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_heat_flux</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from heat flux in W/m2 to dimensionless units&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_heat_flux</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
        <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_from_dimensional_heating" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_heating</span><span class="p">(</span><span class="n">dimensional_heating</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>convert from heating rate in W/m3 to dimensionless units</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_heating</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_heating</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from heating rate in W/m3 to dimensionless units&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_heating</span>
        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span>
        <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_from_dimensional_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_temperature</span><span class="p">(</span><span class="n">dimensional_temperature</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Non dimensionalise temperature in deg C</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_temperature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise temperature in deg C&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">dimensional_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span>
    <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_from_dimensional_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_from_dimensional_time</span><span class="p">(</span><span class="n">dimensional_time</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Non dimensionalise time in days</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_from_dimensional_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dimensional_time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Non dimensionalise time in days&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">dimensional_time</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_to_dimensional_bulk_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_bulk_gas</span><span class="p">(</span><span class="n">bulk_gas</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Convert dimensionless bulk gas content to kg/m3</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_bulk_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert dimensionless bulk gas content to kg/m3&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_density</span> <span class="o">*</span> <span class="n">bulk_gas</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_to_dimensional_bulk_salinity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_bulk_salinity</span><span class="p">(</span><span class="n">bulk_salinity</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Convert non dimensional bulk salinity to g/kg</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_bulk_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bulk_salinity</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert non dimensional bulk salinity to g/kg&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span> <span class="o">*</span> <span class="n">bulk_salinity</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_to_dimensional_dissolved_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_dissolved_gas</span><span class="p">(</span><span class="n">dissolved_gas</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>convert from non dimensional dissolved gas to dimensional dissolved gas in
kg(gas)/kg(liquid)</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_dissolved_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dissolved_gas</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from non dimensional dissolved gas to dimensional dissolved gas in</span>
<span class="sd">    kg(gas)/kg(liquid)&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">saturation_concentration</span> <span class="o">*</span> <span class="n">dissolved_gas</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_to_dimensional_grid" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_grid</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Get domain depths in meters from non dimensional values</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get domain depths in meters from non dimensional values&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span> <span class="o">*</span> <span class="n">grid</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_to_dimensional_heat_flux" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_heat_flux</span><span class="p">(</span><span class="n">heat_flux</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>convert from dimensionless heat flux to heat flux in W/m2</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">heat_flux</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;convert from dimensionless heat flux to heat flux in W/m2&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">heat_flux</span>
        <span class="o">*</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">)</span>
        <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_to_dimensional_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_temperature</span><span class="p">(</span><span class="n">temperature</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>get temperature in deg C from non dimensional temperature</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;get temperature in deg C from non dimensional temperature&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span> <span class="o">*</span> <span class="n">temperature</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.convert.Scales.convert_to_dimensional_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">convert_to_dimensional_time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Convert non dimensional time into time in days since start of simulation</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/convert.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">convert_to_dimensional_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert non dimensional time into time in days since start of simulation&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_scale</span> <span class="o">*</span> <span class="n">time</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.dimensional" class="doc doc-heading">
            <code>dimensional</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h4 id="seaice3p.params.dimensional.bubble" class="doc doc-heading">
            <code>bubble</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.bubble.DimensionalMonoBubbleParams" class="doc doc-heading">
            <code>DimensionalMonoBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="seaice3p.params.dimensional.bubble.DimensionalBaseBubbleParams">DimensionalBaseBubbleParams</span></code></p>







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalMonoBubbleParams</span><span class="p">(</span><span class="n">DimensionalBaseBubbleParams</span><span class="p">):</span>
    <span class="n">bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>  <span class="c1"># bubble radius in m</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.bubble.DimensionalMonoBubbleParams.bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams" class="doc doc-heading">
            <code>DimensionalPowerLawBubbleParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="seaice3p.params.dimensional.bubble.DimensionalBaseBubbleParams">DimensionalBaseBubbleParams</span></code></p>







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/bubble.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalPowerLawBubbleParams</span><span class="p">(</span><span class="n">DimensionalBaseBubbleParams</span><span class="p">):</span>
    <span class="n">bubble_distribution_power</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.5</span>
    <span class="n">minimum_bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">maximum_bubble_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-3</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">minimum_bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">minimum_bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">maximum_bubble_radius_scaled</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the bubble radius divided by the pore scale</span>

<span class="sd">        .. math:: \Lambda = R_B / R_0</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">maximum_bubble_radius</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">pore_radius</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams.maximum_bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">maximum_bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.bubble.DimensionalPowerLawBubbleParams.minimum_bubble_radius_scaled" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">minimum_bubble_radius_scaled</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate the bubble radius divided by the pore scale</p>
<p>.. math:: \Lambda = R_B / R_0</p>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.params.dimensional.convection" class="doc doc-heading">
            <code>convection</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.convection.NoBrineConvection" class="doc doc-heading">
            <code>NoBrineConvection</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>No brine convection</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/convection.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NoBrineConvection</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;No brine convection&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.params.dimensional.dimensional" class="doc doc-heading">
            <code>dimensional</code>


</h4>

    <div class="doc doc-contents ">

        <p>Dimensional parameters required to run a simulation and convert output
to dimensional variables.</p>
<p>The DimensionalParams class contains all the dimensional parameters needed to produce
a simulation configuration.</p>
<p>The Scales class contains all the dimensional parameters required to convert simulation
output between physical and non-dimensional variables.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.dimensional.DimensionalParams" class="doc doc-heading">
            <code>DimensionalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>Contains all dimensional parameters needed to calculate non dimensional numbers.</p>
<p>To see the units each input should have look at the comment next to the default
value.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains all dimensional parameters needed to calculate non dimensional numbers.</span>

<span class="sd">    To see the units each input should have look at the comment next to the default</span>
<span class="sd">    value.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_time_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">savefreq_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">lengthscale</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">gas_params</span><span class="p">:</span> <span class="n">DimensionalEQMGasParams</span> <span class="o">|</span> <span class="n">DimensionalDISEQGasParams</span>
    <span class="n">bubble_params</span><span class="p">:</span> <span class="n">DimensionalMonoBubbleParams</span> <span class="o">|</span> <span class="n">DimensionalPowerLawBubbleParams</span>
    <span class="n">brine_convection_params</span><span class="p">:</span> <span class="n">DimensionalRJW14Params</span> <span class="o">|</span> <span class="n">NoBrineConvection</span>
    <span class="n">forcing_config</span><span class="p">:</span> <span class="n">DimensionalRadForcing</span> <span class="o">|</span> <span class="n">DimensionalBRW09Forcing</span> <span class="o">|</span> <span class="n">DimensionalConstantForcing</span> <span class="o">|</span> <span class="n">DimensionalYearlyForcing</span> <span class="o">|</span> <span class="n">DimensionalRobinForcing</span> <span class="o">|</span> <span class="n">DimensionalERA5Forcing</span>
    <span class="n">ocean_forcing_config</span><span class="p">:</span> <span class="n">DimensionalBRW09OceanForcing</span> <span class="o">|</span> <span class="n">DimensionalFixedTempOceanForcing</span> <span class="o">|</span> <span class="n">DimensionalFixedHeatFluxOceanForcing</span> <span class="o">|</span> <span class="n">DimensionalMonthlyHeatFluxOceanForcing</span>
    <span class="n">initial_conditions_config</span><span class="p">:</span> <span class="n">DimensionalOilInitialConditions</span> <span class="o">|</span> <span class="n">UniformInitialConditions</span> <span class="o">|</span> <span class="n">BRW09InitialConditions</span> <span class="o">|</span> <span class="n">PreviousSimulation</span>

    <span class="n">water_params</span><span class="p">:</span> <span class="n">DimensionalWaterParams</span> <span class="o">=</span> <span class="n">DimensionalWaterParams</span><span class="p">()</span>
    <span class="n">numerical_params</span><span class="p">:</span> <span class="n">NumericalParams</span> <span class="o">=</span> <span class="n">NumericalParams</span><span class="p">()</span>
    <span class="n">frame_velocity_dimensional</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># velocity of frame in m/day</span>
    <span class="n">gravity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">9.81</span>  <span class="c1"># m/s2</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">damkohler_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return damkohler number as ratio of thermal timescale to nucleation</span>
<span class="sd">        timescale</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="p">,</span> <span class="n">DimensionalEQMGasParams</span><span class="p">):</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span>
        <span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">nucleation_timescale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">total_time</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the total time in non dimensional units for the simulation&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_time_in_days</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">savefreq</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the save frequency in non dimensional time&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">savefreq_in_days</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">time_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">frame_velocity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate the frame velocity in non dimensional units&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">frame_velocity_dimensional</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scales</span><span class="o">.</span><span class="n">velocity_scale</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">B</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate the non dimensional scale for buoyant rise of gas bubbles as</span>

<span class="sd">        .. math:: \mathcal{B} = \frac{\rho_l g R_0^2 h}{3 \mu \kappa}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">stokes_velocity</span> <span class="o">=</span> <span class="p">(</span>
            <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span><span class="p">)</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">pore_radius</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">/</span> <span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_viscosity</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">velocity_scale_in_m_per_second</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">stokes_velocity</span> <span class="o">/</span> <span class="n">velocity_scale_in_m_per_second</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">Rayleigh_salt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the haline Rayleigh number as</span>

<span class="sd">        .. math:: \text{Ra}_S = \frac{\rho_l g \beta \Delta S H K_0}{\kappa \mu}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">match</span> <span class="bp">self</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">DimensionalRJW14Params</span><span class="p">():</span>
                <span class="k">return</span> <span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gravity</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">haline_contraction_coefficient</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">salinity_difference</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span>
                    <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">brine_convection_params</span><span class="o">.</span><span class="n">reference_permeability</span>
                    <span class="o">/</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span>
                        <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_viscosity</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="k">case</span> <span class="n">NoBrineConvection</span><span class="p">():</span>
                <span class="k">return</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">expansion_coefficient</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate</span>

<span class="sd">        .. math:: \chi = \rho_l \xi_{\text{sat}} / \rho_g</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">saturation_concentration</span>
            <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lewis_gas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the lewis number for dissolved gas, return np.inf if there is no</span>
<span class="sd">        dissolved gas diffusion.</span>

<span class="sd">        .. math:: \text{Le}_\xi = \kappa / D_\xi</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_diffusivity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_diffusivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">scales</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;return a Scales object used for converting between dimensional and non</span>
<span class="sd">        dimensional variables.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Scales</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lengthscale</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">thermal_diffusivity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ocean_salinity</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">salinity_difference</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">temperature_difference</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">gas_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">liquid_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">ice_density</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gas_params</span><span class="o">.</span><span class="n">saturation_concentration</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bubble_params</span><span class="o">.</span><span class="n">pore_radius</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">water_params</span><span class="o">.</span><span class="n">haline_contraction_coefficient</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;save this object to a yaml file in the specified directory.</span>

<span class="sd">        The name will be the name given with _dimensional appended to distinguish it</span>
<span class="sd">        from a saved non-dimensional configuration.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dimensional.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;load this object from a yaml configuration file.&quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">yaml</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.B" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">B</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate the non dimensional scale for buoyant rise of gas bubbles as</p>
<p>.. math:: \mathcal{B} = \frac{\rho_l g R_0^2 h}{3 \mu \kappa}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.Rayleigh_salt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">Rayleigh_salt</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Calculate the haline Rayleigh number as</p>
<p>.. math:: \text{Ra}_S = \frac{\rho_l g \beta \Delta S H K_0}{\kappa \mu}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.damkohler_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">damkohler_number</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Return damkohler number as ratio of thermal timescale to nucleation
timescale</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.expansion_coefficient" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expansion_coefficient</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate</p>
<p>.. math:: \chi = \rho_l \xi_{\text{sat}} / \rho_g</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.frame_velocity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">frame_velocity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate the frame velocity in non dimensional units</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.lewis_gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lewis_gas</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Calculate the lewis number for dissolved gas, return np.inf if there is no
dissolved gas diffusion.</p>
<p>.. math:: \text{Le}<em>\xi = \kappa / D</em>\xi</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.savefreq" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">savefreq</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate the save frequency in non dimensional time</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.scales" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">scales</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>return a Scales object used for converting between dimensional and non
dimensional variables.</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.total_time" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">total_time</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate the total time in non dimensional units for the simulation</p>
    </div>

</div>



<div class="doc doc-object doc-function">


<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.load" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>load this object from a yaml configuration file.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;load this object from a yaml configuration file.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
        <span class="n">yaml</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="seaice3p.params.dimensional.dimensional.DimensionalParams.save" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">save</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>save this object to a yaml file in the specified directory.</p>
<p>The name will be the name given with _dimensional appended to distinguish it
from a saved non-dimensional configuration.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/dimensional/dimensional.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;save this object to a yaml file in the specified directory.</span>

<span class="sd">    The name will be the name given with _dimensional appended to distinguish it</span>
<span class="sd">    from a saved non-dimensional configuration.&quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">_dimensional.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
        <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.params.dimensional.forcing" class="doc doc-heading">
            <code>forcing</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.forcing.DimensionalConstantTurbulentFlux" class="doc doc-heading">
            <code>DimensionalConstantTurbulentFlux</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>Parameters for calculating the turbulent surface sensible and latent heat
fluxes</p>
<p>NOTE: If you are running a simulation with ERA5 reanalysis forcing you must set
the ref_height=2m as this is the appropriate value for the atmospheric reanalysis
quantities</p>
<p>The windspeed given here will only be used with ERA5 forcing if the windspeed key
is set to None in the forcing_data_file_keys dictionary.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalConstantTurbulentFlux</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parameters for calculating the turbulent surface sensible and latent heat</span>
<span class="sd">    fluxes</span>

<span class="sd">    NOTE: If you are running a simulation with ERA5 reanalysis forcing you must set</span>
<span class="sd">    the ref_height=2m as this is the appropriate value for the atmospheric reanalysis</span>
<span class="sd">    quantities</span>

<span class="sd">    The windspeed given here will only be used with ERA5 forcing if the windspeed key</span>
<span class="sd">    is set to None in the forcing_data_file_keys dictionary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ref_height</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">10</span>  <span class="c1"># m</span>
    <span class="n">windspeed</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># m/s</span>
    <span class="n">air_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># deg C</span>
    <span class="n">specific_humidity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">3.6e-3</span>  <span class="c1"># kg water / kg air</span>
    <span class="n">atm_pressure</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">101.325</span>  <span class="c1"># KPa</span>

    <span class="n">air_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.275</span>  <span class="c1"># kg/m3</span>
    <span class="n">air_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1005</span>  <span class="c1"># J/kg K</span>
    <span class="n">air_latent_heat_of_vaporisation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.501e6</span>  <span class="c1"># J/kg</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.forcing.DimensionalERA5Forcing" class="doc doc-heading">
            <code>DimensionalERA5Forcing</code>


</h5>


    <div class="doc doc-contents ">


        <p>read ERA5 data from netCDF file located at data_path.</p>
<p>Simulation will take atmospheric forcings from the start date specified in the
string format YYYY-MM-DD</p>
<p>forcing_data_file_keys is a mapping of the descriptive names of the
forcing data to be provided to the simulationa and the values are the corresponding
strings giving the name of that variable in the netCDF file.
The default values are the ERA5 variable names and the SnowModel-LG snow depth name.</p>
<p>Note that if you pass "sd" for the snow depth the simulation will assume you have
provided snow depth in m of water equivalent and you must provide a snow density for
the conversion.</p>
<p>If you pass None for the snow depth the simulation will procede with no snow layer.
If you pass None for the windspeed the simulation will use the constant windspeed
defined in the turbulent flux forcing parameters.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalERA5Forcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;read ERA5 data from netCDF file located at data_path.</span>

<span class="sd">    Simulation will take atmospheric forcings from the start date specified in the</span>
<span class="sd">    string format YYYY-MM-DD</span>

<span class="sd">    forcing_data_file_keys is a mapping of the descriptive names of the</span>
<span class="sd">    forcing data to be provided to the simulationa and the values are the corresponding</span>
<span class="sd">    strings giving the name of that variable in the netCDF file.</span>
<span class="sd">    The default values are the ERA5 variable names and the SnowModel-LG snow depth name.</span>

<span class="sd">    Note that if you pass &quot;sd&quot; for the snow depth the simulation will assume you have</span>
<span class="sd">    provided snow depth in m of water equivalent and you must provide a snow density for</span>
<span class="sd">    the conversion.</span>

<span class="sd">    If you pass None for the snow depth the simulation will procede with no snow layer.</span>
<span class="sd">    If you pass None for the windspeed the simulation will use the constant windspeed</span>
<span class="sd">    defined in the turbulent flux forcing parameters.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_path</span><span class="p">:</span> <span class="n">Path</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># YYYY-MM-DD</span>
    <span class="n">forcing_data_file_keys</span><span class="p">:</span> <span class="n">ERA5FileKeys</span> <span class="o">=</span> <span class="n">ERA5FileKeys</span><span class="p">()</span>
    <span class="n">SW_forcing</span><span class="p">:</span> <span class="n">DimensionalSWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantSWForcing</span><span class="p">()</span>
    <span class="n">LW_forcing</span><span class="p">:</span> <span class="n">DimensionalLWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantLWForcing</span><span class="p">()</span>
    <span class="n">turbulent_flux</span><span class="p">:</span> <span class="n">DimensionalTurbulentFlux</span> <span class="o">=</span> <span class="n">DimensionalConstantTurbulentFlux</span><span class="p">()</span>
    <span class="n">oil_heating</span><span class="p">:</span> <span class="n">DimensionalOilHeating</span> <span class="o">=</span> <span class="n">DimensionalBackgroundOilHeating</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.forcing.DimensionalRobinForcing" class="doc doc-heading">
            <code>DimensionalRobinForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>This forcing imposes a Robin boundary condition of the form
surface_heat_flux=heat_transfer_coefficient * (restoring_temp - surface_temp)</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalRobinForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This forcing imposes a Robin boundary condition of the form</span>
<span class="sd">    surface_heat_flux=heat_transfer_coefficient * (restoring_temp - surface_temp)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">heat_transfer_coefficient</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6.3</span>  <span class="c1"># W/m2K</span>
    <span class="n">restoring_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>  <span class="c1"># deg C</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.params.dimensional.initial_conditions" class="doc doc-heading">
            <code>initial_conditions</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.initial_conditions.BRW09InitialConditions" class="doc doc-heading">
            <code>BRW09InitialConditions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>values for bottom (ocean) boundary</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/initial_conditions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BRW09InitialConditions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;values for bottom (ocean) boundary&quot;&quot;&quot;</span>

    <span class="n">Barrow_initial_bulk_gas_in_ice</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">5</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.initial_conditions.UniformInitialConditions" class="doc doc-heading">
            <code>UniformInitialConditions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>values for bottom (ocean) boundary</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/initial_conditions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">UniformInitialConditions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;values for bottom (ocean) boundary&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.params.dimensional.numerical" class="doc doc-heading">
            <code>numerical</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.numerical.NumericalParams" class="doc doc-heading">
            <code>NumericalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>parameters needed for discretisation and choice of numerical method</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/numerical.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">NumericalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;parameters needed for discretisation and choice of numerical method&quot;&quot;&quot;</span>

    <span class="n">I</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">50</span>
    <span class="n">regularisation</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span>
    <span class="n">solver_choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;RK23&quot;</span>  <span class="c1"># scipy.integrate.solve_IVP solver choice</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">I</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.params.dimensional.ocean_forcing" class="doc doc-heading">
            <code>ocean_forcing</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.ocean_forcing.DimensionalBRW09OceanForcing" class="doc doc-heading">
            <code>DimensionalBRW09OceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean
fixed gas saturation state</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalBRW09OceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean</span>
<span class="sd">    fixed gas saturation state&quot;&quot;&quot;</span>

    <span class="k">pass</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.ocean_forcing.DimensionalFixedHeatFluxOceanForcing" class="doc doc-heading">
            <code>DimensionalFixedHeatFluxOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>Provides constant ocean heat flux at the bottom of the domain</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>ocean_heat_flux</code>
            </td>
            <td>
                  <code>float</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The constant heat flux at the bottom of the domain in W/m2</p>
              </div>
            </td>
            <td>
                  <code>1</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalFixedHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant ocean heat flux at the bottom of the domain</span>

<span class="sd">    Args:</span>
<span class="sd">        ocean_heat_flux: The constant heat flux at the bottom of the domain in W/m2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">ocean_heat_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.ocean_forcing.DimensionalFixedTempOceanForcing" class="doc doc-heading">
            <code>DimensionalFixedTempOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>Fixed temperature and gas saturation ocean boundary condition</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalFixedTempOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixed temperature and gas saturation ocean boundary condition&quot;&quot;&quot;</span>

    <span class="n">ocean_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.ocean_forcing.DimensionalMonthlyHeatFluxOceanForcing" class="doc doc-heading">
            <code>DimensionalMonthlyHeatFluxOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>Provides constant ocean heat flux at the bottom of the domain in each month</p>
<p>Proivde an average monthly ocean heat flux with the entries
i=0, 1, 2, 3, ...., 11
in the tuple corresponding to the months
January, February, March, April, ...., December</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>monthly_ocean_heat_flux</code>
            </td>
            <td>
                  <code><span title="typing.Tuple">Tuple</span>[float, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of ocean heat flux values in each month in W/m2</p>
              </div>
            </td>
            <td>
                  <code>(1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0)</code>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalMonthlyHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant ocean heat flux at the bottom of the domain in each month</span>

<span class="sd">    Proivde an average monthly ocean heat flux with the entries</span>
<span class="sd">    i=0, 1, 2, 3, ...., 11</span>
<span class="sd">    in the tuple corresponding to the months</span>
<span class="sd">    January, February, March, April, ...., December</span>

<span class="sd">    Args:</span>
<span class="sd">        monthly_ocean_heat_flux: Tuple of ocean heat flux values in each month in W/m2</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">monthly_ocean_heat_flux</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="seaice3p.params.dimensional.water" class="doc doc-heading">
            <code>water</code>


</h4>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.water.CubicLiquidus" class="doc doc-heading">
            <code>CubicLiquidus</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">


        <p>Cubic fit to liquidus to give liquidus salinity in terms of temperature</p>
<p>S = a0 + a1 T + a2 T^2 + a3 T^3</p>
<p>defaults are taken from Notz PhD thesis for fit to Assur seawater data</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/water.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">CubicLiquidus</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Cubic fit to liquidus to give liquidus salinity in terms of temperature</span>

<span class="sd">    S = a0 + a1 T + a2 T^2 + a3 T^3</span>

<span class="sd">    defaults are taken from Notz PhD thesis for fit to Assur seawater data</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">eutectic_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">21.1</span>  <span class="c1"># deg Celsius</span>
    <span class="n">a0</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2</span>
    <span class="n">a1</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">21.8</span>
    <span class="n">a2</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.919</span>
    <span class="n">a3</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0178</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_liquidus_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">a0</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a1</span> <span class="o">*</span> <span class="n">temperature</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a2</span> <span class="o">*</span> <span class="n">temperature</span><span class="o">**</span><span class="mi">2</span>
            <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">a3</span> <span class="o">*</span> <span class="n">temperature</span><span class="o">**</span><span class="mi">3</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_liquidus_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">salinity</span><span class="p">):</span>
        <span class="n">temperature</span> <span class="o">=</span> <span class="n">fsolve</span><span class="p">(</span>
            <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_liquidus_salinity</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">salinity</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">),</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">temperature</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">temperature</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">temperature</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h5 id="seaice3p.params.dimensional.water.DimensionalWaterParams" class="doc doc-heading">
            <code>DimensionalWaterParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">







              <details class="quote">
                <summary>Source code in <code>seaice3p/params/dimensional/water.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DimensionalWaterParams</span><span class="p">:</span>
    <span class="n">liquid_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1028</span>  <span class="c1"># kg/m3</span>
    <span class="n">ice_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">916</span>  <span class="c1"># kg/m3</span>
    <span class="n">ocean_salinity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">34</span>  <span class="c1"># g/kg</span>
    <span class="n">liquidus</span><span class="p">:</span> <span class="n">LinearLiquidus</span> <span class="o">|</span> <span class="n">CubicLiquidus</span> <span class="o">=</span> <span class="n">LinearLiquidus</span><span class="p">()</span>
    <span class="n">latent_heat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">334e3</span>  <span class="c1"># latent heat of fusion for ice in J/kg</span>
    <span class="n">liquid_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">4184</span>  <span class="c1"># J/kg degC</span>
    <span class="n">solid_specific_heat_capacity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">2009</span>  <span class="c1"># J/kg degC</span>
    <span class="n">liquid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.54</span>  <span class="c1"># water thermal conductivity in W/m deg C</span>
    <span class="n">solid_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.22</span>  <span class="c1"># ice thermal conductivity in W/m deg C</span>
    <span class="n">snow_thermal_conductivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.31</span>  <span class="c1"># snow thermal conductivity in W/m deg C</span>
    <span class="n">snow_density</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">150</span>  <span class="c1"># snow density kg/m3</span>

    <span class="n">eddy_diffusivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">salt_diffusivity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># molecular diffusivity of salt in water in m2/s</span>
    <span class="c1"># used to calculate Rayleigh number for convection and density contraction in liquid equation of state</span>
    <span class="n">haline_contraction_coefficient</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">7.5e-4</span>  <span class="c1"># 1/ppt</span>

    <span class="c1"># calculated from moreau et al 2014 value of kinematic viscosity for sewater 2.7e-6</span>
    <span class="c1"># dynamic liquid_viscosity = 2.7e-6 * liquid_density</span>
    <span class="n">liquid_viscosity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">2.78e-3</span>  <span class="c1"># dynamic liquid viscosity in Pa.s</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eutectic_salinity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_salinity</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">get_liquidus_salinity</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_temperature</span>
            <span class="p">)</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eutectic_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span>
        <span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">eutectic_temperature</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">salinity_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate difference between eutectic salinity and typical ocean salinity</span>

<span class="sd">        .. math:: \Delta S = S_E - S_i</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_salinity</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ocean_freezing_temperature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;calculate salinity dependent freezing temperature using linear liquidus with</span>
<span class="sd">        ocean salinity</span>

<span class="sd">        .. math:: T_i = T_L(S_i) = T_E S_i / S_E</span>

<span class="sd">        or using a cubic fit for the liquidus curve</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">LinearLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_salinity</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="p">,</span> <span class="n">CubicLiquidus</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquidus</span><span class="o">.</span><span class="n">get_liquidus_temperature</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span><span class="p">)</span>

        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">temperature_difference</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate</span>

<span class="sd">        .. math:: \Delta T = T_i - T_E</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_freezing_temperature</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">eutectic_temperature</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">concentration_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate concentration ratio as</span>

<span class="sd">        .. math:: \mathcal{C} = S_i / \Delta S</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ocean_salinity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salinity_difference</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">stefan_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;calculate Stefan number</span>

<span class="sd">        .. math:: \text{St} = L / c_p \Delta T</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">latent_heat</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">temperature_difference</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">thermal_diffusivity</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Return thermal diffusivity in m2/s</span>

<span class="sd">        .. math:: \kappa = \frac{k}{\rho_l c_p}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span> <span class="o">/</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">liquid_density</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>
        <span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">conductivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of solid to liquid thermal conductivity</span>

<span class="sd">        .. math:: \lambda = \frac{k_s}{k_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_thermal_conductivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">specific_heat_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of solid to liquid specific heat capacities</span>

<span class="sd">        .. math:: \lambda = \frac{c_{p,s}}{c_{p,l}}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">solid_specific_heat_capacity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_specific_heat_capacity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">eddy_diffusivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of eddy diffusivity to thermal diffusivity in</span>
<span class="sd">        the liquid phase</span>

<span class="sd">        .. math:: \lambda = \frac{\kappa_\text{turbulent}}{\kappa_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">eddy_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_diffusivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">snow_conductivity_ratio</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the ratio of snow to liquid thermal conductivity</span>

<span class="sd">        .. math:: \lambda = \frac{k_{sn}}{k_l}</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">snow_thermal_conductivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">liquid_thermal_conductivity</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">lewis_salt</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Calculate the lewis number for salt, return np.inf if there is no salt</span>
<span class="sd">        diffusion.</span>

<span class="sd">        .. math:: \text{Le}_S = \kappa / D_s</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">salt_diffusivity</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermal_diffusivity</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">salt_diffusivity</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.concentration_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">concentration_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Calculate concentration ratio as</p>
<p>.. math:: \mathcal{C} = S_i / \Delta S</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.conductivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">conductivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of solid to liquid thermal conductivity</p>
<p>.. math:: \lambda = \frac{k_s}{k_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.eddy_diffusivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">eddy_diffusivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of eddy diffusivity to thermal diffusivity in
the liquid phase</p>
<p>.. math:: \lambda = \frac{\kappa_\text{turbulent}}{\kappa_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.lewis_salt" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lewis_salt</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Calculate the lewis number for salt, return np.inf if there is no salt
diffusion.</p>
<p>.. math:: \text{Le}_S = \kappa / D_s</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.ocean_freezing_temperature" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ocean_freezing_temperature</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate salinity dependent freezing temperature using linear liquidus with
ocean salinity</p>
<p>.. math:: T_i = T_L(S_i) = T_E S_i / S_E</p>
<p>or using a cubic fit for the liquidus curve</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.salinity_difference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">salinity_difference</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate difference between eutectic salinity and typical ocean salinity</p>
<p>.. math:: \Delta S = S_E - S_i</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.snow_conductivity_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">snow_conductivity_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of snow to liquid thermal conductivity</p>
<p>.. math:: \lambda = \frac{k_{sn}}{k_l}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.specific_heat_ratio" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">specific_heat_ratio</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Calculate the ratio of solid to liquid specific heat capacities</p>
<p>.. math:: \lambda = \frac{c_{p,s}}{c_{p,l}}</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.stefan_number" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stefan_number</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate Stefan number</p>
<p>.. math:: \text{St} = L / c_p \Delta T</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.temperature_difference" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">temperature_difference</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>calculate</p>
<p>.. math:: \Delta T = T_i - T_E</p>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="seaice3p.params.dimensional.water.DimensionalWaterParams.thermal_diffusivity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">thermal_diffusivity</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Return thermal diffusivity in m2/s</p>
<p>.. math:: \kappa = \frac{k}{\rho_l c_p}</p>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.forcing" class="doc doc-heading">
            <code>forcing</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.forcing.BRW09Forcing" class="doc doc-heading">
            <code>BRW09Forcing</code>


</h4>


    <div class="doc doc-contents ">


        <p>Surface and ocean temperature data loaded from thermistor temperature record
during the Barrow 2009 field study.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BRW09Forcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Surface and ocean temperature data loaded from thermistor temperature record</span>
<span class="sd">    during the Barrow 2009 field study.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">Barrow_top_temperature_data_choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;air&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;populate class attributes with barrow dimensional air temperature</span>
<span class="sd">        and time in days (with missing values filtered out).</span>

<span class="sd">        Note the metadata explaining how to use the barrow temperature data is also</span>
<span class="sd">        in seaice3p/forcing_data. The indices corresponding to days and air temp are</span>
<span class="sd">        hard coded in as class variables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">DATA_INDICES</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;air&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
            <span class="s2">&quot;bottom_snow&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
            <span class="s2">&quot;top_ice&quot;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;forcing_data/BRW09.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">top_temp_index</span> <span class="o">=</span> <span class="n">DATA_INDICES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Barrow_top_temperature_data_choice</span><span class="p">]</span>
        <span class="n">time_index</span> <span class="o">=</span> <span class="n">DATA_INDICES</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>

        <span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">top_temp_index</span><span class="p">]</span>
        <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">time_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="p">]</span>
        <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">_filter_missing_values</span><span class="p">(</span>
            <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">barrow_days</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">barrow_top_temp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barrow_days</span> <span class="o">=</span> <span class="n">barrow_days</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.forcing.BRW09Forcing.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>populate class attributes with barrow dimensional air temperature
and time in days (with missing values filtered out).</p>
<p>Note the metadata explaining how to use the barrow temperature data is also
in seaice3p/forcing_data. The indices corresponding to days and air temp are
hard coded in as class variables.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;populate class attributes with barrow dimensional air temperature</span>
<span class="sd">    and time in days (with missing values filtered out).</span>

<span class="sd">    Note the metadata explaining how to use the barrow temperature data is also</span>
<span class="sd">    in seaice3p/forcing_data. The indices corresponding to days and air temp are</span>
<span class="sd">    hard coded in as class variables.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">DATA_INDICES</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;time&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;air&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
        <span class="s2">&quot;bottom_snow&quot;</span><span class="p">:</span> <span class="mi">18</span><span class="p">,</span>
        <span class="s2">&quot;top_ice&quot;</span><span class="p">:</span> <span class="mi">19</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;forcing_data/BRW09.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">top_temp_index</span> <span class="o">=</span> <span class="n">DATA_INDICES</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Barrow_top_temperature_data_choice</span><span class="p">]</span>
    <span class="n">time_index</span> <span class="o">=</span> <span class="n">DATA_INDICES</span><span class="p">[</span><span class="s2">&quot;time&quot;</span><span class="p">]</span>

    <span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">top_temp_index</span><span class="p">]</span>
    <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">time_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="p">]</span>
    <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">barrow_days</span> <span class="o">=</span> <span class="n">_filter_missing_values</span><span class="p">(</span>
        <span class="n">barrow_top_temp</span><span class="p">,</span> <span class="n">barrow_days</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">barrow_top_temp</span> <span class="o">=</span> <span class="n">barrow_top_temp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">barrow_days</span> <span class="o">=</span> <span class="n">barrow_days</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.forcing.ConstantForcing" class="doc doc-heading">
            <code>ConstantForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Constant temperature forcing</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ConstantForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Constant temperature forcing&quot;&quot;&quot;</span>

    <span class="n">constant_top_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.forcing.ERA5Forcing" class="doc doc-heading">
            <code>ERA5Forcing</code>


</h4>


    <div class="doc doc-contents ">


        <p>Forcing parameters for simulation forced with atmospheric variables
from reanalysis data in netCDF file located at data_path.</p>
<p>Never create this object directly but instead initialise from a dimensional
simulation configuration as we must pass it the simulation timescale to correctly
read the atmospheric variables from the netCDF file.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ERA5Forcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forcing parameters for simulation forced with atmospheric variables</span>
<span class="sd">    from reanalysis data in netCDF file located at data_path.</span>

<span class="sd">    Never create this object directly but instead initialise from a dimensional</span>
<span class="sd">    simulation configuration as we must pass it the simulation timescale to correctly</span>
<span class="sd">    read the atmospheric variables from the netCDF file.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data_path</span><span class="p">:</span> <span class="n">Path</span>
    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timescale_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">forcing_data_file_keys</span><span class="p">:</span> <span class="n">ERA5FileKeys</span> <span class="o">=</span> <span class="n">ERA5FileKeys</span><span class="p">()</span>
    <span class="n">snow_density</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">SW_forcing</span><span class="p">:</span> <span class="n">DimensionalSWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantSWForcing</span><span class="p">()</span>
    <span class="n">LW_forcing</span><span class="p">:</span> <span class="n">DimensionalLWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantLWForcing</span><span class="p">()</span>
    <span class="n">turbulent_flux</span><span class="p">:</span> <span class="n">DimensionalTurbulentFlux</span> <span class="o">=</span> <span class="n">DimensionalConstantTurbulentFlux</span><span class="p">()</span>
    <span class="n">oil_heating</span><span class="p">:</span> <span class="n">DimensionalOilHeating</span> <span class="o">=</span> <span class="n">DimensionalBackgroundOilHeating</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data_path</span><span class="p">)</span>
        <span class="n">DATES</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">time</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">DIMLESS_TIMES</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">timescale_in_days</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="p">(</span><span class="n">date</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;D&quot;</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">date</span> <span class="ow">in</span> <span class="n">DATES</span>
            <span class="p">]</span>
        <span class="p">)</span>

        <span class="c1"># convert to deg C</span>
        <span class="n">T2M</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">temperature_at_2m_in_K</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="o">-</span> <span class="mf">273.15</span>
        <span class="p">)</span>
        <span class="n">D2M</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">dewpoint_at_2m_in_K</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="o">-</span> <span class="mf">273.15</span>
        <span class="p">)</span>

        <span class="n">LW</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">longwave_radiation_in_W_m2</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
        <span class="n">SW</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">shortwave_radiation_in_W_m2</span>
        <span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="c1"># convert to KPa</span>
        <span class="n">ATM</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">surface_pressure_in_Pa</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>
            <span class="o">/</span> <span class="mf">1e3</span>
        <span class="p">)</span>

        <span class="n">wind_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">windspeed_at_2m_in_m_s</span>
        <span class="k">if</span> <span class="n">wind_key</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">WIND</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full_like</span><span class="p">(</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">turbulent_flux</span><span class="o">.</span><span class="n">windspeed</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">WIND</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">wind_key</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="c1"># Calculate specific humidity in kg/kg from dewpoint temperature</span>
        <span class="n">SPEC_HUM</span> <span class="o">=</span> <span class="n">_calculate_specific_humidity</span><span class="p">(</span><span class="n">ATM</span><span class="p">,</span> <span class="n">D2M</span><span class="p">)</span>

        <span class="n">snow_key</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forcing_data_file_keys</span><span class="o">.</span><span class="n">snow_depth_in_m</span>
        <span class="c1"># if ERA5 standard short name for snow depth in m of water equivalent use snow</span>
        <span class="c1"># density to convert to m of snow</span>
        <span class="k">if</span> <span class="n">snow_key</span> <span class="o">==</span> <span class="s2">&quot;sd&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">snow_density</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;No snow density provided&quot;</span><span class="p">)</span>
            <span class="n">SNOW_DEPTH</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s2">&quot;sd&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1000</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">snow_density</span><span class="p">)</span>

        <span class="c1"># If snow key is another name assume snow depth is just in m of snow</span>
        <span class="k">elif</span> <span class="n">snow_key</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">SNOW_DEPTH</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">snow_key</span><span class="p">)</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">()</span>

        <span class="c1"># If snow key is None assume no snow</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">SNOW_DEPTH</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">DIMLESS_TIMES</span><span class="p">)</span>

        <span class="c1"># Provide functions to interpolate forcing data at non-dimensional times</span>
        <span class="c1"># during simulation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_2m_temp</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">T2M</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_LW</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">LW</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_SW</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">SW</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_ATM</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">ATM</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_spec_hum</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">SPEC_HUM</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_snow_depth</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">SNOW_DEPTH</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_windspeed</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span> <span class="n">xp</span><span class="o">=</span><span class="n">DIMLESS_TIMES</span><span class="p">,</span> <span class="n">fp</span><span class="o">=</span><span class="n">WIND</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.forcing.RadForcing" class="doc doc-heading">
            <code>RadForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Forcing parameters for radiative transfer simulation with oil drops</p>
<p>we have not implemented the non-dimensionalisation for these parameters yet
and so we just pass the dimensional values directly to the simulation</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RadForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Forcing parameters for radiative transfer simulation with oil drops</span>

<span class="sd">    we have not implemented the non-dimensionalisation for these parameters yet</span>
<span class="sd">    and so we just pass the dimensional values directly to the simulation&quot;&quot;&quot;</span>

    <span class="n">SW_forcing</span><span class="p">:</span> <span class="n">DimensionalSWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantSWForcing</span><span class="p">()</span>
    <span class="n">LW_forcing</span><span class="p">:</span> <span class="n">DimensionalLWForcing</span> <span class="o">=</span> <span class="n">DimensionalConstantLWForcing</span><span class="p">()</span>
    <span class="n">turbulent_flux</span><span class="p">:</span> <span class="n">DimensionalTurbulentFlux</span> <span class="o">=</span> <span class="n">DimensionalConstantTurbulentFlux</span><span class="p">()</span>
    <span class="n">oil_heating</span><span class="p">:</span> <span class="n">DimensionalOilHeating</span> <span class="o">=</span> <span class="n">DimensionalBackgroundOilHeating</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.forcing.RobinForcing" class="doc doc-heading">
            <code>RobinForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Dimensionless forcing parameters for Robin boundary condition</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">RobinForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Dimensionless forcing parameters for Robin boundary condition&quot;&quot;&quot;</span>

    <span class="n">biot</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="n">restoring_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.3</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.forcing.YearlyForcing" class="doc doc-heading">
            <code>YearlyForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Yearly sinusoidal temperature forcing</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">YearlyForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Yearly sinusoidal temperature forcing&quot;&quot;&quot;</span>

    <span class="n">offset</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="n">amplitude</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.75</span>
    <span class="n">period</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="seaice3p.params.forcing._calculate_specific_humidity" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_calculate_specific_humidity</span><span class="p">(</span><span class="n">pressure</span><span class="p">,</span> <span class="n">dewpoint</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Take ERA5 data and return specific humidity at 2m in kg/kg</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_calculate_specific_humidity</span><span class="p">(</span><span class="n">pressure</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">,</span> <span class="n">dewpoint</span><span class="p">:</span> <span class="n">NDArray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take ERA5 data and return specific humidity at 2m in kg/kg&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">specific_humidity_from_dewpoint</span><span class="p">(</span>
            <span class="n">pressure</span> <span class="o">*</span> <span class="n">metpyunits</span><span class="o">.</span><span class="n">kPa</span><span class="p">,</span> <span class="n">dewpoint</span> <span class="o">*</span> <span class="n">metpyunits</span><span class="o">.</span><span class="n">degC</span>
        <span class="p">)</span>
        <span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;kg/kg&quot;</span><span class="p">)</span>
        <span class="o">.</span><span class="n">magnitude</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="seaice3p.params.forcing._filter_missing_values" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">_filter_missing_values</span><span class="p">(</span><span class="n">air_temp</span><span class="p">,</span> <span class="n">days</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Filter out missing values are recorded as 9999</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">_filter_missing_values</span><span class="p">(</span><span class="n">air_temp</span><span class="p">,</span> <span class="n">days</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Filter out missing values are recorded as 9999&quot;&quot;&quot;</span>
    <span class="n">is_missing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">air_temp</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">100</span>
    <span class="k">return</span> <span class="n">air_temp</span><span class="p">[</span><span class="o">~</span><span class="n">is_missing</span><span class="p">],</span> <span class="n">days</span><span class="p">[</span><span class="o">~</span><span class="n">is_missing</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.initial_conditions" class="doc doc-heading">
            <code>initial_conditions</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.initial_conditions.OilInitialConditions" class="doc doc-heading">
            <code>OilInitialConditions</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>values for bottom (ocean) boundary</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/initial_conditions.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">OilInitialConditions</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;values for bottom (ocean) boundary&quot;&quot;&quot;</span>

    <span class="c1"># Non dimensional parameters for summer initial conditions</span>
    <span class="n">initial_ice_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">initial_ocean_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.05</span>
    <span class="n">initial_ice_temperature</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
    <span class="n">initial_oil_volume_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-7</span>
    <span class="n">initial_ice_bulk_salinity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1</span>
    <span class="n">initial_oil_free_depth</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.ocean_forcing" class="doc doc-heading">
            <code>ocean_forcing</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.ocean_forcing.BRW09OceanForcing" class="doc doc-heading">
            <code>BRW09OceanForcing</code>


</h4>


    <div class="doc doc-contents ">


        <p>Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean
fixed gas saturation state</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BRW09OceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Ocean temperature provided by Barrow 2009 data at 2.4m and specify ocean</span>
<span class="sd">    fixed gas saturation state&quot;&quot;&quot;</span>

    <span class="n">ocean_gas_sat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;populate class attributes with barrow dimensional ocean temperature</span>
<span class="sd">        and time in days (with missing values filtered out).</span>

<span class="sd">        Note the metadata explaining how to use the barrow temperature data is also</span>
<span class="sd">        in seaice3p/forcing_data.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span>
            <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;forcing_data/BRW09.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">ocean_temp_index</span> <span class="o">=</span> <span class="mi">43</span>
        <span class="n">time_index</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ocean_temp_index</span><span class="p">]</span>
        <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">time_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="p">]</span>
        <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">_filter_missing_values</span><span class="p">(</span>
            <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">barrow_ocean_days</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">barrow_bottom_temp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">barrow_ocean_days</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="seaice3p.params.ocean_forcing.BRW09OceanForcing.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>populate class attributes with barrow dimensional ocean temperature
and time in days (with missing values filtered out).</p>
<p>Note the metadata explaining how to use the barrow temperature data is also
in seaice3p/forcing_data.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;populate class attributes with barrow dimensional ocean temperature</span>
<span class="sd">    and time in days (with missing values filtered out).</span>

<span class="sd">    Note the metadata explaining how to use the barrow temperature data is also</span>
<span class="sd">    in seaice3p/forcing_data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">genfromtxt</span><span class="p">(</span>
        <span class="n">Path</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s2">&quot;forcing_data/BRW09.txt&quot;</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
    <span class="p">)</span>
    <span class="n">ocean_temp_index</span> <span class="o">=</span> <span class="mi">43</span>
    <span class="n">time_index</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">ocean_temp_index</span><span class="p">]</span>
    <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="n">time_index</span><span class="p">]</span> <span class="o">-</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">time_index</span><span class="p">]</span>
    <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">_filter_missing_values</span><span class="p">(</span>
        <span class="n">barrow_bottom_temp</span><span class="p">,</span> <span class="n">barrow_ocean_days</span>
    <span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">barrow_bottom_temp</span> <span class="o">=</span> <span class="n">barrow_bottom_temp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">barrow_ocean_days</span> <span class="o">=</span> <span class="n">barrow_ocean_days</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.ocean_forcing.FixedHeatFluxOceanForcing" class="doc doc-heading">
            <code>FixedHeatFluxOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Provides constant dimensionless ocean heat flux at the bottom of the domain and fixed gas
saturation state.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FixedHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant dimensionless ocean heat flux at the bottom of the domain and fixed gas</span>
<span class="sd">    saturation state.&quot;&quot;&quot;</span>

    <span class="n">ocean_heat_flux</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">ocean_gas_sat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.ocean_forcing.FixedTempOceanForcing" class="doc doc-heading">
            <code>FixedTempOceanForcing</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Fixed temperature and gas saturation ocean boundary condition</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FixedTempOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fixed temperature and gas saturation ocean boundary condition&quot;&quot;&quot;</span>

    <span class="n">ocean_temp</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>
    <span class="n">ocean_gas_sat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.ocean_forcing.MonthlyHeatFluxOceanForcing" class="doc doc-heading">
            <code>MonthlyHeatFluxOceanForcing</code>


</h4>


    <div class="doc doc-contents ">


        <p>Provides constant dimensionless ocean heat flux at the bottom of the domain in
each month</p>
<p>and ocean gas saturation state.</p>
<p>Proivde an average monthly ocean heat flux with the entries
i=0, 1, 2, 3, ...., 11
in the tuple corresponding to the months
January, February, March, April, ...., December</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>monthly_ocean_heat_flux</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Tuple of dimensionless ocean heat flux values in</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/ocean_forcing.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MonthlyHeatFluxOceanForcing</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides constant dimensionless ocean heat flux at the bottom of the domain in</span>
<span class="sd">    each month</span>

<span class="sd">    and ocean gas saturation state.</span>

<span class="sd">    Proivde an average monthly ocean heat flux with the entries</span>
<span class="sd">    i=0, 1, 2, 3, ...., 11</span>
<span class="sd">    in the tuple corresponding to the months</span>
<span class="sd">    January, February, March, April, ...., December</span>

<span class="sd">    Args:</span>
<span class="sd">        monthly_ocean_heat_flux: Tuple of dimensionless ocean heat flux values in</span>
<span class="sd">        each month</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">start_date</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">timescale_in_days</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">monthly_ocean_heat_flux</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
        <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">ocean_gas_sat</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Provide functions to interpolate day of year to monthly ocean heat flux</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_interpolate_heat_flux</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">,</span>
            <span class="n">xp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">15</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">135</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">196</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">258</span><span class="p">,</span> <span class="mi">288</span><span class="p">,</span> <span class="mi">319</span><span class="p">,</span> <span class="mi">349</span><span class="p">]),</span>
            <span class="n">fp</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">monthly_ocean_heat_flux</span><span class="p">),</span>
            <span class="n">period</span><span class="o">=</span><span class="mi">365</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_ocean_heat_flux</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">simulation_time</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="n">start_datetime</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_date</span><span class="p">,</span> <span class="s2">&quot;%Y-%m-</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">current_datetime</span> <span class="o">=</span> <span class="n">start_datetime</span> <span class="o">+</span> <span class="n">timedelta</span><span class="p">(</span>
            <span class="n">days</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">timescale_in_days</span> <span class="o">*</span> <span class="n">simulation_time</span>
        <span class="p">)</span>
        <span class="n">current_day</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">current_datetime</span> <span class="o">-</span> <span class="n">datetime</span><span class="p">(</span><span class="n">start_datetime</span><span class="o">.</span><span class="n">year</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="p">)</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">()</span> <span class="o">/</span> <span class="mi">86400</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_interpolate_heat_flux</span><span class="p">(</span><span class="n">current_day</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.params" class="doc doc-heading">
            <code>params</code>


</h3>

    <div class="doc doc-contents ">

        <p>Classes containing parameters required to run a simulation</p>
<p>The config class contains all the parameters needed to run a simulation as well
as methods to save and load this configuration to a yaml file.</p>








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.params.Config" class="doc doc-heading">
            <code>Config</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>contains all information needed to run a simulation and save output</p>
<p>this config object can be saved and loaded to a yaml file.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/params.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Config</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;contains all information needed to run a simulation and save output</span>

<span class="sd">    this config object can be saved and loaded to a yaml file.&quot;&quot;&quot;</span>

    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">total_time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">savefreq</span><span class="p">:</span> <span class="nb">float</span>

    <span class="n">physical_params</span><span class="p">:</span> <span class="n">PhysicalParams</span>
    <span class="n">bubble_params</span><span class="p">:</span> <span class="n">BubbleParams</span>
    <span class="n">brine_convection_params</span><span class="p">:</span> <span class="n">BrineConvectionParams</span>
    <span class="n">forcing_config</span><span class="p">:</span> <span class="n">ForcingConfig</span>
    <span class="n">ocean_forcing_config</span><span class="p">:</span> <span class="n">OceanForcingConfig</span>
    <span class="n">initial_conditions_config</span><span class="p">:</span> <span class="n">InitialConditionsConfig</span>
    <span class="n">numerical_params</span><span class="p">:</span> <span class="n">NumericalParams</span> <span class="o">=</span> <span class="n">NumericalParams</span><span class="p">()</span>
    <span class="n">scales</span><span class="p">:</span> <span class="n">Scales</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">directory</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.yml&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">to_yaml</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">load</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">infile</span><span class="p">:</span>
            <span class="n">yaml</span> <span class="o">=</span> <span class="n">infile</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">from_yaml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">yaml</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="seaice3p.params.params.get_config" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_config</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a Config object for the simulation.</p>
<p>physical parameters and Darcy law parameters are calculated from the dimensional
input. You can modify the numerical parameters and boundary conditions and
forcing provided for the simulation.</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/params/params.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_config</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">:</span> <span class="n">DimensionalParams</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Config</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a Config object for the simulation.</span>

<span class="sd">    physical parameters and Darcy law parameters are calculated from the dimensional</span>
<span class="sd">    input. You can modify the numerical parameters and boundary conditions and</span>
<span class="sd">    forcing provided for the simulation.&quot;&quot;&quot;</span>
    <span class="n">physical_params</span> <span class="o">=</span> <span class="n">get_dimensionless_physical_params</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span>
    <span class="n">initial_conditions_config</span> <span class="o">=</span> <span class="n">get_dimensionless_initial_conditions_config</span><span class="p">(</span>
        <span class="n">dimensional_params</span>
    <span class="p">)</span>
    <span class="n">brine_convection_params</span> <span class="o">=</span> <span class="n">get_dimensionless_brine_convection_params</span><span class="p">(</span>
        <span class="n">dimensional_params</span>
    <span class="p">)</span>
    <span class="n">bubble_params</span> <span class="o">=</span> <span class="n">get_dimensionless_bubble_params</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span>
    <span class="n">forcing_config</span> <span class="o">=</span> <span class="n">get_dimensionless_forcing_config</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span>
    <span class="n">ocean_forcing_config</span> <span class="o">=</span> <span class="n">get_dimensionless_ocean_forcing_config</span><span class="p">(</span><span class="n">dimensional_params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">Config</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
        <span class="n">physical_params</span><span class="o">=</span><span class="n">physical_params</span><span class="p">,</span>
        <span class="n">initial_conditions_config</span><span class="o">=</span><span class="n">initial_conditions_config</span><span class="p">,</span>
        <span class="n">brine_convection_params</span><span class="o">=</span><span class="n">brine_convection_params</span><span class="p">,</span>
        <span class="n">bubble_params</span><span class="o">=</span><span class="n">bubble_params</span><span class="p">,</span>
        <span class="n">forcing_config</span><span class="o">=</span><span class="n">forcing_config</span><span class="p">,</span>
        <span class="n">ocean_forcing_config</span><span class="o">=</span><span class="n">ocean_forcing_config</span><span class="p">,</span>
        <span class="n">numerical_params</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">numerical_params</span><span class="p">,</span>
        <span class="n">scales</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">scales</span><span class="p">,</span>
        <span class="n">total_time</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">total_time</span><span class="p">,</span>
        <span class="n">savefreq</span><span class="o">=</span><span class="n">dimensional_params</span><span class="o">.</span><span class="n">savefreq</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.params.physical" class="doc doc-heading">
            <code>physical</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.physical.BasePhysicalParams" class="doc doc-heading">
            <code>BasePhysicalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Not to be used directly but provides the common parameters for physical params
objects</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/physical.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BasePhysicalParams</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Not to be used directly but provides the common parameters for physical params</span>
<span class="sd">    objects</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">expansion_coefficient</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.029</span>
    <span class="n">concentration_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.17</span>
    <span class="n">stefan_number</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.2</span>
    <span class="n">lewis_salt</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">lewis_gas</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
    <span class="n">frame_velocity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">specific_heat_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span>
    <span class="n">conductivity_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">4.11</span>
    <span class="n">eddy_diffusivity_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">snow_conductivity_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.574</span>

    <span class="c1"># Option to change tolerable supersaturation</span>
    <span class="n">tolerable_super_saturation_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>

    <span class="n">gas_viscosity_ratio</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">gas_bubble_eddy_diffusion</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">get_liquidus_temperature</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">get_liquidus_salinity</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Callable</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.physical.DISEQPhysicalParams" class="doc doc-heading">
            <code>DISEQPhysicalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.params.physical.BasePhysicalParams" href="#seaice3p.params.physical.BasePhysicalParams">BasePhysicalParams</a></code></p>


        <p>non dimensional numbers for the mushy layer</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/physical.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DISEQPhysicalParams</span><span class="p">(</span><span class="n">BasePhysicalParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;non dimensional numbers for the mushy layer&quot;&quot;&quot;</span>

    <span class="c1"># only used in DISEQ model</span>
    <span class="n">damkohler_number</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.params.physical.EQMPhysicalParams" class="doc doc-heading">
            <code>EQMPhysicalParams</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="seaice3p.params.physical.BasePhysicalParams" href="#seaice3p.params.physical.BasePhysicalParams">BasePhysicalParams</a></code></p>


        <p>non dimensional numbers for the mushy layer</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/params/physical.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@serde</span><span class="p">(</span><span class="n">type_check</span><span class="o">=</span><span class="n">coerce</span><span class="p">)</span>
<span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EQMPhysicalParams</span><span class="p">(</span><span class="n">BasePhysicalParams</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;non dimensional numbers for the mushy layer&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.plot" class="doc doc-heading">
            <code>plot</code>


</h2>

    <div class="doc doc-contents ">

        <p>script to visualise simulation data</p>
<p>usage:
python -m seaice3p.plot "glob pattern to find npz files" Optional[True/False]</p>
<p>assumes the simulation configurations are to be found in the same directory as the data.
If the simulation is a non-dimensional configuration file add the False option after
the glob pattern.</p>








  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.run_simulation" class="doc doc-heading">
            <code>run_simulation</code>


</h2>

    <div class="doc doc-contents ">

        <p>Module to run the simulation on the given configuration with the appropriate solver.</p>
<p>Solve reduced model using scipy solve_ivp using RK23 solver.</p>
<p>Impose a maximum timestep constraint using courant number for thermal diffusion
as this is an explicit method.</p>
<p>This solver uses adaptive timestepping which makes it a good choice for running
simulations with large buoyancy driven gas bubble velocities and we save the output
at intervals given by the savefreq parameter in configuration.</p>








  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h3 id="seaice3p.run_simulation.run_batch" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">run_batch</span><span class="p">(</span><span class="n">list_of_cfg</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">verbosity_level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span></code>

</h3>


    <div class="doc doc-contents ">

        <p>Run a batch of simulations from a list of configurations.</p>
<p>Each simulation name is logged, as well as if it successfully runs or crashes.
Output from each simulation is saved in a .npz file.</p>
<p>:param list_of_cfg: list of configurations
:type list_of_cfg: List[seaice3p.params.Config]</p>

            <details class="quote">
              <summary>Source code in <code>seaice3p/run_simulation.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">run_batch</span><span class="p">(</span><span class="n">list_of_cfg</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Config</span><span class="p">],</span> <span class="n">directory</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">verbosity_level</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Run a batch of simulations from a list of configurations.</span>

<span class="sd">    Each simulation name is logged, as well as if it successfully runs or crashes.</span>
<span class="sd">    Output from each simulation is saved in a .npz file.</span>

<span class="sd">    :param list_of_cfg: list of configurations</span>
<span class="sd">    :type list_of_cfg: List[seaice3p.params.Config]</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">optprint</span> <span class="o">=</span> <span class="n">get_printer</span><span class="p">(</span><span class="n">verbosity_level</span><span class="p">,</span> <span class="n">verbosity_threshold</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">cfg</span> <span class="ow">in</span> <span class="n">list_of_cfg</span><span class="p">:</span>
        <span class="n">optprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;seaice3pv</span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">solve</span><span class="p">(</span><span class="n">cfg</span><span class="p">,</span> <span class="n">directory</span><span class="p">,</span> <span class="n">verbosity_level</span><span class="o">=</span><span class="n">verbosity_level</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">optprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">cfg</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> crashed&quot;</span><span class="p">)</span>
            <span class="n">optprint</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="seaice3p.state" class="doc doc-heading">
            <code>state</code>


</h2>

    <div class="doc doc-contents ">








  <div class="doc doc-children">










<div class="doc doc-object doc-module">



<h3 id="seaice3p.state.disequilibrium_state" class="doc doc-heading">
            <code>disequilibrium_state</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.state.disequilibrium_state.DISEQState" class="doc doc-heading">
            <code>DISEQState</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Contains the principal variables for solution with non-equilibrium gas phase.
The total bulk gas is partitioned between dissolved gas and free phase gas with
a finite nucleation rate (non dimensional damkohler number).</p>
<p>principal solution components:
bulk enthalpy
bulk salinity
bulk dissolved gas
gas fraction</p>
<p>all on the center grid.</p>
<p>Note:
Define bulk dissolved gas for the system as</p>
<p>expansion_coefficient * liquid_fraction * dissolved_gas</p>
<p>so that this is different from the dissolved gas concentration and</p>
<p>bulk_gas = bulk_dissolved_gas + gas_fraction</p>
<p>in non-dimensional units.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/state/disequilibrium_state.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DISEQState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains the principal variables for solution with non-equilibrium gas phase.</span>
<span class="sd">    The total bulk gas is partitioned between dissolved gas and free phase gas with</span>
<span class="sd">    a finite nucleation rate (non dimensional damkohler number).</span>

<span class="sd">    principal solution components:</span>
<span class="sd">    bulk enthalpy</span>
<span class="sd">    bulk salinity</span>
<span class="sd">    bulk dissolved gas</span>
<span class="sd">    gas fraction</span>

<span class="sd">    all on the center grid.</span>

<span class="sd">    Note:</span>
<span class="sd">    Define bulk dissolved gas for the system as</span>

<span class="sd">    expansion_coefficient * liquid_fraction * dissolved_gas</span>

<span class="sd">    so that this is different from the dissolved gas concentration and</span>

<span class="sd">    bulk_gas = bulk_dissolved_gas + gas_fraction</span>

<span class="sd">    in non-dimensional units.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">enthalpy</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">salt</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">bulk_dissolved_gas</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">gas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate bulk gas content and use same attribute name as EQMState&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bulk_dissolved_gas</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="seaice3p.state.disequilibrium_state.DISEQState.gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gas</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate bulk gas content and use same attribute name as EQMState</p>
    </div>

</div>





  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.state.disequilibrium_state.DISEQStateBCs" class="doc doc-heading">
            <code>DISEQStateBCs</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Stores information needed for solution at one timestep with BCs on ghost
cells as well</p>
<p>Initialiase the prime variables for the solver:
enthalpy, bulk salinity and bulk air</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/state/disequilibrium_state.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DISEQStateBCs</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stores information needed for solution at one timestep with BCs on ghost</span>
<span class="sd">    cells as well</span>

<span class="sd">    Initialiase the prime variables for the solver:</span>
<span class="sd">    enthalpy, bulk salinity and bulk air</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">enthalpy</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">salt</span><span class="p">:</span> <span class="n">NDArray</span>

    <span class="n">temperature</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">liquid_salinity</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">dissolved_gas</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">liquid_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">bulk_dissolved_gas</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.state.disequilibrium_state.DISEQStateFull" class="doc doc-heading">
            <code>DISEQStateFull</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Contains all variables variables for solution with non-equilibrium gas phase
after running the enthalpy method on DISEQSate.
The total bulk gas is partitioned between dissolved gas and free phase gas with
a finite nucleation rate (non dimensional damkohler number).</p>
<p>principal solution components:
bulk enthalpy
bulk salinity
bulk dissolved gas
gas fraction</p>
<p>enthalpy method variables:
temperature
liquid_fraction
solid_fraction
liquid_salinity
dissolved_gas</p>
<p>all on the center grid.</p>
<p>Note:
Define bulk dissolved gas for the system as</p>
<p>expansion_coefficient * liquid_fraction * dissolved_gas</p>
<p>so that this is different from the dissolved gas concentration and</p>
<p>bulk_gas = bulk_dissolved_gas + gas_fraction</p>
<p>in non-dimensional units.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/state/disequilibrium_state.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DISEQStateFull</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains all variables variables for solution with non-equilibrium gas phase</span>
<span class="sd">    after running the enthalpy method on DISEQSate.</span>
<span class="sd">    The total bulk gas is partitioned between dissolved gas and free phase gas with</span>
<span class="sd">    a finite nucleation rate (non dimensional damkohler number).</span>

<span class="sd">    principal solution components:</span>
<span class="sd">    bulk enthalpy</span>
<span class="sd">    bulk salinity</span>
<span class="sd">    bulk dissolved gas</span>
<span class="sd">    gas fraction</span>

<span class="sd">    enthalpy method variables:</span>
<span class="sd">    temperature</span>
<span class="sd">    liquid_fraction</span>
<span class="sd">    solid_fraction</span>
<span class="sd">    liquid_salinity</span>
<span class="sd">    dissolved_gas</span>

<span class="sd">    all on the center grid.</span>

<span class="sd">    Note:</span>
<span class="sd">    Define bulk dissolved gas for the system as</span>

<span class="sd">    expansion_coefficient * liquid_fraction * dissolved_gas</span>

<span class="sd">    so that this is different from the dissolved gas concentration and</span>

<span class="sd">    bulk_gas = bulk_dissolved_gas + gas_fraction</span>

<span class="sd">    in non-dimensional units.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">enthalpy</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">salt</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">bulk_dissolved_gas</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span>

    <span class="n">temperature</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">liquid_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">solid_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">liquid_salinity</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">dissolved_gas</span><span class="p">:</span> <span class="n">NDArray</span>

    <span class="nd">@cached_property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">gas</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">NDArray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate bulk gas content and use same attribute name as EQMState&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">bulk_dissolved_gas</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">gas_fraction</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="seaice3p.state.disequilibrium_state.DISEQStateFull.gas" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">gas</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-cached"><code>cached</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Calculate bulk gas content and use same attribute name as EQMState</p>
    </div>

</div>





  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="seaice3p.state.equilibrium_state" class="doc doc-heading">
            <code>equilibrium_state</code>


</h3>

    <div class="doc doc-contents ">








  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="seaice3p.state.equilibrium_state.EQMState" class="doc doc-heading">
            <code>EQMState</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Contains the principal variables for solution with equilibrium gas phase:</p>
<p>bulk enthalpy
bulk salinity
bulk gas</p>
<p>all on the center grid.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/state/equilibrium_state.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EQMState</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains the principal variables for solution with equilibrium gas phase:</span>

<span class="sd">    bulk enthalpy</span>
<span class="sd">    bulk salinity</span>
<span class="sd">    bulk gas</span>

<span class="sd">    all on the center grid.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">enthalpy</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">salt</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.state.equilibrium_state.EQMStateBCs" class="doc doc-heading">
            <code>EQMStateBCs</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Stores information needed for solution at one timestep with BCs on ghost
cells as well</p>
<p>Initialiase the prime variables for the solver:
enthalpy, bulk salinity and bulk air</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/state/equilibrium_state.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EQMStateBCs</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Stores information needed for solution at one timestep with BCs on ghost</span>
<span class="sd">    cells as well</span>

<span class="sd">    Initialiase the prime variables for the solver:</span>
<span class="sd">    enthalpy, bulk salinity and bulk air</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">enthalpy</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">salt</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas</span><span class="p">:</span> <span class="n">NDArray</span>

    <span class="n">temperature</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">liquid_salinity</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">dissolved_gas</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">liquid_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="seaice3p.state.equilibrium_state.EQMStateFull" class="doc doc-heading">
            <code>EQMStateFull</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Contains all variables variables for solution with equilibrium gas phase
after running the enthalpy method on EQMSate.</p>
<p>principal solution components:
bulk enthalpy
bulk salinity
bulk gas</p>
<p>enthalpy method variables:
temperature
liquid_fraction
solid_fraction
liquid_salinity
dissolved_gas
gas_fraction</p>
<p>all on the center grid.</p>






              <details class="quote">
                <summary>Source code in <code>seaice3p/state/equilibrium_state.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">EQMStateFull</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Contains all variables variables for solution with equilibrium gas phase</span>
<span class="sd">    after running the enthalpy method on EQMSate.</span>

<span class="sd">    principal solution components:</span>
<span class="sd">    bulk enthalpy</span>
<span class="sd">    bulk salinity</span>
<span class="sd">    bulk gas</span>

<span class="sd">    enthalpy method variables:</span>
<span class="sd">    temperature</span>
<span class="sd">    liquid_fraction</span>
<span class="sd">    solid_fraction</span>
<span class="sd">    liquid_salinity</span>
<span class="sd">    dissolved_gas</span>
<span class="sd">    gas_fraction</span>

<span class="sd">    all on the center grid.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">time</span><span class="p">:</span> <span class="nb">float</span>
    <span class="n">enthalpy</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">salt</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas</span><span class="p">:</span> <span class="n">NDArray</span>

    <span class="n">temperature</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">liquid_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">solid_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">liquid_salinity</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">dissolved_gas</span><span class="p">:</span> <span class="n">NDArray</span>
    <span class="n">gas_fraction</span><span class="p">:</span> <span class="n">NDArray</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>